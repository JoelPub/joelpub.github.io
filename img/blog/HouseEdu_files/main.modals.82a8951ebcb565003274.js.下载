(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{1801:function(e,t,n){var a=n(823),o=n(1802);function r(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}r.prototype=a(o.prototype),r.prototype.constructor=r,e.exports=r},1802:function(e,t){e.exports=function(){}},1803:function(e,t,n){var a=n(823),o=n(1802),r=4294967295;function i(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=r,this.__views__=[]}i.prototype=a(o.prototype),i.prototype.constructor=i,e.exports=i},1804:function(e,t,n){"use strict";var a=n(4),o=n(5),r=n(8),i=n(6),s=n(7),c=n(2),l=n.n(c),u=n(1),d=n.n(u),m=n(19),p=n.n(m),h=n(39),f=n.n(h),b=n(61),v=n.n(b),g=n(385),y=n(2112),C=n(1845),O=(n(1871),function(e){function t(){var e,n;Object(a.a)(this,t);for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return(n=Object(r.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(s)))).state={isInputing:!1,value:n.props.value||""},n.handleChange=function(e){n.setState({value:Object(g.cutStringWidth)(e.target.value,30)})},n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.value&&e.value!==this.state.value&&this.setState({value:e.value})}},{key:"render",value:function(){var e=this,t=this.state,n=t.isInputing,a=t.value,o=this.props.onChange,r=!n&&!a,i=!n&&a;return d.a.createElement("div",{className:"Editable-VideoTitleInput-container"},d.a.createElement(C.a,null,d.a.createElement("div",{className:p()("Editable-VideoTitleInput-innerContainer",{"Editable-VideoTitleInput-innerContainer--isBeforeIconShown":r}),onClick:function(){return e.setState({isInputing:!0})}},r&&d.a.createElement(y.a,{className:"Editable-VideoTitleInput-beforeIcon",center:!0}),!n&&d.a.createElement("div",{className:p()("Editable-VideoTitleInput-value",{"Editable-VideoTitleInput-value--noContent":!a})},a||"好的标题可以获得更多的推荐及关注者"),n&&d.a.createElement("input",{className:"Editable-VideoTitleInput",value:a,ref:function(e){e&&e.focus()},placeholder:"标题长度不超过 15 个字",onChange:this.handleChange,onBlur:function(t){e.setState({isInputing:!1}),o(t.target.value)}}),i&&d.a.createElement(y.a,{className:"Editable-VideoTitleInput-afterIcon",center:!0}))))}}]),t}(u.Component)),j=n(1810),k=function(e){function t(){var e,n;Object(a.a)(this,t);for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return(n=Object(r.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(s)))).state={shown:!1},n.handleObserve=function(e){(e[0].isIntersecting||e[0].intersectionRatio>0)&&n.setState({shown:!0})},n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.placeholder,n=e.rootMargin,a=e.children;return this.state.shown?a:d.a.createElement(j.a,{rootMargin:n,onObserve:this.handleObserve,threshold:[0,.1]},t||d.a.createElement("div",{style:{height:"1px"}}))}}]),t}(u.Component);k.propTypes={placeholder:l.a.element,rootMargin:l.a.string},k.defaultProps={rootMargin:"200px"};var w=k,N=n(2113),S=n(1872),I=n.n(S),P=function(e){var t=e.className;return d.a.createElement("svg",{viewBox:"0 0 72 72",className:t},d.a.createElement("circle",{cx:"36",cy:"36",fill:"#fff",fillOpacity:".95",r:"36"}),d.a.createElement("path",{d:"M50.835 37.06L29.477 49.97a1.203 1.203 0 0 1-1.664-.43 1.25 1.25 0 0 1-.17-.631V23.091c0-.682.543-1.234 1.213-1.234.219 0 .433.06.62.173l21.359 12.91a1.245 1.245 0 0 1 0 2.12z",fill:"#444",fillRule:"nonzero"}))},R=(n(1873),function(){return d.a.createElement("div",{className:"VideoCardPlayButton"},d.a.createElement(P,{className:"VideoCardPlayButton-icon"}))}),E=function(e){var t=e.fileSize;return d.a.createElement("div",{className:"VideoCardPlayButton-withFileSize--outer"},d.a.createElement("span",{className:"VideoCardPlayButton-withFileSize"},d.a.createElement(N.a,{center:!0,size:14}),t?I()(t,{decimalPlaces:1,unit:"MB"}):"流量播放"))};function x(e){var t=e.thumbnail,n=e.isLens,a=e.canPlay;return n||a?t&&"string"==typeof t?d.a.createElement("img",{src:t,alt:"视频封面"}):t||null:d.a.createElement(P,{className:"VideoCard-playIcon VideoCard-playIcon--nonLens"})}n(1874);var A=function(e){function t(){var e,n;Object(a.a)(this,t);for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return(n=Object(r.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(s)))).state={isMobile:!1,playerShown:!1,playerLoading:!1},n.handlePlay=function(e){e.preventDefault();var t=n.props,a=t.interactive,o=t.isConverting,r=t.isLens,i=t.playerUrl,s=t.onPlayFailed,c=t.onLensPlay,l=t.onBeforePlay;a&&!o&&(i||!s?l?Promise.resolve(l()).then(function(e){!1!==e&&n.play()}):r&&c&&c()||n.play():s())},n.handlePlayerLoad=function(){n.loadingCount--,0===n.loadingCount&&n.setState({playerLoading:!1})},n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.setState({isMobile:v()(navigator.userAgent).Mobile})}},{key:"canPlay",value:function(){return this.props.isLens}},{key:"inlinePlayer",value:function(){var e=this.props,t=e.interactive,n=e.isLens,a=e.onLensPlay,o=e.onBeforePlay;return t&&n&&!(a||o)}},{key:"showContent",value:function(){var e=this.props,t=e.content,n=e.isLens,a=e.title;return!e.isVideoTitleEditable&&(!n||Boolean(t||a))}},{key:"showDescription",value:function(){var e=this.props.isLens;return this.showContent()&&!e}},{key:"play",value:function(){var e=this.props.onPlay;this.loadingCount=2,this.setState({playerShown:!0,playerLoading:!0}),setTimeout(this.handlePlayerLoad,1e3),e&&e()}},{key:"renderContent",value:function(){var e=this.props,t=e.interactive,n=e.isLens,a=e.title,o=e.thumbnail,r=e.source,i=e.url,s=e.showPlayButton,c=e.usePlayButtonWithFileSize,l=e.fileSize,u=e.rightBottomButton,m=e.isVideoTitleEditable,h=e.onVideoTitleChange,f=e.isConverting,b=e.content,v=this.canPlay(),g=this.inlinePlayer(),y=d.a.createElement(x,{thumbnail:o,isLens:n,canPlay:v}),C=s&&!f&&(c?d.a.createElement(E,{fileSize:l}):d.a.createElement(R,null)),j=d.a.createElement("div",{className:"VideoCard-layout"},v?d.a.createElement("div",{className:"VideoCard-video"},d.a.createElement("div",{className:"VideoCard-video-content"},g?this.renderPlayer():d.a.createElement("div",{className:p()("VideoCard-thumbnail",{"VideoCard-thumbnail--placeholder":!o}),onClick:this.handlePlay},y,C,u))):d.a.createElement("div",{className:"VideoCard-poster"},y),this.showContent()&&(b||d.a.createElement("div",{className:"VideoCard-content"},d.a.createElement("div",{className:"VideoCard-title"},a),this.showDescription()&&d.a.createElement("div",{className:"VideoCard-description"},r&&d.a.createElement("span",{className:"VideoCard-source"},r),d.a.createElement("span",{className:"VideoCard-badge"},"视频")))),m&&d.a.createElement(O,{value:a,onChange:h}));return n?j:t?d.a.createElement("a",{className:"VideoCard-link",href:i,target:"_blank",rel:"noopener noreferrer"},j):d.a.createElement("div",{className:"VideoCard-link"},j)}},{key:"renderPlayer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.props,n=t.source,a=t.playerUrl,o=t.onIframeRef,r=t.useMSE,i=f.a.stringify({autoplay:e&&"lens"===n,useMSE:r});return d.a.createElement(w,{placeholder:d.a.createElement("div",{className:"VideoCard-player"})},d.a.createElement("div",{className:"VideoCard-player"},d.a.createElement("iframe",{ref:o,frameBorder:0,allowFullScreen:!0,src:"".concat(a,"?").concat(i),onLoad:this.handlePlayerLoad})))}},{key:"render",value:function(){var e=this.props,t=e.interactive,n=e.isConverting,a=this.state,o=a.isMobile,r=a.playerShown,i=a.playerLoading;return d.a.createElement("div",{className:p()("VideoCard",{"VideoCard--converting":n,"VideoCard--interactive":t,"VideoCard--mobile":o})},this.renderContent(),r&&d.a.createElement("div",{className:p()("VideoCard-overlay",{"is-loading":i})},this.renderPlayer(!0)),d.a.createElement("div",{className:p()("VideoCard-mask",{"is-shown":i})}))}}]),t}(u.Component);A.propTypes={interactive:l.a.bool,showPlayButton:l.a.bool,usePlayButtonWithFileSize:l.a.bool,fileSize:l.a.number,onPlay:l.a.func,onPlayFailed:l.a.func,onLensPlay:l.a.func,onBeforePlay:l.a.func,rightBottomButton:l.a.oneOfType([l.a.element,l.a.string]),thumbnail:l.a.oneOfType([l.a.element,l.a.string]),content:l.a.object},A.defaultProps={interactive:!0,showPlayButton:!0};var T=A;n.d(t,"b",function(){return T}),n.d(t,"a",function(){return P})},1809:function(e,t,n){"use strict";var a=n(29),o=n(24),r=n(22),i=n(0),s=n(1),c=n.n(s),l=n(1849),u=n(32),d=n.n(u),m=n(31),p=n(54),h=n(16),f=n(1826),b=n(1830),v=n(96);var g,y="function"==typeof Image,C={},O=y?v(function(e){return new Promise(function(t){return n=e,a=function(e,n){C[e]=n,t(n)},(o=new Image).onload=function(){var e=o.width>0&&o.height>0;a(n,e)},o.onerror=function(){a(n,!1)},void(o.src="data:image/webp;base64,"+{lossy:"UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",lossless:"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",alpha:"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==",animation:"UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"}[n]);var n,a,o})}):function(){return Promise.resolve(!1)},j=function(e){var t=C[e],n=Object(s.useState)(t||!1),o=Object(a.a)(n,2),r=o[0],i=o[1];return y&&void 0===t&&O(e).then(i),r},k=n(4),w=n(5),N=n(8),S=n(6),I=n(7),P=n(19),R=n.n(P),E=n(3),x=n(1827),A=n.n(x),T=n(71),L=n.n(T),M=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:L.a;return function(n){return A()(function(a){function o(){var e,n;Object(k.a)(this,o);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(N.a)(this,(e=Object(S.a)(o)).call.apply(e,[this].concat(r)))).key=t(),n}return Object(I.a)(o,a),Object(w.a)(o,[{key:"render",value:function(){return c.a.createElement(n,Object.assign({},this.props,Object(E.a)({},e,this.key)))}}]),o}(c.a.Component),n)}},_=n(1875),D=n(242),F=n.n(D),B=function(e,t){return function(n){var a,o=(a=[],{value:{},listen:function(e){a.push(e)},unlisten:function(e){a=a.filter(function(t){return t!==e})},emit:function(e){this.value=e,a.forEach(function(t){return t(e)})}}),r=Object(_.createSubscription)({getCurrentValue:function(e){return e.value},subscribe:function(e,t){return e.listen(t),function(){return e.unlisten(t)}}}),i=function(e,t){return e?F()(e,function(e){return function(){return t(e.apply(void 0,arguments))}}):{dispatch:t}}(t,function(e){return o.emit(e(o.value))}),s=Object.assign(function(t){return c.a.createElement(r,{source:o},function(a){return c.a.createElement(n,Object.assign({},t,e({value:a,source:o},t),i))})},{source:o});return A()(s,n)}};!function(e){e[e.Initial=0]="Initial",e[e.Loading=1]="Loading",e[e.Ok=2]="Ok",e[e.Failed=3]="Failed"}(g||(g={}));var z=function(e){return c.a.createElement("svg",Object.assign({width:60,height:60,viewBox:"0 0 60 60"},e),c.a.createElement("g",{fill:"none",fillRule:"evenodd"},c.a.createElement("ellipse",{fill:"#000",opacity:.45,cx:30,cy:30,rx:30,ry:30}),c.a.createElement("ellipse",{stroke:"#FFF",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"4,1,4",cx:30,cy:30,rx:26,ry:26}),c.a.createElement("svg",Object.assign({x:16,y:18.5},e),c.a.createElement("path",{d:"M12.842 12.981V11.4H7.64v1.653h3.27v.272c-.018 1.881-1.442 3.147-3.516 3.147-2.382 0-3.876-1.846-3.876-4.834 0-2.936 1.485-4.79 3.832-4.79 1.732 0 2.936.835 3.428 2.364h1.977c-.43-2.566-2.522-4.201-5.405-4.201-3.55 0-5.845 2.601-5.845 6.644 0 4.096 2.268 6.654 5.863 6.654 3.322 0 5.475-2.083 5.475-5.327zM17.518 18V5.317H15.55V18h1.97zm5.142 0v-5.256h5.449v-1.74h-5.45V7.11h5.95V5.317h-7.918V18h1.969z",fill:"#fff"}))))},V=function(e){return c.a.createElement("svg",Object.assign({width:"60px",height:"60px",viewBox:"0 0 60 60",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},e),c.a.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},c.a.createElement("ellipse",{fill:"#000000",opacity:"0.45",cx:"30",cy:"30",rx:"30",ry:"30"}),c.a.createElement("ellipse",{stroke:"#ffffff",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",opacity:"0.5",cx:"30",cy:"30",rx:"26",ry:"26"}),c.a.createElement("ellipse",{stroke:"#ffffff",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"4,1,4",cx:"30",cy:"30",rx:"26",ry:"26"},c.a.createElement("animateTransform",{attributeType:"xml",attributeName:"transform",type:"rotate",from:"0 30 30",to:"90 30 30",dur:"0.3s"}),c.a.createElement("animate",{attributeName:"opacity",from:"1",to:"0",dur:"0.3",fill:"freeze"}))),c.a.createElement("svg",{x:"16",y:"18.5"},c.a.createElement("g",{fill:"#ffffff"},c.a.createElement("path",{x:"100",y:"100",d:"M12.8422852,12.9814453 L12.8422852,11.3994141 L7.63916016,11.3994141 L7.63916016,13.0517578 L10.9086914,13.0517578 L10.9086914,13.3242188 C10.8911133,15.2050781 9.46728516,16.4707031 7.39306641,16.4707031 C5.01123047,16.4707031 3.51708984,14.625 3.51708984,11.6367188 C3.51708984,8.70117188 5.00244141,6.84667969 7.34912109,6.84667969 C9.08056641,6.84667969 10.284668,7.68164062 10.7768555,9.2109375 L12.7543945,9.2109375 C12.3237305,6.64453125 10.2319336,5.00976562 7.34912109,5.00976562 C3.79833984,5.00976562 1.50439453,7.61132812 1.50439453,11.6542969 C1.50439453,15.75 3.77197266,18.3076172 7.36669922,18.3076172 C10.6889648,18.3076172 12.8422852,16.2246094 12.8422852,12.9814453 Z M17.5180664,18 L17.5180664,5.31738281 L15.5493164,5.31738281 L15.5493164,18 L17.5180664,18 Z M22.659668,18 L22.659668,12.7441406 L28.1088867,12.7441406 L28.1088867,11.0039062 L22.659668,11.0039062 L22.659668,7.11035156 L28.6098633,7.11035156 L28.6098633,5.31738281 L20.690918,5.31738281 L20.690918,18 L22.659668,18 Z"}))),c.a.createElement("path",{d:"M56,30 C56,15.6405965 44.3594035,4 30,4",stroke:"#FFFFFF",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",opacity:"0",fill:"none"},c.a.createElement("animate",{attributeName:"opacity",from:"0",to:"1",dur:".6",fill:"freeze"}),c.a.createElement("animateTransform",{attributeType:"xml",attributeName:"transform",type:"rotate",from:"0 30 30",to:"360 30 30",dur:"1.625s",repeatCount:"indefinite"})))},U=function(e){return c.a.createElement("svg",Object.assign({width:60,height:60,viewBox:"0 0 60 60"},e),c.a.createElement("g",{fill:"none",fillRule:"evenodd"},c.a.createElement("ellipse",{fill:"#282828",opacity:.45,cx:30,cy:30,rx:30,ry:30}),c.a.createElement("path",{d:"M41.552 18.93A15.954 15.954 0 0 0 30 14c-8.837 0-16 7.163-16 16s7.163 16 16 16c7.811 0 14.315-5.597 15.72-13",stroke:"#FFF",strokeWidth:2,strokeLinecap:"round"}),c.a.createElement("path",{d:"M45.108 16.236c.44-.33.797-.151.797.4v7.005c0 .55-.358.73-.797.4L40.7 20.736c-.44-.33-.439-.866 0-1.195l4.407-3.305z",fill:"#FFF"})))},q=(n(1922),function(){return new Promise(requestAnimationFrame)}),W=function(e){function t(){var e,n;Object(k.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(N.a)(this,(e=Object(S.a)(t)).call.apply(e,[this].concat(o)))).handleClick=function(e){var t=n.props,a=t.gifKey,o=t.src,r=t.onLoadStart,i=t.onSuccess,s=t.onFailed,c=t.onClick,l=t.onPlayChange,u=t.loadState,d=t.isPlaying;c&&c(e),l&&l(d),n.canPlay?n.props.updateGif({gifKey:a,isPlaying:!d}):u!==g.Loading&&(n.props.updateGif({gifKey:a,loadState:g.Loading}),r&&r(),Promise.all([Object(p.loadImage)(o),q().then(q)]).then(function(){i&&i(),n.props.updateGif({gifKey:a,isPlaying:!0,loadState:g.Ok})}).catch(function(e){s&&s(e),n.props.updateGif({gifKey:a,loadState:g.Failed})}))},n}return Object(I.a)(t,e),Object(w.a)(t,[{key:"componentWillUnmount",value:function(){this.props.removeGif({gifKey:this.props.gifKey})}},{key:"render",value:function(){var e,t=this.props,n=t.poster,a=t.src,o=t.size,r=t.loadState,i=t.isPlaying,s=t.onRef,l=this.canPlay&&i,u=r===g.Loading,d=r===g.Failed;return u?e=c.a.createElement(V,{className:"GifPlayer-icon"}):d?e=c.a.createElement(U,{className:"GifPlayer-icon"}):i||(e=c.a.createElement(z,{className:"GifPlayer-icon"})),e&&(this.lastIcon=e),c.a.createElement("div",{className:R()("GifPlayer",{isPlaying:i}),"data-size":o,onClick:this.handleClick,ref:s},c.a.createElement("img",{className:"ztext-gif",role:"presentation",src:l?a:n,"data-thumbnail":n,"data-size":o}),e||this.lastIcon)}},{key:"canPlay",get:function(){return this.props.loadState===g.Ok}}]),t}(c.a.Component);W.defaultProps={isPlaying:!1,loadState:g.Initial};var H=M("gifKey")(B(function(e,t){return e.value[t.gifKey]},{updateGif:function(e){return function(t){var n=e.gifKey,a=e.isPlaying,o=d()(e,["gifKey","isPlaying"]),r=Object.assign({},t);if(a)for(var i=0,s=Object.keys(r);i<s.length;i++){var c=s[i],l=r[c];c!==n&&l.isPlaying&&(r[c]=Object.assign({},l,{isPlaying:!1}))}return Object.assign({},r,Object(E.a)({},n,Object.assign({},t[n],{isPlaying:a},o)))}},removeGif:function(e){return function(t){var n=Object.assign({},t);return delete n[e.gifKey],n}}})(W)),K=function(e,t){h.default.trackEvent(e,{action:"StatusReport",element:"Card"},{status:{result:t}})},G=function(e){var t=e.src,n=e.useWebP,o=void 0===n?"auto":n,r=e.onRef,i=e.onLoadStateChange,l=d()(e,["src","useWebP","onRef","onLoadStateChange"]),u=Object(s.useState)(null),m=Object(a.a)(u,2),v=m[0],g=m[1],y=j("animation");Object(s.useEffect)(function(){v&&h.default.setModule(v,{module:"GifItem"})},[v]),Object(b.a)(v,function(){h.default.trackCardShow(v,{element:"Card"})});var C=Object(p.imgUrl)(t,{extension:("auto"===o?y:o)?"webp":"gif"});return c.a.createElement(H,Object.assign({src:C,onRef:Object(s.useCallback)(Object(f.a)(r,g),[]),onPlayChange:function(e){e||h.default.trackEvent(v,{action:"Click",element:"Image"})},onLoadStart:function(){i&&i("loadstart",C)},onSuccess:function(){K(v,"Success"),i&&i("load",C)},onFailed:function(){K(v,"Fail"),i&&i("error",C)}},l))},Q=function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).Component,n=void 0===t?G:t,o=Object(s.useState)(null),r=Object(a.a)(o,2),i=r[0],l=r[1];return Object(s.useEffect)(function(){if(e){var t=Array.from(e.querySelectorAll("img.origin_image[data-thumbnail],img.content_image[data-thumbnail]"));if(t.length){var a=t.map(function(e){return function(e){var t=e.dataset,n=t.thumbnail,a={src:n,poster:n,size:t.size},o=document.createElement("div");return o.className="RichText-gifPlaceholder",e.parentNode.replaceChild(o,e),{data:a,target:o}}(e)}).map(function(e,t){var a=e.data,o=e.target;return Object(m.createPortal)(c.a.createElement(n,Object.assign({key:t},a)),o)});l(a)}}},[e]),i},Y=n(493),$=n(1923),J=n.n($),Z=n(82),X=n.n(Z),ee=n(103),te=function(e){var t=e.getAttribute("data-hash"),n=e.textContent.replace(/^@/,""),a=document.createElement("span");return e.parentNode.replaceChild(a,e),{target:a,data:{id:t,name:n}}},ne=function(e){var t=Object(s.useState)(null),n=Object(a.a)(t,2),o=n[0],r=n[1];return Object(s.useEffect)(function(){if(e){var t=Array.from(e.querySelectorAll(".member_mention"));if(t.length){var n=t.map(te).map(function(e,t){var n=e.data,a=e.target;return Object(m.createPortal)(Object(i.b)(ee.a,{key:t,user:n}),a)});r(n)}}},[e]),o},ae=n(1821),oe=function(e){var t=e.getAttribute("data-poster"),n="data:,"===t?"":t,a={title:e.getAttribute("data-name"),thumbnail:n,url:e.getAttribute("href"),src:e.getAttribute("data-src")};a=e.getAttribute("data-lens-id")?Object.assign({},a,{isLens:!0,id:e.getAttribute("data-lens-id"),isPlayable:!0}):Object.assign({},a,{isLens:!1,id:e.getAttribute("data-video-id"),isPlayable:"true"===e.getAttribute("data-video-playable")}),e.hasAttribute("data-lens-status")&&(a=Object.assign({},a,{error:{status:e.getAttribute("data-lens-status"),message:e.getAttribute("data-description")}}));var o=document.createElement("div");return e.parentNode.replaceChild(o,e),{target:o,data:a}},re=function(e){var t=Object(s.useState)(null),n=Object(a.a)(t,2),o=n[0],r=n[1];return Object(s.useEffect)(function(){if(e){var t=Array.from(e.querySelectorAll(".video-box, .video-link, .unprocessable_video"));if(t.length){var n=t.map(oe).map(function(e,t){var n=e.data,a=e.target;return Object(m.createPortal)(Object(i.b)(ae.a,{key:t,data:n}),a)});r(n)}}},[e]),o},ie=(n(1927),{}),se=function(e,t){var n=function(e){return e.split("/").reverse()[0]}(t),a=n.split(".")[1],o="webp"===a||"gif"===a?a:"image",r=Object(Z.statGenerator)({appName:"heifetz"})("".concat(o,".unknown.RichText"));switch(e){case"loadstart":ie[n]=Date.now();break;case"load":if(ie[n]){var i="".concat(r,".success");X.a.increment({raw:"".concat(i,".cnt")}),X.a.timing(i,Date.now()-ie[n]),delete ie[n]}break;case"timeout":if(ie[n]){var s="".concat(r,".timeout.cnt");X.a.increment({raw:s}),delete ie[n]}break;case"error":if(ie[n]){var c="".concat(r,".failure.cnt");X.a.increment({raw:c}),delete ie[n]}}},ce=function(e){return Object(i.b)(G,Object(r.default)({onLoadStateChange:se},e))};t.a=function(e){var t=e.ecommerce,n=Object(o.a)(e,["ecommerce"]),u=Object(s.useState)(null),d=Object(a.a)(u,2),m=d[0],p=d[1];return Object(i.b)(c.a.Fragment,null,Object(i.b)(l.a,Object(r.default)({},n,{onRef:p,lazyLoadImageProps:{onLoadStateChange:se}})),Q(m,{Component:ce}),re(m),ne(m),Object(Y.d)(m,{ecommerce:t,Component:J.a}))}},1810:function(e,t,n){"use strict";var a=n(4),o=n(5),r=n(8),i=n(6),s=n(7),c=n(2),l=n.n(c),u=n(1),d=n(31),m=(n(1822),function(e){function t(){var e,n;Object(a.a)(this,t);for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return(n=Object(r.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(s)))).handleObserve=function(e){var t=n.props.onObserve;t&&t(e)},n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.target=Object(d.findDOMNode)(this),this.observer=this.createObserver(),this.observer.observe(this.target)}},{key:"componentWillUnmount",value:function(){this.target&&this.observer.unobserve(this.target)}},{key:"createObserver",value:function(){var e=this.props,t={root:e.root,rootMargin:e.rootMargin,threshold:e.threshold};return new window.IntersectionObserver(this.handleObserve,t)}},{key:"render",value:function(){return this.props.children}}]),t}(u.Component));m.propTypes={root:l.a.object,rootMargin:l.a.string,threshold:l.a.oneOfType([l.a.number,l.a.arrayOf(l.a.number)]),onObserve:l.a.func},t.a=m},1814:function(e,t,n){"use strict";e.exports=n(1862)},1819:function(e,t,n){var a=n(1857),o=n(272),r=a?function(e){return a.get(e)}:o;e.exports=r},1820:function(e,t,n){var a=n(1858),o=Object.prototype.hasOwnProperty;e.exports=function(e){for(var t=e.name+"",n=a[t],r=o.call(a,t)?n.length:0;r--;){var i=n[r],s=i.func;if(null==s||s==e)return i.name}return t}},1821:function(e,t,n){"use strict";var a={};n.r(a),n.d(a,"DOM",function(){return g}),n.d(a,"PLAYER",function(){return y});var o={};n.r(o),n.d(o,"PLAYER",function(){return C});var r=n(22),i=n(4),s=n(5),c=n(8),l=n(6),u=n(30),d=n(7),m=n(0),p=n(1),h=n(18),f=n(1810),b=n(1804),v=n(1851),g={PLAY:"event/dom/play",PLAYING:"event/dom/playing",PAUSE:"event/dom/pause",ENDED:"event/dom/ended",TIMEUPDATE:"event/dom/timeupdate",ERROR:"event/dom/error",WAITING:"event/dom/waiting"},y={QUALITY_CHANGE:"event/player/quality-change",REQUEST_PLAY:"event/player/request-play",REQUEST_PAUSE:"event/player/request-pause",PLAY_COUNT:"event/player/play-count",PLAY_FAILED:"event/player/play-failed",ENTER_FULLSCREEN:"event/player/enter-fullscreen",EXIT_FULLSCREEN:"event/player/exit-fullscreen"},C={PLAY:"action/player/play",PAUSE:"action/player/pause",SET_VOLUME:"action/player/set-volume",ENTER_FULLSCREEN:"action/player/enter-fullscreen",EXIT_FULLSCREEN:"action/player/exit-fullscreen"},O="griffith";var j,k=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*",n=arguments.length>2?arguments[2]:void 0;return{subscribeMessage:function(a){function o(o){var r=o.origin||o.originalEvent.origin,i="*"===t||t===r,s=o.data||{},c=s.from,l=s.id,u=s.payload;if(i&&c===O&&(!n||e===l)&&u){var d=u.messageName,m=u.data;d&&a(d,m,o.source)}}return window.addEventListener("message",o),{unsubscribe:function(){return window.removeEventListener("message",o)}}},dispatchMessage:function(n,a,o){n&&n.postMessage&&n.postMessage({from:O,id:e,payload:{messageName:a,data:o}},t||"*")}}},w=n(55),N=n(23),S=n(244),I=n(195),P=n(1823),R=n.n(P),E=function(e,t){return e+(t?Date.now()-t:0)},x=function(e,t){return Math.abs(e-t)<.01},A={auto:"Auto",ld:"LD",sd:"SD",hd:"HD"},T={auto:"自动",ld:"低清",sd:"标清",hd:"超清"},L=[1,2,3,5,8,13];function M(e){var t,n="sd",a=0,o=null,r=0,i=null,s=!1,c=0,l=0;function u(t,s){e(t,Object.assign({play_event_identifier:o,duration:1e3*a,elapsed:E(r,i),video_quality:A[n]},s))}function d(){(++l<15?L.includes(l):l%15==0)&&u({action:"Playing"})}function m(){clearInterval(t)}return{handlePlayEvent:function(e){var n=e.currentTime,s=e.duration;a=s,x(n,0)&&(o=R()(),r=0),i=Date.now(),x(n,0)?u({action:"Play"}):u({action:"ResumePlay"}),l=0,m(),t=setInterval(d,1e3)},handlePauseEvent:function(e){var t=e.currentTime,n=e.duration;i&&(r+=Date.now()-i,i=null),x(t,n)?u({action:"EndPlay"}):u({action:"Pause"}),m()},handleQualityChangeEvent:function(e){var t=e.quality;u({action:"Switch",name:T[t]}),n=t},handleFragmentLoading:function(){s||(c=Date.now())},handleFragmentLoaded:function(){s||(s=!0,u({action:"Load"},{video_load_time:Date.now()-c}))},clearTick:m}}var _=Object(h.connect)(function(e,t){var n=t.data,a=n.isLens,o=n.id;if(a){var r=!1;return"undefined"!=typeof window&&!Object(w.d)(e,{includeTablet:!0})&&/Chrome/.test(navigator.userAgent)&&(r="1"===Object(w.a)(e,"ls_fmp4")),{data:Object.assign({},t.data,{source:"lens",playerUrl:"https://www.zhihu.com/video/".concat(o)}),useMSE:r}}return{data:e.video.data[o]||t.data}},{showNotification:N.h,loadVideo:S.c})(j=Object(I.a)(function(e){var t=e.data,n=t.isLens,a=t.id,o=t.isPlayable;return{module:"VideoItem",content:{type:"Video",sub_type:n?"SelfHosted":"Embedded",video_id:a,is_playable:Boolean(o)},trackCardShow:!0,view:{id:174}}})(j=function(e){function t(e){var n;Object(i.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).pauseVideoInIframe=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n.messageHelper.dispatchMessage(e.contentWindow,o.PLAYER.PAUSE,{dontApplyOnFullScreen:t})},n.pauseAllOtherVideos=function(){Array.from(document.querySelectorAll("iframe")).filter(function(e){return e!==n.iframe}).forEach(function(e){return n.pauseVideoInIframe(e)})},n.handleMessage=function(e,t){var o=n.videoTracker,r=o.handlePlayEvent,i=o.handlePauseEvent,s=o.handleQualityChangeEvent,c=o.handleFragmentLoading,l=o.handleFragmentLoaded;switch(e){case a.DOM.PLAY:n.pauseAllOtherVideos(),r(t);break;case a.DOM.PAUSE:i(t);break;case a.PLAYER.QUALITY_CHANGE:s(t);break;case"fragment-loading":c(t);break;case"fragment-loaded":l(t)}},n.handleObserve=function(e){e[0].intersectionRatio<=0&&n.iframe&&n.pauseVideoInIframe(n.iframe,!0)},n.handlePlay=function(){n.props.trackEvent(Object(u.default)(n),{id:5500,action:"Play",element:"Video"})},n.handlePlayFailed=function(){(0,n.props.showNotification)("视频加载失败，请刷新页面重试","red")};var r=e.trackEvent,s=e.data;return n.messageHelper=k(s.id,"*",!0),n.videoTracker=M(function(e,t){r(Object(u.default)(n),e,{play:t})}),n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.data,n=t.isLens,a=t.id,o=t.playerUrl,r=t.flvPlayerUrl,i=e.loadVideo;n||!a||o||r||i(a);var s=this.messageHelper.subscribeMessage;this.messageSubscription=s(this.handleMessage)}},{key:"componentWillUnmount",value:function(){this.messageSubscription.unsubscribe(),this.videoTracker.clearTick()}},{key:"render",value:function(){var e=this,t=this.props,n=t.data,a=t.data.error,o=t.onBeforePlay,i=t.useMSE;return Object(m.b)("div",{className:"RichText-video"},a?Object(m.b)(v.a,n):Object(m.b)(f.a,{onObserve:this.handleObserve},Object(m.b)(b.b,Object(r.default)({},n,{onIframeRef:function(t){return e.iframe=t},onPlay:this.handlePlay,onPlayFailed:this.handlePlayFailed,onBeforePlay:o},i&&{useMSE:!0}))))}}]),t}(p.Component))||j)||j;t.a=_},1822:function(e,t,n){e.exports=n(66)(285)},1823:function(e,t,n){var a=n(1878),o=n(1879);e.exports=function(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||a)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var s=0;s<16;++s)t[r+s]=i[s];return t||o(i)}},1825:function(e,t,n){var a=n(1924),o=n(1925),r=o;r.v1=a,r.v4=o,e.exports=r},1826:function(e,t,n){"use strict";t.a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.forEach(function(t){return function(e,t){"object"==typeof t?t.current=e:"function"==typeof t&&t(e)}(e,t)})}}},1827:function(e,t,n){"use strict";var a={childContextTypes:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r=Object.defineProperty,i=Object.getOwnPropertyNames,s=Object.getOwnPropertySymbols,c=Object.getOwnPropertyDescriptor,l=Object.getPrototypeOf,u=l&&l(Object);e.exports=function e(t,n,d){if("string"!=typeof n){if(u){var m=l(n);m&&m!==u&&e(t,m,d)}var p=i(n);s&&(p=p.concat(s(n)));for(var h=0;h<p.length;++h){var f=p[h];if(!(a[f]||o[f]||d&&d[f])){var b=c(n,f);try{r(t,f,b)}catch(e){}}}return t}return t}},1828:function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var a=new Uint8Array(16);e.exports=function(){return n(a),a}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},1829:function(e,t){for(var n=[],a=0;a<256;++a)n[a]=(a+256).toString(16).substr(1);e.exports=function(e,t){var a=t||0,o=n;return[o[e[a++]],o[e[a++]],o[e[a++]],o[e[a++]],"-",o[e[a++]],o[e[a++]],"-",o[e[a++]],o[e[a++]],"-",o[e[a++]],o[e[a++]],"-",o[e[a++]],o[e[a++]],o[e[a++]],o[e[a++]],o[e[a++]],o[e[a++]]].join("")}},1830:function(e,t,n){"use strict";var a=n(1),o=function(e){var t=Object(a.useRef)();return t.current=Object(a.useCallback)(e,[e]),Object(a.useState)(function(){return function(){return t.current.apply(t,arguments)}})[0]};t.a=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.rootMargin,i=n.threshold,s=n.once,c=void 0===s||s;e=Array.isArray(e)?e:e?[e]:[];var l=Object(a.useRef)(null),u=o(t);Object(a.useEffect)(function(){if(e.length)return l.current&&e.forEach(function(e){return l.current.unobserve(e)}),l.current=new IntersectionObserver(function(e){e.forEach(function(e){e.intersectionRatio>0&&(u(e),c&&l.current.unobserve(e.target))})},{rootMargin:r,threshold:i}),e.forEach(function(e){return l.current.observe(e)}),function(){e.forEach(function(e){return l.current.unobserve(e)})}},[e,r,JSON.stringify(i),c])}},1831:function(e,t,n){var a=n(1801),o=n(506),r=n(1819),i=n(1820),s=n(104),c=n(1859),l="Expected a function",u=8,d=32,m=128,p=256;e.exports=function(e){return o(function(t){var n=t.length,o=n,h=a.prototype.thru;for(e&&t.reverse();o--;){var f=t[o];if("function"!=typeof f)throw new TypeError(l);if(h&&!b&&"wrapper"==i(f))var b=new a([],!0)}for(o=b?o:n;++o<n;){f=t[o];var v=i(f),g="wrapper"==v?r(f):void 0;b=g&&c(g[0])&&g[1]==(m|u|d|p)&&!g[4].length&&1==g[9]?b[i(g[0])].apply(b,g[3]):1==f.length&&c(f)?b[v]():b.thru(f)}return function(){var e=arguments,a=e[0];if(b&&1==e.length&&s(a))return b.plant(a).value();for(var o=0,r=n?t[o].apply(this,e):a;++o<n;)r=t[o].call(this,r);return r}})}},1845:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var a=n(4),o=n(5),r=n(8),i=n(6),s=n(7),c=n(1),l=n.n(c),u=function(e){function t(){return Object(a.a)(this,t),Object(r.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"handleEvent",value:function(e){e.stopPropagation()}},{key:"render",value:function(){return l.a.createElement("div",{onBeforeInput:this.handleEvent,onBlur:this.handleEvent,onCompositionEnd:this.handleEvent,onCompositionStart:this.handleEvent,onCopy:this.handleEvent,onCut:this.handleEvent,onDragEnd:this.handleEvent,onDragEnter:this.handleEvent,onDragLeave:this.handleEvent,onDragOver:this.handleEvent,onDragStart:this.handleEvent,onDrop:this.handleEvent,onFocus:this.handleEvent,onInput:this.handleEvent,onKeyDown:this.handleEvent,onKeyPress:this.handleEvent,onKeyUp:this.handleEvent,onMouseUp:this.handleEvent,onPaste:this.handleEvent,onSelect:this.handleEvent,onClick:this.handleEvent},this.props.children)}}]),t}(l.a.Component)},1846:function(e,t,n){"use strict";var a,o,r,i,s=n(3),c=n(4),l=n(5),u=n(8),d=n(6),m=n(7),p=n(0),h=n(1),f=n(2),b=n.n(f),v=n(18),g=n(2175),y=n(56),C=n(27),O=n(117),j=(n(1974),{all:"开放评论",censor:"预审评论",nobody:"关闭评论"}),k={all:"允许任何人评论",follower:"允许关注我的人评论",censor:"评论由我筛选后显示",followee:"允许我关注的人评论",paid:"付费用户可评论",nobody:"关闭评论"},w=Object(v.connect)(function(e){return{isOrg:Object(C.f)(e)}})((r=o=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).handleClickOption=function(e){var t=n.props,a=t.isOrg,o=t.target,r=t.onChange,i=t.current;if(e!==i)if(o){var s=o.id;o.adminClosedComment?Object(O.b)("此内容无法更改评论权限",{theme:"red-ghost"}):a||"censor"!==e&&"censor"!==i?r(s,e):Object(O.a)("你确定要更改评论权限吗？",{content:"censor"===e?"更改后，已有评论不变，新评论需要经过筛选才会公开显示":"更改后，所有待筛选评论都会被公开显示出来"}).then(function(){return r(s,e)}).catch(function(){return null})}else r(e)},n.getCommentPermission=function(){var e=n.props.target,t=e&&"answer"===e.type&&"paid"===e.answerType;return Object.keys(k).filter(function(n){if("paid"!==n||t)return"follower"!==n||e&&"article"===e.type}).reduce(function(e,t){return Object.assign({},e,Object(s.a)({},t,k[t]))},{})},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.isOrg,a=t.current,o=n?j:this.getCommentPermission();return Object(p.b)(h.Fragment,null,Object.keys(o).map(function(t){var n=t===a;return Object(p.b)(y.b,{key:t,onClick:function(){return e.handleClickOption(t)},className:"CommentPermission-item"},n&&Object(p.b)(g.a,{text:!0,center:!0}),o[t])}))}}]),t}(h.Component),o.propTypes={current:b.a.string.isRequired,target:b.a.object,onChange:b.a.func.isRequired},a=r))||a,N=n(44),S=n(1975),I=n.n(S),P=n(195),R=Object(P.a)({view:{id:3038},trackCardShow:!0})(i=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return Object(p.b)("img",{src:I.a,style:{maxWidth:"200px",marginTop:"30px"},alt:"delete-comment-success"})}}]),t}(h.Component))||i;R.showModal=function(e){N.b.open(function(t){var n=(e||{}).reportText;return setTimeout(t,2e3),Object(p.b)(N.b,{title:"举报成功",onClose:t},Object(p.b)("div",{style:{textAlign:"center"}},Object(p.b)("div",null,n||"你的举报我们已经收到，处理完成后将会私信告知处理结果。"),Object(p.b)(R,null)))})};var E=R,x=n(15),A=n(200),T=(n(1976),function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).state={reportModalShown:!1},n.handleSubmit=function(){var e=n.props,t=e.id,a=e.onDelete,o=e.onClose;a(t),o()},n.handleReportModalOpen=function(){return n.setState({reportModalShown:!0})},n.handleReportModalClose=function(){n.setState({reportModalShown:!1}),n.handleSubmit()},n.handleSuccess=function(){n.handleSubmit()},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.id,n=e.shown,a=e.onClose,o=e.reportAndDeleteExperiment;return Object(p.b)(h.Fragment,null,Object(p.b)(N.b,{title:"你确定要删除这条评论吗？",closeButton:null,maskClosable:!1,hotKeyClosable:!1,onClose:a,footer:o&&Object(p.b)("div",{className:"CommentDeleteAndReport-extra"},"评论若构成举报条件可以",Object(p.b)(x.c,{preset:"link",onClick:this.handleReportModalOpen},"删除并举报"))},n&&Object(p.b)(N.a,{direction:"horizontal"},Object(p.b)(x.c,{onClick:a},"取消"),Object(p.b)(x.c,{preset:"primary",color:"blue",onClick:this.handleSubmit},"确定"))),Object(p.b)(A.a,{title:"删除成功，请选择举报理由",subtitle:"",shown:this.state.reportModalShown,type:"comment",urlToken:t,zaEnabled:!0,onSuccess:this.handleSuccess,onClose:this.handleReportModalClose}))}}]),t}(h.Component));n.d(t,"c",function(){return w}),n.d(t,"a",function(){return T}),n.d(t,"b",function(){return E})},1847:function(e,t,n){"use strict";var a=n(50);Object.defineProperty(t,"__esModule",{value:!0}),t.isGdtAd=m,t.getGdtLandingUrl=p,t.open=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d.commonAd;return new Promise(function(n){i.default.ready().then(function(){i.default.supportsAction(t).then(function(a){a?i.default.dispatch(t,e).then(function(){return n(!0)},function(){return n(!1)}):n(!1)})}).catch(function(){return n(!1)})})},t.openHybridNewAd=function(e,t,n){return g({ad:e,node:t,clickPoint:n,type:"open"})},t.preloadHybridNewAd=function(e,t){return g({ad:e,node:t,type:"preload"})},t.openFormNewAd=function(e){return g({ad:e,type:"adOpenForm"})},t.getHybridAd=h,t.openECommerceDeeplinkAd=function(e){var t=e.url;return new Promise(function(n){i.default.ready().then(function(){i.default.supportsAction("ad/eCommerceOpen").then(function(a){a?i.default.dispatch("ad/eCommerceOpen",e).then(function(e){e.status?n(!0):y(t)},function(){y(t)}):y(t)})}).catch(function(){y(t)})})},t.getHybridEvent=void 0;var o=a(n(88)),r=a(n(206)),i=a(n(95)),s=n(13),c=n(241);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(n,!0).forEach(function(t){(0,o.default)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var d={commonAd:"ad/open",preloadAd:"ad/preload",answerAd:"answer/openAd",adOpenForm:"ad/openForm"};function m(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").indexOf("c.gdt.qq.com")>-1}function p(e,t,n){if(!m(e)||!t||!n)return e;var a=t.getBoundingClientRect(),o=a.left,r=a.top,i=n.clientX-o,s=n.clientY-r,c={__DOWN_X__:Math.abs(i),__DOWN_Y__:Math.abs(s),__UP_X__:Math.abs(i),__UP_Y__:Math.abs(s)};return Object.keys(c).reduce(function(e,t){return e.replace(t,c[t])},e)}function h(e,t,n,a){console.log("We are sending a ".concat(t," request to Hybrid"));var o=e.conversionTracks,i=(0,r.default)(e.creatives,1)[0],c=e.videoProgress,l=e.sdk,u=e.conversionTrackJs,m=e.experimentInfo,h=e.extraConversionTracks,f=e.canvas,b=e.expand,v=void 0===b?{}:b,g=i.asset,y=i.videoInfo,C=v.downloadSilent,O=void 0!==C&&C,j=v.isNewWebview,k=void 0!==j&&j,w=v.isCdnSpeeding,N=v.cdnMap,S=g.landingUrl,I=g.appPromotionUrl,P=g.deepUrl,R=g.packageName,E=g.brandName,x=g.brandLogo,A=g.nativeUrl,T=void 0===A?"":A,L={name:E,logo:x};return[d.commonAd,d.preloadAd,d.adOpenForm].includes(t)?{is_speeding:w,cdn_map:N,download_silent:O,conversion_tracks:o,sdk:(0,s.decamelizeKeys)(l),conversion_track_js:u,extra_conversion_tracks:(0,s.decamelizeKeys)(h),experiment_info:m,creative:{package_name:R,shouldUseNewWebView:k,landing_url:p(S,n,a),app_promotion_url:I,deep_url:P,thumbnail_extra_info:(0,s.decamelizeKeys)(y),video_progress:c,brand:L,native_url:T,canvas:(0,s.decamelizeKeys)(f)}}:{ad:{downloadSilent:O,conversionTracks:o,sdk:l,creatives:[{shouldUseNewWebView:k,landingUrl:p(S,n,a),conversionTracks:o,appPromotionUrl:I,deepUrl:P,brand:L,nativeUrl:T}]}}}function f(e){var t=e.sdk,n=e.adjsonStr,a=e.videoProgress,o=(0,r.default)(e.creatives,1)[0].videoInfo;return{adjson:n,sdk:(0,s.decamelizeKeys)(t),video_progress:a,extra_thumbnail_info:(0,s.decamelizeKeys)(o)}}function b(e,t,n,a){return console.log("getHybridParams(ad, ".concat(t,", node, clickPoint) :"),u({},f(e),{ad:h(e,t,n,a)})),u({},f(e),{ad:h(e,t,n,a)})}var v=function(e){switch(e){case"preload":return d.preloadAd;case"adOpenForm":return d.adOpenForm;default:return d.commonAd}};function g(e){var t=e.ad,n=e.node,a=e.clickPoint,o=e.type,r=v(o);return new Promise(function(e){i.default.ready().then(function(){return i.default.supportsAction(r).then(function(o){o?i.default.dispatch(r,b(t,r,n,a)).then(function(){return e(!0)},function(){return e(!1)}):r===d.commonAd&&i.default.dispatch(d.answerAd,b(t,d.answerAd,n,a)).then(function(){return e(!0)},function(){return e(!1)})})}).catch(function(){var e=(0,c.get)(t,"creatives[0].asset.landingUrl","");if(e&&r===d.commonAd){var n=document.createElement("a");n.href=e,n.click()}})})}function y(e){if(e){var t=document.createElement("a");t.href=e,t.click()}}t.getHybridEvent=v},1849:function(e,t,n){"use strict";var a=n(29),o=n(32),r=n.n(o),i=n(2),s=n.n(i),c=n(1),l=n.n(c),u=n(19),d=n.n(u),m=n(1920),p=n.n(m),h=n(1814),f=n(1885),b=/([-\w]+)(="([^"]+)"|='([^']+)')?/g,v=function(e){for(var t,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).decodeValue,a=void 0!==n&&n,o={};t=b.exec(e);){var r=t[1],i=t[3]||t[4];o[r]=(a?y(i):i)||""}return o},g=function(e){if(!e)return null;try{return JSON.parse(e)}catch(e){return null}};function y(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace(/&amp;/g,"&").replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#34;/g,'"').replace(/&#13;/g,"\r")}var C=/<a\b([^>]*data-draft-type="link-card"[^>]*)>(.*?)<\/a>/g,O=function(e){return e?e.replace(C,function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=v(t,{decodeValue:!0}),o=a.target,r=void 0===o?"_blank":o,i=a.href,s=void 0===i?"":i,c=a["data-image"],u=a["data-image-width"],d=a["data-image-height"],m=a["data-entity-type"],p=a["data-entity-data"],b=n.replace(/<[^>]*>/g,"");return b=y(b),Object(h.renderToStaticMarkup)(l.a.createElement(f.a,{text:b,url:s,target:r,image:c,imageWidth:u,imageHeight:d,entityType:m,entityData:g(p)}))}):e},j=/<p><br><\/p>/g,k=function(e){return e?e.replace(j,'<p class="ztext-empty-paragraph"><br /></p>'):e},w=n(1864),N=/<sup\b([^>]*data-draft-type="reference"[^>]*)>(.*?)<\/sup>/g,S=function(e){return function(t){return function(e,t){if(!e)return e;var n=e,a=[];return n=n.replace(N,function(e,n){var o=v(n,{decodeValue:!0}),r=o["data-text"],i=void 0===r?"":r,s=o["data-url"],c=void 0===s?"":s,u=o["data-numero"],d=t?"ref_".concat(t,"_").concat(u):"ref_".concat(u),m=a.filter(function(e){return e.refKey===d}),p="".concat(d,"_").concat(m.length);a.push({refKey:d,text:i,url:c,numero:u});var f=[i,c].filter(Boolean).join(" ");return Object(h.renderToStaticMarkup)(l.a.createElement("sup",{"data-text":i,"data-url":c,"data-numero":u,"data-draft-node":"inline","data-draft-type":"reference","data-tooltip":f,"data-tooltip-preset":"white","data-tooltip-classname":"ztext-referene-tooltip"},l.a.createElement("a",{id:p,href:"#".concat(d),"data-reference-link":!0,"aria-labelledby":d},"[",u,"]")))}),a.length?n=n.concat(Object(h.renderToStaticMarkup)(l.a.createElement(w.a,{referenceList:a}))):n}(t,e)}},I=function(e){Object(c.useEffect)(function(){e&&Array.from(e.querySelectorAll("img[eeimg]")).forEach(function(e){e.setAttribute("data-formula",e.alt),e.alt="[公式]"})},[e])},P=n(1866),R=n(31),E=n(1867),x=function(e,t){var n=Object(c.useState)(null),o=Object(a.a)(n,2),r=o[0],i=o[1],s=t.onClick;return Object(c.useEffect)(function(){if(e){var t=Array.from(e.querySelectorAll("a[data-mcn-id]"));if(t.length){var n=t.map(function(e){return function(e){var t={id:e.dataset.mcnId},n=document.createElement("div");return n.className="RichText-MCNLinkCardContainer",e.parentNode.replaceChild(n,e),{data:t,target:n}}(e)}).map(function(e,t){var n=e.data,a=e.target;return Object(R.createPortal)(l.a.createElement(E.a,{key:t,id:n.id,onClick:s}),a)});i(n)}}},[e]),r},A=n(153),T=n.n(A),L=n(54),M=n(16),_=n(1830),D=T()(function(){return/Mobile/.test(navigator.userAgent)});function F(e,t){var n={monitor:{type:"Event",imgResourceErrorInfo:{error_description:t,img_url:e,img_from:"web"}}};M.default.trackMonitor({name:t},n)}var B=function(e){return function(t){var n,a=t.target,o=(n=a.dataset.actualsrc,Object(L.imgUrl)(n,{quality:D()?50:80,size:"hd"}));if(a.src=o,a.complete)a.dataset.lazyStatus="ok";else{e&&a.addEventListener("loadstart",function(){e("loadstart",o)}),a.dataset.lazyStatus="loading";var r=setTimeout(function(){a.complete||F(a.url,"image_web_timeout_image"),e&&e("timeout",o)},3e3);a.addEventListener("load",function(){a.dataset.lazyStatus="ok",clearTimeout(r),F(a.url,"image_web_success_image"),e&&e("load",o)}),a.addEventListener("error",function(){clearTimeout(r),F(a.url,"image_web_fail_image"),e&&e("error",o)})}}},z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.disabled,o=void 0!==n&&n,r=t.onLoadStateChange,i=Object(c.useState)([]),s=Object(a.a)(i,2),l=s[0],u=s[1];Object(_.a)(l,B(r),{rootMargin:"300px"}),Object(c.useEffect)(function(){if(e&&!o){var t=Array.from(e.querySelectorAll("img.lazy:not([data-thumbnail])"));t.length&&u(t)}},[e,o])},V=(n(1822),function(e){var t=function(e){if(0!==e.intersectionRatio){var t=e.target;t.dataset.zaDetailViewId=t.cardShowViewId,M.default.trackCardShow(t,{},{link:{url:t.href}}),n.unobserve(t),t.dataset.zaDetailViewId=t.clickViewId}},n=new IntersectionObserver(function(e){e.forEach(t)},{threshold:[.1]});return[{cardShowViewId:1042,clickViewId:1043,selector:"a.external, a.internal"},{cardShowViewId:1044,clickViewId:1045,selector:"a.member_mention, a.UserLink-link"},{cardShowViewId:174,clickViewId:175,selector:"a.video-box"},{cardShowViewId:171,clickViewId:172,selector:'a[data-draft-type="link-card"]'}].forEach(function(t){var a=t.selector,o=t.cardShowViewId,r=t.clickViewId;Array.from(e.querySelectorAll(a)).forEach(function(e){e.cardShowViewId=o,e.clickViewId=r,n.observe(e)})}),function(){n.disconnect()}}),U="function"==typeof queueMicrotask?queueMicrotask:function(e){return Promise.resolve().then(e)},q=function(e){var t=Object(c.useRef)(null);Object(c.useEffect)(function(){if(e)return U(function(){e&&(t.current=V(e))}),function(){t.current&&t.current()}},[e])},W=n(1826),H=(n(1869),n(827),n(1921),p()([k,S(),O])),K=function(e){var t=e.tag,n=void 0===t?"div":t,o=e.className,i=e.html,s=e.onRef,u=e.mcnLinkCardProps,m=void 0===u?{}:u,p=e.clearBoth,h=void 0!==p&&p,f=e.lazyLoadImageProps,b=r()(e,["tag","className","html","onRef","mcnLinkCardProps","clearBoth","lazyLoadImageProps"]),v=Object(c.useState)(null),g=Object(a.a)(v,2),y=g[0],C=g[1];return I(y),Object(P.a)(y),q(y),z(y,f),l.a.createElement(l.a.Fragment,null,x(y,m),l.a.createElement(n,Object.assign({key:i,ref:Object(c.useCallback)(Object(W.a)(C,s),[]),className:d()("RichText","ztext",o,{"RichText--clearBoth":h}),dangerouslySetInnerHTML:{__html:H(i)}},b)))};K.propTypes={tag:s.a.string,html:s.a.string.isRequired,clearBoth:s.a.bool,onRef:s.a.oneOfType([s.a.func,s.a.object])};var G=l.a.memo(K);n.d(t,"a",function(){return G})},1851:function(e,t,n){"use strict";var a=n(4),o=n(5),r=n(8),i=n(6),s=n(7),c=n(2),l=n.n(c),u=n(1),d=n.n(u),m=n(1804),p=(n(1877),function(e){function t(){return Object(a.a)(this,t),Object(r.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"renderThumbnail",value:function(){var e=this.props.error;return d.a.createElement("div",{className:"VideoErrorCard-thumbnail"},d.a.createElement("div",{className:"VideoErrorCard-error"},e.message||"错误"))}},{key:"render",value:function(){var e=this.props,t=e.isLens,n=e.id;return d.a.createElement("div",{className:"VideoErrorCard"},d.a.createElement(m.b,Object.assign({},this.props,t&&{playerUrl:"https://www.zhihu.com/video/".concat(n)},{thumbnail:this.renderThumbnail(),showPlayButton:!1,onBeforePlay:function(){return!1}})))}}]),t}(u.Component));p.propTypes={error:l.a.object.isRequired},t.a=p},1857:function(e,t,n){var a=n(826),o=a&&new a;e.exports=o},1858:function(e,t){e.exports={}},1859:function(e,t,n){var a=n(1803),o=n(1819),r=n(1820),i=n(1860);e.exports=function(e){var t=r(e),n=i[t];if("function"!=typeof n||!(t in a.prototype))return!1;if(e===n)return!0;var s=o(n);return!!s&&e===s[0]}},1860:function(e,t,n){var a=n(1803),o=n(1801),r=n(1802),i=n(104),s=n(118),c=n(1861),l=Object.prototype.hasOwnProperty;function u(e){if(s(e)&&!i(e)&&!(e instanceof a)){if(e instanceof o)return e;if(l.call(e,"__wrapped__"))return c(e)}return new o(e)}u.prototype=r.prototype,u.prototype.constructor=u,e.exports=u},1861:function(e,t,n){var a=n(1803),o=n(1801),r=n(505);e.exports=function(e){if(e instanceof a)return e.clone();var t=new o(e.__wrapped__,e.__chain__);return t.__actions__=r(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}},1862:function(e,t,n){"use strict";
/** @license React v16.9.0
 * react-dom-server.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a=n(478),o=n(1);function r(e){for(var t=e.message,n="https://reactjs.org/docs/error-decoder.html?invariant="+t,a=1;a<arguments.length;a++)n+="&args[]="+encodeURIComponent(arguments[a]);return e.message="Minified React error #"+t+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",e}var i="function"==typeof Symbol&&Symbol.for,s=i?Symbol.for("react.portal"):60106,c=i?Symbol.for("react.fragment"):60107,l=i?Symbol.for("react.strict_mode"):60108,u=i?Symbol.for("react.profiler"):60114,d=i?Symbol.for("react.provider"):60109,m=i?Symbol.for("react.context"):60110,p=i?Symbol.for("react.concurrent_mode"):60111,h=i?Symbol.for("react.forward_ref"):60112,f=i?Symbol.for("react.suspense"):60113,b=i?Symbol.for("react.suspense_list"):60120,v=i?Symbol.for("react.memo"):60115,g=i?Symbol.for("react.lazy"):60116,y=i?Symbol.for("react.fundamental"):60117;function C(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case c:return"Fragment";case s:return"Portal";case u:return"Profiler";case l:return"StrictMode";case f:return"Suspense";case b:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case m:return"Context.Consumer";case d:return"Context.Provider";case h:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case v:return C(e.type);case g:if(e=1===e._status?e._result:null)return C(e)}return null}var O=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;O.hasOwnProperty("ReactCurrentDispatcher")||(O.ReactCurrentDispatcher={current:null}),O.hasOwnProperty("ReactCurrentBatchConfig")||(O.ReactCurrentBatchConfig={suspense:null});var j={};function k(e,t){for(var n=0|e._threadCount;n<=t;n++)e[n]=e._currentValue2,e._threadCount=n+1}for(var w=new Uint16Array(16),N=0;15>N;N++)w[N]=N+1;w[15]=0;var S=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,I=Object.prototype.hasOwnProperty,P={},R={};function E(e){return!!I.call(R,e)||!I.call(P,e)&&(S.test(e)?R[e]=!0:(P[e]=!0,!1))}function x(e,t,n,a,o,r){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=a,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=r}var A={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){A[e]=new x(e,0,!1,e,null,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];A[t]=new x(t,1,!1,e[1],null,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){A[e]=new x(e,2,!1,e.toLowerCase(),null,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){A[e]=new x(e,2,!1,e,null,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){A[e]=new x(e,3,!1,e.toLowerCase(),null,!1)}),["checked","multiple","muted","selected"].forEach(function(e){A[e]=new x(e,3,!0,e,null,!1)}),["capture","download"].forEach(function(e){A[e]=new x(e,4,!1,e,null,!1)}),["cols","rows","size","span"].forEach(function(e){A[e]=new x(e,6,!1,e,null,!1)}),["rowSpan","start"].forEach(function(e){A[e]=new x(e,5,!1,e.toLowerCase(),null,!1)});var T=/[\-:]([a-z])/g;function L(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(T,L);A[t]=new x(t,1,!1,e,null,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(T,L);A[t]=new x(t,1,!1,e,"http://www.w3.org/1999/xlink",!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(T,L);A[t]=new x(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1)}),["tabIndex","crossOrigin"].forEach(function(e){A[e]=new x(e,1,!1,e.toLowerCase(),null,!1)}),A.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0),["src","href","action","formAction"].forEach(function(e){A[e]=new x(e,1,!1,e.toLowerCase(),null,!0)});var M=/["'&<>]/;function _(e){if("boolean"==typeof e||"number"==typeof e)return""+e;e=""+e;var t=M.exec(e);if(t){var n,a="",o=0;for(n=t.index;n<e.length;n++){switch(e.charCodeAt(n)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#x27;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}o!==n&&(a+=e.substring(o,n)),o=n+1,a+=t}e=o!==n?a+e.substring(o,n):a}return e}function D(e,t){var n,a=A.hasOwnProperty(e)?A[e]:null;return(n="style"!==e)&&(n=null!==a?0===a.type:2<e.length&&("o"===e[0]||"O"===e[0])&&("n"===e[1]||"N"===e[1])),n||function(e,t,n,a){if(null==t||function(e,t,n,a){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!a&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,a))return!0;if(a)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(e,t,a,!1)?"":null!==a?(e=a.attributeName,3===(n=a.type)||4===n&&!0===t?e+'=""':(a.sanitizeURL&&(t=""+t),e+'="'+_(t)+'"')):E(e)?e+'="'+_(t)+'"':""}var F=null,B=null,z=null,V=!1,U=!1,q=null,W=0;function H(){if(null===F)throw r(Error(321));return F}function K(){if(0<W)throw r(Error(312));return{memoizedState:null,queue:null,next:null}}function G(){return null===z?null===B?(V=!1,B=z=K()):(V=!0,z=B):null===z.next?(V=!1,z=z.next=K()):(V=!0,z=z.next),z}function Q(e,t,n,a){for(;U;)U=!1,W+=1,z=null,n=e(t,a);return B=F=null,W=0,z=q=null,n}function Y(e,t){return"function"==typeof t?t(e):t}function $(e,t,n){if(F=H(),z=G(),V){var a=z.queue;if(t=a.dispatch,null!==q&&void 0!==(n=q.get(a))){q.delete(a),a=z.memoizedState;do{a=e(a,n.action),n=n.next}while(null!==n);return z.memoizedState=a,[a,t]}return[z.memoizedState,t]}return e=e===Y?"function"==typeof t?t():t:void 0!==n?n(t):t,z.memoizedState=e,e=(e=z.queue={last:null,dispatch:null}).dispatch=function(e,t,n){if(!(25>W))throw r(Error(301));if(e===F)if(U=!0,e={action:n,next:null},null===q&&(q=new Map),void 0===(n=q.get(t)))q.set(t,e);else{for(t=n;null!==t.next;)t=t.next;t.next=e}}.bind(null,F,e),[z.memoizedState,e]}function J(){}var Z=0,X={readContext:function(e){var t=Z;return k(e,t),e[t]},useContext:function(e){H();var t=Z;return k(e,t),e[t]},useMemo:function(e,t){if(F=H(),t=void 0===t?null:t,null!==(z=G())){var n=z.memoizedState;if(null!==n&&null!==t){e:{var a=n[1];if(null===a)a=!1;else{for(var o=0;o<a.length&&o<t.length;o++){var r=t[o],i=a[o];if((r!==i||0===r&&1/r!=1/i)&&(r==r||i==i)){a=!1;break e}}a=!0}}if(a)return n[0]}}return e=e(),z.memoizedState=[e,t],e},useReducer:$,useRef:function(e){F=H();var t=(z=G()).memoizedState;return null===t?(e={current:e},z.memoizedState=e):t},useState:function(e){return $(Y,e)},useLayoutEffect:function(){},useCallback:function(e){return e},useImperativeHandle:J,useEffect:J,useDebugValue:J,useResponder:function(e,t){return{props:t,responder:e}}},ee={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};function te(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}var ne={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},ae=a({menuitem:!0},ne),oe={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},re=["Webkit","ms","Moz","O"];Object.keys(oe).forEach(function(e){re.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),oe[t]=oe[e]})});var ie=/([A-Z])/g,se=/^ms-/,ce=o.Children.toArray,le=O.ReactCurrentDispatcher,ue={listing:!0,pre:!0,textarea:!0},de=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,me={},pe={};var he=Object.prototype.hasOwnProperty,fe={children:null,dangerouslySetInnerHTML:null,suppressContentEditableWarning:null,suppressHydrationWarning:null};function be(e,t){if(void 0===e)throw r(Error(152),C(t)||"Component")}function ve(e,t,n){function i(o,i){var s=i.prototype&&i.prototype.isReactComponent,c=function(e,t,n,a){if(a&&"object"==typeof(a=e.contextType)&&null!==a)return k(a,n),a[n];if(e=e.contextTypes){for(var o in n={},e)n[o]=t[o];t=n}else t=j;return t}(i,t,n,s),l=[],u=!1,d={isMounted:function(){return!1},enqueueForceUpdate:function(){if(null===l)return null},enqueueReplaceState:function(e,t){u=!0,l=[t]},enqueueSetState:function(e,t){if(null===l)return null;l.push(t)}},m=void 0;if(s)m=new i(o.props,c,d),"function"==typeof i.getDerivedStateFromProps&&(null!=(s=i.getDerivedStateFromProps.call(null,o.props,m.state))&&(m.state=a({},m.state,s)));else if(F={},m=i(o.props,c,d),null==(m=Q(i,o.props,m,c))||null==m.render)return void be(e=m,i);if(m.props=o.props,m.context=c,m.updater=d,void 0===(d=m.state)&&(m.state=d=null),"function"==typeof m.UNSAFE_componentWillMount||"function"==typeof m.componentWillMount)if("function"==typeof m.componentWillMount&&"function"!=typeof i.getDerivedStateFromProps&&m.componentWillMount(),"function"==typeof m.UNSAFE_componentWillMount&&"function"!=typeof i.getDerivedStateFromProps&&m.UNSAFE_componentWillMount(),l.length){d=l;var p=u;if(l=null,u=!1,p&&1===d.length)m.state=d[0];else{s=p?d[0]:m.state;var h=!0;for(p=p?1:0;p<d.length;p++){var f=d[p];null!=(f="function"==typeof f?f.call(m,s,o.props,c):f)&&(h?(h=!1,s=a({},s,f)):a(s,f))}m.state=s}}else l=null;if(be(e=m.render(),i),o=void 0,"function"==typeof m.getChildContext&&"object"==typeof(c=i.childContextTypes))for(var b in o=m.getChildContext())if(!(b in c))throw r(Error(108),C(i)||"Unknown",b);o&&(t=a({},t,o))}for(;o.isValidElement(e);){var s=e,c=s.type;if("function"!=typeof c)break;i(s,c)}return{child:e,context:t}}var ge=function(){function e(t,n){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");o.isValidElement(t)?t.type!==c?t=[t]:(t=t.props.children,t=o.isValidElement(t)?[t]:ce(t)):t=ce(t),t={type:null,domNamespace:ee.html,children:t,childIndex:0,context:j,footer:""};var a=w[0];if(0===a){var i=w,s=2*(a=i.length);if(!(65536>=s))throw r(Error(304));var l=new Uint16Array(s);for(l.set(i),(w=l)[0]=a+1,i=a;i<s-1;i++)w[i]=i+1;w[s-1]=0}else w[0]=w[a];this.threadID=a,this.stack=[t],this.exhausted=!1,this.currentSelectValue=null,this.previousWasTextNode=!1,this.makeStaticMarkup=n,this.suspenseDepth=0,this.contextIndex=-1,this.contextStack=[],this.contextValueStack=[]}return e.prototype.destroy=function(){if(!this.exhausted){this.exhausted=!0,this.clearProviders();var e=this.threadID;w[e]=w[0],w[0]=e}},e.prototype.pushProvider=function(e){var t=++this.contextIndex,n=e.type._context,a=this.threadID;k(n,a);var o=n[a];this.contextStack[t]=n,this.contextValueStack[t]=o,n[a]=e.props.value},e.prototype.popProvider=function(){var e=this.contextIndex,t=this.contextStack[e],n=this.contextValueStack[e];this.contextStack[e]=null,this.contextValueStack[e]=null,this.contextIndex--,t[this.threadID]=n},e.prototype.clearProviders=function(){for(var e=this.contextIndex;0<=e;e--)this.contextStack[e][this.threadID]=this.contextValueStack[e]},e.prototype.read=function(e){if(this.exhausted)return null;var t=Z;Z=this.threadID;var n=le.current;le.current=X;try{for(var a=[""],o=!1;a[0].length<e;){if(0===this.stack.length){this.exhausted=!0;var i=this.threadID;w[i]=w[0],w[0]=i;break}var s=this.stack[this.stack.length-1];if(o||s.childIndex>=s.children.length){var c=s.footer;if(""!==c&&(this.previousWasTextNode=!1),this.stack.pop(),"select"===s.type)this.currentSelectValue=null;else if(null!=s.type&&null!=s.type.type&&s.type.type.$$typeof===d)this.popProvider(s.type);else if(s.type===f){this.suspenseDepth--;var l=a.pop();if(o){o=!1;var u=s.fallbackFrame;if(!u)throw r(Error(303));this.stack.push(u),a[this.suspenseDepth]+="\x3c!--$!--\x3e";continue}a[this.suspenseDepth]+=l}a[this.suspenseDepth]+=c}else{var m=s.children[s.childIndex++],p="";try{p+=this.render(m,s.context,s.domNamespace)}catch(e){throw e}a.length<=this.suspenseDepth&&a.push(""),a[this.suspenseDepth]+=p}}return a[0]}finally{le.current=n,Z=t}},e.prototype.render=function(e,t,n){if("string"==typeof e||"number"==typeof e)return""===(n=""+e)?"":this.makeStaticMarkup?_(n):this.previousWasTextNode?"\x3c!-- --\x3e"+_(n):(this.previousWasTextNode=!0,_(n));if(e=(t=ve(e,t,this.threadID)).child,t=t.context,null===e||!1===e)return"";if(!o.isValidElement(e)){if(null!=e&&null!=e.$$typeof){if((n=e.$$typeof)===s)throw r(Error(257));throw r(Error(258),n.toString())}return e=ce(e),this.stack.push({type:null,domNamespace:n,children:e,childIndex:0,context:t,footer:""}),""}var i=e.type;if("string"==typeof i)return this.renderDOM(e,t,n);switch(i){case l:case p:case u:case b:case c:return e=ce(e.props.children),this.stack.push({type:null,domNamespace:n,children:e,childIndex:0,context:t,footer:""}),"";case f:throw r(Error(294))}if("object"==typeof i&&null!==i)switch(i.$$typeof){case h:F={};var C=i.render(e.props,e.ref);return C=Q(i.render,e.props,C,e.ref),C=ce(C),this.stack.push({type:null,domNamespace:n,children:C,childIndex:0,context:t,footer:""}),"";case v:return e=[o.createElement(i.type,a({ref:e.ref},e.props))],this.stack.push({type:null,domNamespace:n,children:e,childIndex:0,context:t,footer:""}),"";case d:return n={type:e,domNamespace:n,children:i=ce(e.props.children),childIndex:0,context:t,footer:""},this.pushProvider(e),this.stack.push(n),"";case m:i=e.type,C=e.props;var O=this.threadID;return k(i,O),i=ce(C.children(i[O])),this.stack.push({type:e,domNamespace:n,children:i,childIndex:0,context:t,footer:""}),"";case y:throw r(Error(338));case g:throw r(Error(295))}throw r(Error(130),null==i?i:typeof i,"")},e.prototype.renderDOM=function(e,t,n){var i=e.type.toLowerCase();if(n===ee.html&&te(i),!me.hasOwnProperty(i)){if(!de.test(i))throw r(Error(65),i);me[i]=!0}var s=e.props;if("input"===i)s=a({type:void 0},s,{defaultChecked:void 0,defaultValue:void 0,value:null!=s.value?s.value:s.defaultValue,checked:null!=s.checked?s.checked:s.defaultChecked});else if("textarea"===i){var c=s.value;if(null==c){c=s.defaultValue;var l=s.children;if(null!=l){if(null!=c)throw r(Error(92));if(Array.isArray(l)){if(!(1>=l.length))throw r(Error(93));l=l[0]}c=""+l}null==c&&(c="")}s=a({},s,{value:void 0,children:""+c})}else if("select"===i)this.currentSelectValue=null!=s.value?s.value:s.defaultValue,s=a({},s,{value:void 0});else if("option"===i){l=this.currentSelectValue;var u=function(e){if(null==e)return e;var t="";return o.Children.forEach(e,function(e){null!=e&&(t+=e)}),t}(s.children);if(null!=l){var d=null!=s.value?s.value+"":u;if(c=!1,Array.isArray(l)){for(var m=0;m<l.length;m++)if(""+l[m]===d){c=!0;break}}else c=""+l===d;s=a({selected:void 0,children:void 0},s,{selected:c,children:u})}}if(c=s){if(ae[i]&&(null!=c.children||null!=c.dangerouslySetInnerHTML))throw r(Error(137),i,"");if(null!=c.dangerouslySetInnerHTML){if(null!=c.children)throw r(Error(60));if(!("object"==typeof c.dangerouslySetInnerHTML&&"__html"in c.dangerouslySetInnerHTML))throw r(Error(61))}if(null!=c.style&&"object"!=typeof c.style)throw r(Error(62),"")}for(C in c=s,l=this.makeStaticMarkup,u=1===this.stack.length,d="<"+e.type,c)if(he.call(c,C)){var p=c[C];if(null!=p){if("style"===C){m=void 0;var h="",f="";for(m in p)if(p.hasOwnProperty(m)){var b=0===m.indexOf("--"),v=p[m];if(null!=v){if(b)var g=m;else if(g=m,pe.hasOwnProperty(g))g=pe[g];else{var y=g.replace(ie,"-$1").toLowerCase().replace(se,"-ms-");g=pe[g]=y}h+=f+g+":",f=m,h+=b=null==v||"boolean"==typeof v||""===v?"":b||"number"!=typeof v||0===v||oe.hasOwnProperty(f)&&oe[f]?(""+v).trim():v+"px",f=";"}}p=h||null}m=null;e:if(b=i,v=c,-1===b.indexOf("-"))b="string"==typeof v.is;else switch(b){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":b=!1;break e;default:b=!0}b?fe.hasOwnProperty(C)||(m=E(m=C)&&null!=p?m+'="'+_(p)+'"':""):m=D(C,p),m&&(d+=" "+m)}}l||u&&(d+=' data-reactroot=""');var C=d;c="",ne.hasOwnProperty(i)?C+="/>":(C+=">",c="</"+e.type+">");e:{if(null!=(l=s.dangerouslySetInnerHTML)){if(null!=l.__html){l=l.__html;break e}}else if("string"==typeof(l=s.children)||"number"==typeof l){l=_(l);break e}l=null}return null!=l?(s=[],ue[i]&&"\n"===l.charAt(0)&&(C+="\n"),C+=l):s=ce(s.children),e=e.type,n=null==n||"http://www.w3.org/1999/xhtml"===n?te(e):"http://www.w3.org/2000/svg"===n&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":n,this.stack.push({domNamespace:n,type:i,children:s,childIndex:0,context:t,footer:c}),this.previousWasTextNode=!1,C},e}(),ye={renderToString:function(e){e=new ge(e,!1);try{return e.read(1/0)}finally{e.destroy()}},renderToStaticMarkup:function(e){e=new ge(e,!0);try{return e.read(1/0)}finally{e.destroy()}},renderToNodeStream:function(){throw r(Error(207))},renderToStaticNodeStream:function(){throw r(Error(208))},version:"16.9.0"},Ce={default:ye},Oe=Ce&&ye||Ce;e.exports=Oe.default||Oe},1863:function(e,t,n){},1864:function(e,t,n){"use strict";var a=n(1),o=n.n(a),r=n(243),i=n.n(r);n(1865);t.a=function(e){var t=e.referenceList,n=e.onClick,a=e.listRef;return o.a.createElement(o.a.Fragment,null,o.a.createElement("h2",null,"参考"),o.a.createElement("ol",{className:"ReferenceList",onClick:n,ref:a},i()(t,"refKey").map(function(e){var n=t.filter(function(t){return t.refKey===e.refKey}),a=n.length>1?o.a.createElement(o.a.Fragment,null,o.a.createElement("span",{className:"ReferenceList-backHint","aria-label":"back"},"^"),n.map(function(e,t){var n="".concat(e.refKey,"_").concat(t);return o.a.createElement("sup",{key:n,className:"ReferenceList-backLink"},o.a.createElement("a",{href:"#".concat(n),"data-reference-link":!0},"abcdefghijklmnopqrstuvwxyz"[t%26]))})):o.a.createElement("a",{className:"ReferenceList-backLink",href:"#".concat(e.refKey,"_0"),"aria-label":"back","data-reference-link":!0},"^");return o.a.createElement("li",{id:e.refKey,key:e.refKey,tabIndex:0},a,e.text&&o.a.createElement("span",null,e.text),e.text&&e.url&&" ",e.url&&o.a.createElement("a",{href:e.url,className:"external",target:"_blank",rel:"noopener noreferrer"},e.url))})))}},1865:function(e,t,n){},1866:function(e,t,n){"use strict";var a=n(1);var o=function(e,t){var n;if(!e.defaultPrevented&&e.target.matches("a[data-reference-link]")){var a=e.target.getAttribute("href"),o=t.querySelector(a);o&&(e.preventDefault(),o.focus({preventScroll:!0}),n=o.getBoundingClientRect().top+window.pageYOffset-Math.max(window.innerHeight/10,100),window.scrollTo({top:n,behavior:"smooth"}),document.documentElement.setAttribute("data-focus-visible",""))}};t.a=function(e){var t=Object(a.useCallback)(function(t){return o(t,e)},[e]);Object(a.useEffect)(function(){if(e)return e.addEventListener("click",t),function(){e.removeEventListener("click",t)}},[e,t])}},1867:function(e,t,n){"use strict";var a=n(29),o=n(1),r=n.n(o),i=n(197),s=n(16),c=n(272),l=n.n(c),u=n(19),d=n.n(u),m=n(825),p=n.n(m);n(1868);t.a=r.a.forwardRef(function(e,t){var n=Object(o.useState)(null),c=Object(a.a)(n,2),u=c[0],m=c[1],h=e.component,f=void 0===h?"a":h,b=e.id,v=e.className,g=e.onClick,y=e.onMouseDown,C=e.refetchKey,O=e.onData,j=void 0===O?l.a:O,k=Object(o.useRef)(null);if(Object(o.useEffect)(function(){null!==C&&function(e){var t=e.id;return p()("https://www.zhihu.com/api/v4/mcn/linkcard/".concat(t),{credentials:"include",headers:{"X-Requested-With":"Fetch"}}).then(function(e){return e.json()})}({id:b}).then(function(e){var t=e.data;m(t),j(t)})},[b,m,j,C]),Object(o.useEffect)(function(){k.current&&Object(i.onViewedOnce)(k.current.parentNode,function(){s.default.trackCardShow(k.current.parentNode,{id:6108})})},[u]),!u)return r.a.createElement(f,{ref:t,className:d()("MCNLinkCard","MCNLinkCard-placeholder",v),"data-draft-node":"block","data-draft-type":"mcn-link-card"});var w,N,S=u.url,I=u.title,P=u.img_token,R=u.price,E=u.source;return r.a.createElement(f,{ref:t,className:d()("MCNLinkCard",v),"data-draft-node":"block","data-draft-type":"mcn-link-card","data-mcn-id":u.id,"data-mcn-skuid":u.skuid,"data-mcn-source":u.source,"data-za-detail-view-name":u.id,"data-za-not-track-link":!0,href:S,target:"_blank",rel:"noopener noreferrer",onClick:function(e){s.default.trackEvent(e.currentTarget,{id:6208}),g(e)},onMouseDown:y},r.a.createElement("div",{className:"MCNLinkCard-card",ref:k},r.a.createElement("div",{className:"MCNLinkCard-backdrop",style:{backgroundImage:"url(".concat(P,")")}}),r.a.createElement("div",{className:"MCNLinkCard-cardContainer"},r.a.createElement("div",{className:"MCNLinkCard-imageContainer"},r.a.createElement("img",{className:"MCNLinkCard-image",src:P,alt:"Good"}),E&&r.a.createElement("div",{className:"MCNLinkCard-sourceInImage"},E)),r.a.createElement("div",{className:"MCNLinkCard-info"},r.a.createElement("div",{className:"MCNLinkCard-title"},I),r.a.createElement("div",{className:"MCNLinkCard-tool"},r.a.createElement("div",{className:"MCNLinkCard-price"},r.a.createElement("div",{className:"MCNLinkCard-priceNumber"},(w=R,N=1===String(w).length?"0".concat(w):String(w).slice(-2),"￥".concat(Math.floor(w/100),".").concat(N))),E&&r.a.createElement("div",{className:"MCNLinkCard-source"},E)),r.a.createElement("div",{className:"MCNLinkCard-button"},"去购买"))))))})},1868:function(e,t,n){},1869:function(e,t,n){},1871:function(e,t,n){},1872:function(e,t,n){"use strict";
/*!
 * bytes
 * Copyright(c) 2012-2014 TJ Holowaychuk
 * Copyright(c) 2015 Jed Watson
 * MIT Licensed
 */e.exports=function(e,t){if("string"==typeof e)return c(e);if("number"==typeof e)return s(e,t);return null},e.exports.format=s,e.exports.parse=c;var a=/\B(?=(\d{3})+(?!\d))/g,o=/(?:\.0*|(\.[^0]+)0+)$/,r={b:1,kb:1024,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},i=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function s(e,t){if(!Number.isFinite(e))return null;var n=Math.abs(e),i=t&&t.thousandsSeparator||"",s=t&&t.unitSeparator||"",c=t&&void 0!==t.decimalPlaces?t.decimalPlaces:2,l=Boolean(t&&t.fixedDecimals),u=t&&t.unit||"";u&&r[u.toLowerCase()]||(u=n>=r.pb?"PB":n>=r.tb?"TB":n>=r.gb?"GB":n>=r.mb?"MB":n>=r.kb?"KB":"B");var d=(e/r[u.toLowerCase()]).toFixed(c);return l||(d=d.replace(o,"$1")),i&&(d=d.replace(a,i)),d+s+u}function c(e){if("number"==typeof e&&!isNaN(e))return e;if("string"!=typeof e)return null;var t,n=i.exec(e),a="b";return n?(t=parseFloat(n[1]),a=n[4].toLowerCase()):(t=parseInt(e,10),a="b"),Math.floor(r[a]*t)}},1873:function(e,t,n){},1874:function(e,t,n){},1875:function(e,t,n){"use strict";e.exports=n(1876)},1876:function(e,t,n){"use strict";
/** @license React v16.4.1
 * create-subscription.production.min.js
 *
 * Copyright (c) 2013-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Object.defineProperty(t,"__esModule",{value:!0});var a=n(382),o=n(1);function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}t.createSubscription=function(e){var t=e.getCurrentValue,n=e.subscribe;return function(e){function o(){var n,a;if(!(this instanceof o))throw new TypeError("Cannot call a class as a function");for(var i=arguments.length,s=Array(i),c=0;c<i;c++)s[c]=arguments[c];return n=a=r(this,e.call.apply(e,[this].concat(s))),a.state={source:a.props.source,value:null!=a.props.source?t(a.props.source):void 0},a._hasUnmounted=!1,a._unsubscribe=null,r(a,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(o,e),o.getDerivedStateFromProps=function(e,n){return e.source!==n.source?{source:e.source,value:null!=e.source?t(e.source):void 0}:null},o.prototype.componentDidMount=function(){this.subscribe()},o.prototype.componentDidUpdate=function(e,t){this.state.source!==t.source&&(this.unsubscribe(t),this.subscribe())},o.prototype.componentWillUnmount=function(){this.unsubscribe(this.state),this._hasUnmounted=!0},o.prototype.render=function(){return this.props.children(this.state.value)},o.prototype.subscribe=function(){var e=this,o=this.state.source;if(null!=o){var r=n(o,function(t){e._hasUnmounted||e.setState(function(e){return t===e.value||o!==e.source?null:{value:t}})});"function"!=typeof r&&function(e){for(var t=arguments.length-1,n="https://reactjs.org/docs/error-decoder.html?invariant="+e,o=0;o<t;o++)n+="&args[]="+encodeURIComponent(arguments[o+1]);a(!1,"Minified React error #"+e+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",n)}("266"),this._unsubscribe=r,(r=t(this.props.source))!==this.state.value&&this.setState({value:r})}},o.prototype.unsubscribe=function(){"function"==typeof this._unsubscribe&&this._unsubscribe(),this._unsubscribe=null},o}(o.Component)}},1877:function(e,t,n){},1878:function(e,t,n){(function(t){var n,a=t.crypto||t.msCrypto;if(a&&a.getRandomValues){var o=new Uint8Array(16);n=function(){return a.getRandomValues(o),o}}if(!n){var r=new Array(16);n=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}e.exports=n}).call(this,n(47))},1879:function(e,t){for(var n=[],a=0;a<256;++a)n[a]=(a+256).toString(16).substr(1);e.exports=function(e,t){var a=t||0,o=n;return o[e[a++]]+o[e[a++]]+o[e[a++]]+o[e[a++]]+"-"+o[e[a++]]+o[e[a++]]+"-"+o[e[a++]]+o[e[a++]]+"-"+o[e[a++]]+o[e[a++]]+"-"+o[e[a++]]+o[e[a++]]+o[e[a++]]+o[e[a++]]+o[e[a++]]+o[e[a++]]}},1885:function(e,t,n){"use strict";var a=n(4),o=n(5),r=n(8),i=n(6),s=n(7),c=n(29),l=n(32),u=n.n(l),d=n(1),m=n.n(d),p=n(2),h=n.n(p),f=n(10),b=function(e){return m.a.createElement(f.a,e,m.a.createElement("path",{d:"M11.991 3C7.023 3 3 7.032 3 12s4.023 9 8.991 9C16.968 21 21 16.968 21 12s-4.032-9-9.009-9zm6.237 5.4h-2.655a14.084 14.084 0 0 0-1.242-3.204A7.227 7.227 0 0 1 18.228 8.4zM12 4.836A12.678 12.678 0 0 1 13.719 8.4h-3.438A12.678 12.678 0 0 1 12 4.836zM5.034 13.8A7.418 7.418 0 0 1 4.8 12c0-.621.09-1.224.234-1.8h3.042A14.864 14.864 0 0 0 7.95 12c0 .612.054 1.206.126 1.8H5.034zm.738 1.8h2.655a14.084 14.084 0 0 0 1.242 3.204A7.188 7.188 0 0 1 5.772 15.6zm2.655-7.2H5.772a7.188 7.188 0 0 1 3.897-3.204c-.54.999-.954 2.079-1.242 3.204zM12 19.164a12.678 12.678 0 0 1-1.719-3.564h3.438A12.678 12.678 0 0 1 12 19.164zm2.106-5.364H9.894A13.242 13.242 0 0 1 9.75 12c0-.612.063-1.215.144-1.8h4.212c.081.585.144 1.188.144 1.8 0 .612-.063 1.206-.144 1.8zm.225 5.004c.54-.999.954-2.079 1.242-3.204h2.655a7.227 7.227 0 0 1-3.897 3.204zm1.593-5.004c.072-.594.126-1.188.126-1.8 0-.612-.054-1.206-.126-1.8h3.042c.144.576.234 1.179.234 1.8s-.09 1.224-.234 1.8h-3.042z"}))};b.defaultProps={name:"Browser"};var v=b,g=n(1771),y=n(19),C=n.n(y),O=n(48),j=n.n(O),k=n(54),w=(n(1863),function(){return m.a.createElement("div",{className:"LinkCard-image LinkCard-image--default"},m.a.createElement(v,{size:32}))}),N=/^https?:\/\/link\.zhihu\.com/,S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e;if(N.test(e)){var n=e.match(/target=([^=]+)/)||[],a=Object(c.a)(n,2)[1];a&&(t=decodeURIComponent(a))}var o=t.split("/");return Object(c.a)(o,3)[2]||""},I=function(e){function t(){return Object(a.a)(this,t),Object(r.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"renderLinkMeta",value:function(){var e=this.props,t=e.url,n=e.entityType,a=e.entityData,o=S(t);if(n&&a&&"job"===n){var r=a.salary,i=a.city,s=a.location,c=a.seniority,l=a.education;return m.a.createElement("span",{className:"LinkCard-meta"},m.a.createElement("span",{className:"LinkCard-textMeta"},c&&m.a.createElement("span",{className:"LinkCard-metaItem"},c),l&&m.a.createElement("span",{className:"LinkCard-metaItem"},l),(i||s)&&m.a.createElement("span",{className:"LinkCard-metaItem"},i,m.a.createElement("span",{className:"LinkCard-metaItem-jobLocation"},s))),r&&m.a.createElement("span",{className:"LinkCard-badge"},r))}return m.a.createElement("span",{className:"LinkCard-meta"},m.a.createElement(g.a,{size:17,center:!0}),o)}},{key:"render",value:function(){var e=j()(this.props,["entityType","entityData"]),t=e.text,n=e.target,a=e.url,o=e.image,r=e.imageWidth,i=e.imageHeight,s=e.component,c=e.className,l=u()(e,["text","target","url","image","imageWidth","imageHeight","component","className"]),d=function(e,t){if(e>0&&t>0){var n=e/t;if(n>1.2)return{modifier:"horizontal",size:"180x120"};if(n<=.8)return{modifier:"vertical",size:"120x160"}}return{modifier:"square",size:"ipico"}}(r,i),p=d.modifier,h=d.size,f=!o&&function(e){var t=S(e);return"zhihu.com"===t||t.endsWith(".zhihu.com")}(a)?"https://zhstatic.zhihu.com/assets/zhihu/editor/zhihu-card-default.svg":Object(k.imgUrl)(o,h);return m.a.createElement(s,Object.assign({target:n,href:a,"data-draft-node":"block","data-draft-type":"link-card"},f&&{"data-image":f},r&&{"data-image-width":r},i&&{"data-image-height":i},{className:C()("LinkCard",c,{"LinkCard--hasImage":Boolean(f),"LinkCard--noImage":!f})},l),f&&m.a.createElement("span",{className:"LinkCard-backdrop",style:{backgroundImage:"url(".concat(f,")")}}),m.a.createElement("span",{className:"LinkCard-content"},m.a.createElement("span",{className:"LinkCard-text"},m.a.createElement("span",{className:"LinkCard-title","data-text":!0},t),this.renderLinkMeta()),m.a.createElement("span",{className:"LinkCard-imageCell"},f?m.a.createElement("img",{className:C()("LinkCard-image","LinkCard-image--".concat(p)),alt:"图标",src:f}):m.a.createElement(w,null))))}}]),t}(m.a.Component);I.propTypes={component:h.a.oneOfType([h.a.string,h.a.func]),target:h.a.string,url:h.a.string.isRequired,text:h.a.string.isRequired,image:h.a.string,imageWidth:h.a.oneOfType([h.a.string,h.a.number]),imageHeight:h.a.oneOfType([h.a.string,h.a.number])},I.defaultProps={component:"a",target:"_blank"};t.a=I},1920:function(e,t,n){var a=n(1831)(!0);e.exports=a},1921:function(e,t,n){},1922:function(e,t,n){},1923:function(e,t,n){"use strict";var a=n(50);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=a(n(88)),i=a(n(89)),s=a(n(135)),c=a(n(106)),l=a(n(94)),u=a(n(107)),d=a(n(1)),m=a(n(1825)),p=n(486),h=n(822),f=n(824),b=n(241),v=n(1847);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}n(1926);var y=" https://sugar.zhihu.com/plutus_adreaper/page_monitor_log",C="ecommerce-ad",O=(0,h.errorWrapper)(o=function(e){function t(){var e,n;(0,i.default)(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(n=(0,c.default)(this,(e=(0,l.default)(t)).call.apply(e,[this].concat(o)))).onClick=function(e){e.stopPropagation(),e.preventDefault();var t=n.props,a=t.data,o=t.parentType;try{var i="".concat(y,"?at=click&pt=").concat(o,"&et=").concat(n.getET(),"&ti=").concat(n.ti,"&si=").concat(n.si);(0,b.track)(i),(0,p.zaTrack)("trackEvent",n.node.current,{id:5641,action:"Click"}),(0,v.openECommerceDeeplinkAd)(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(n,!0).forEach(function(t){(0,r.default)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},a,{token:n.getToken(),pagetype:o}))}catch(e){console.error(e.message)}},n.getET=function(){var e=window.navigator.appVersion;return e.toLowerCase().includes("iphone")?"ios_commodity":e.toLowerCase().includes("android")?"android_commodity":"pc_commodity"},n.getToken=function(){var e=window.location.pathname.match(/\/(\d+)/g);return e?e.pop().replace("/",""):""},n.si=(0,m.default)(),n.ti=n.getToken(),n.node=d.default.createRef(),n}return(0,u.default)(t,e),(0,s.default)(t,[{key:"componentDidMount",value:function(){var e=this;(0,b.onShowedOnce)(this.node.current,function(){var t=e.props.parentType,n="".concat(y,"?at=view&pt=").concat(t,"&et=").concat(e.getET(),"&ti=").concat(e.ti,"&si=").concat(e.si,"&_dk=").concat(Date.now()*Math.random());try{(0,b.track)(n),(0,p.zaTrack)("cardShow",e.node.current,{id:5642})}catch(e){console.error(e.message)}})}},{key:"render",value:function(){var e=this.props.data,t=!!e.price;return d.default.createElement("div",{className:"".concat(C,"-container")},d.default.createElement("div",{className:C,style:{height:"81px"},ref:this.node,onClick:this.onClick},d.default.createElement("div",{className:"".concat(C,"-img"),style:{height:"81px",backgroundImage:"url(".concat(e.picUrl,")")}}),d.default.createElement("div",{className:"".concat(C,"-main"),style:{padding:t?"8px 10px":"10px"}},d.default.createElement("div",{className:"".concat(C,"-main-content")},d.default.createElement("header",{className:"".concat(C,"-main-content-title"),style:{fontSize:"12px",lineHeight:t?"13px":"18px"}},d.default.createElement("img",{alt:"",className:"".concat(C,"-main-content-title-logo"),src:e.logo,align:"middle"}),e.productName," 的商品推荐"),d.default.createElement("div",{className:"".concat(C,"-main-content-des"),style:{marginTop:t?"3.5px":"7px",lineHeight:t?"16px":"18px",height:t?"32px":"36px",fontSize:t?"12px":"13px"}},e.description),t?d.default.createElement("div",{className:"".concat(C,"-main-content-price")},"¥",e.price/100):null)),d.default.createElement("div",{className:"".concat(C,"-icon")},(!e.interactionLaunch||"去购买"===e.interactionLaunch)&&d.default.createElement(f.Cart,{style:{width:"14px",height:"12px",marginRight:"4px",verticalAlign:"-1px"}}),e.interactionLaunch||"去购买")))}}]),t}(d.default.PureComponent))||o;t.default=O},1924:function(e,t,n){var a,o,r=n(1828),i=n(1829),s=0,c=0;e.exports=function(e,t,n){var l=t&&n||0,u=t||[],d=(e=e||{}).node||a,m=void 0!==e.clockseq?e.clockseq:o;if(null==d||null==m){var p=r();null==d&&(d=a=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==m&&(m=o=16383&(p[6]<<8|p[7]))}var h=void 0!==e.msecs?e.msecs:(new Date).getTime(),f=void 0!==e.nsecs?e.nsecs:c+1,b=h-s+(f-c)/1e4;if(b<0&&void 0===e.clockseq&&(m=m+1&16383),(b<0||h>s)&&void 0===e.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=h,c=f,o=m;var v=(1e4*(268435455&(h+=122192928e5))+f)%4294967296;u[l++]=v>>>24&255,u[l++]=v>>>16&255,u[l++]=v>>>8&255,u[l++]=255&v;var g=h/4294967296*1e4&268435455;u[l++]=g>>>8&255,u[l++]=255&g,u[l++]=g>>>24&15|16,u[l++]=g>>>16&255,u[l++]=m>>>8|128,u[l++]=255&m;for(var y=0;y<6;++y)u[l+y]=d[y];return t||i(u)}},1925:function(e,t,n){var a=n(1828),o=n(1829);e.exports=function(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||a)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var s=0;s<16;++s)t[r+s]=i[s];return t||o(i)}},1926:function(e,t,n){},1927:function(e,t,n){},1935:function(e,t,n){"use strict";var a=n(4),o=n(5),r=n(8),i=n(6),s=n(7),c=n(0),l=n(2),u=n.n(l),d=n(1),m=n(61),p=n.n(m),h=n(30),f=n(31),b=n(16),v=n(518),g=function(e){function t(){var e,n;Object(a.a)(this,t);for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return(n=Object(r.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(s)))).handleViewed=function(){var e=n.props.extra;setTimeout(function(){b.default.trackCardShow(Object(h.default)(n),{},e)})},n.trackEvent=function(e,t,a){b.default.trackEvent(e,t,Object.assign({},n.props.extra,{},a))},n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.setModule()}},{key:"componentDidUpdate",value:function(){this.setModule()}},{key:"setModule",value:function(){var e=this.props,t=e.module,n=e.index,a=e.isAd,o=e.moduleName,r=e.content,i=e.list,s=e.card,c=e.attachedInfoBytes;if(t){var l=Object(f.findDOMNode)(this);l&&b.default.setModule(l,{module:t,index:n,is_ad:a,module_name:o},function(e,t,n,a){return e?{card:{content:e}}:Object.assign({},t&&{card:t},{},n&&{list:n},{},a&&{attached_info_bytes:a})}(r,s,i,c))}}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.trackCardShow,a=e.children,o="string"==typeof a.type?a:Object(d.cloneElement)(a,{trackEvent:this.trackEvent});return n?Object(c.b)(v.a,{id:t,onViewed:this.handleViewed},o):o}}]),t}(d.Component);g.propTypes={id:u.a.string,module:u.a.string,index:u.a.string,isAd:u.a.bool,content:u.a.object,extra:u.a.object,trackCardShow:u.a.bool,attachedInfoBytes:u.a.string},g.defaultProps={id:null,module:null,index:null,isAd:!1,content:null,extra:null,attachedInfoBytes:null,trackCardShow:!1};var y=g,C=n(196),O=n(116);n(1973);n.d(t,"a",function(){return w});var j={zhihu:"注册或登录",wechat:"使用微信快速登录",weibo:"使用微博快速登录",qq:"使用 QQ 快速登录"},k={qq:"qqconn",weibo:"sina",wechat:"wechat_mp"},w=function(e){function t(){var e,n;Object(a.a)(this,t);for(var o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return(n=Object(r.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(s)))).jumpToOAuthUrl=function(e){var t=n.props.redirectUrl,a=void 0===t?location.href:t,o=Object(O.c)(a),r=o.utm_source,i=o.utm_medium,s=p()(navigator.userAgent).isZhihu;location.href="zhihu"!==e?"https://www.zhihu.com/oauth/redirect/login/".concat(k[e],"?next=/oauth/account_callback&from=").concat(encodeURIComponent(a),"&utm_source=").concat(r,"&ref_source=").concat(i):s?"zhihu://signin?next=".concat(a):"https://www.zhihu.com/signin?next=".concat(a).concat(r?"?utm_source=".concat(r):"")},n.renderSignButtons=function(){var e=n.props.buttons;return"string"==typeof e?n.renderSingleSignButton({name:e}):e.map(function(e){return"string"==typeof e?n.renderSingleSignButton({name:e}):"object"==typeof e?n.renderSingleSignButton(e):null})},n.renderSingleSignButton=function(e){var t=e.name,a=e.text,o=e.fill,r=e.color,i="#fff"===o||"#ffffff"===o;return-1===Object.keys(j).indexOf(t)?null:Object(c.b)("button",{className:"SignInModal-button-".concat(t),key:t,style:{backgroundColor:o,borderColor:i?"#0f88eb":o,color:i?"#0f88eb":r},onClick:function(){n.jumpToOAuthUrl(t)}},a||j[t])},n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.onClose,n=e.urlScheme,a=this.props.title||"".concat(n?"打开 App 或":"","登录后继续操作");return Object(c.b)(C.b,{size:"small",className:"SignInModal",title:a,onClose:t},Object(c.b)(y,{module:"SignForm",moduleName:a,trackCardShow:!0},Object(c.b)("div",{className:"SignInModal-content"},n&&Object(c.b)(O.a,{className:"SignInModal-openInAppButton",href:n},"立即打开 App"),this.renderSignButtons())))}}]),t}(d.Component);w.propTypes={onClose:u.a.func.isRequired,urlScheme:u.a.string,redirectUrl:u.a.string,buttons:u.a.oneOfType([u.a.array,u.a.string])},w.defaultProps={buttons:["zhihu"]}},1955:function(e,t,n){"use strict";var a,o,r,i=n(22),s=n(481),c=n(9),l=n(4),u=n(5),d=n(8),m=n(6),p=n(30),h=n(7),f=n(0),b=n(1),v=n.n(b),g=n(2),y=n.n(g),C=n(31),O=n(26),j=n(18),k=n(11),w=n.n(k),N=n(16),S=n(821),I=n.n(S),P=n(35),R=n.n(P),E=n(15),x=n(492),A=n(168),T=n(496),L=n(115),M=n(273),_=n(503),D=n(1755),F=n(818),B=n(152),z=n(23),V=n(21),U="zhihu::comment_local_key",q=5,W=(V.I,1e3),H=980,K=function(){return""},G={error:"上传失败",success:"上传成功",uploadIng:"上传中",default:""},Q=(n(1979),Object(j.connect)(null,{showNotification:z.h,uploadImage:B.b})((r=o=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).state={uploadStatus:G.default},n.triggerClick=function(e){var t=n.props.handleInputActive;n.uploadInput.click(),t(!0),e.preventDefault()},n.onError=function(){var e=n.props,t=e.showNotification,a=e.resetUploadImg;t("图片上传失败","red"),a()},n.onSuccess=function(){n.setState({uploadStatus:G.default})},n.resetFileInput=function(){n.uploadInput.value=null},n.beforeUpload=function(e){var t=n.props.showNotification;return e?e.size>1024*V.I*1024?(t("请上传小于 ".concat(V.I,"M 的图片。"),"red"),n.resetFileInput(),!1):(n.reactPopoverNode.open(),void n.setState({uploadStatus:G.uploadIng})):(n.resetFileInput(),!1)},n.uploadImage=function(e){var t=e.file,a=n.props,o=a.uploadImage,r=a.handleImages,i=a.updatePublishStatus;return o(t).then(function(e){r([Object.assign({},e.payload,{url:e.payload.src})]),i(!1),n.resetFileInput()}).catch(function(){n.setState({uploadStatus:G.error}),r([])})},n.handleOnRef=function(e){var t=n.props.onRef;t&&t(e),n.reactPopoverNode=e},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.images,a=t.disableButton,o=t.resetUploadImg,r=this.state.uploadStatus,i=Boolean(n.length);return Object(f.b)(b.Fragment,null,Object(f.b)(L.a,{className:"ImagePopover",arrowed:!0,ref:this.handleOnRef,placement:"bottom",globalClose:!n.length,onClick:this.triggerClick,toggler:Object(f.b)(M.a,{label:"插入图片",icon:D.a,disabled:a})},Object(f.b)("div",{className:"ImagePopover-thumbnail"},i&&Object(f.b)(b.Fragment,null,Object(f.b)("img",{src:n[0].src}),Object(f.b)("div",{className:"closeButton",onClick:o},Object(f.b)(F.a,null))),r&&!i&&Object(f.b)("p",{className:"ImagePopover-uplodaStatus"},r))),Object(f.b)(_.a,{accept:"image/png,image/jpeg",onRef:function(t){e.uploadInput=t},beforeUpload:this.beforeUpload,customUpload:this.uploadImage,onSuccess:this.onSuccess,onError:this.onError}))}}]),t}(b.Component),o.propTypes={className:y.a.string,disableButton:y.a.bool},o.defaultProps={disableButton:!0},a=r))||a),Y=n(54),$=n(1756),J=n(10),Z=function(e){return v.a.createElement(J.a,e,v.a.createElement("path",{d:"M16.375 3.018C19.701 4.643 22 8.047 22 12a9.944 9.944 0 0 1-1.349 5c-1.73 2.986-4.952 5-8.651 5-3.7 0-6.921-2.014-8.651-5A9.944 9.944 0 0 1 2 12c0-3.951 2.298-7.357 5.625-8.982A9.95 9.95 0 0 1 12 2c1.571 0 3.051.373 4.375 1.018zm-4.322 11.17c1.5 0 2.911.662 3.871 1.817a.6.6 0 0 1-.514.978.599.599 0 0 1-.406-.214 3.823 3.823 0 0 0-2.951-1.385c-.605 0-1.185.136-1.723.407a3.85 3.85 0 0 0-1.321 1.093c-.039.05-.091.081-.141.116H8.19c-.006-.004-.013-.003-.018-.006a.6.6 0 0 1-.11-.839 5.074 5.074 0 0 1 1.73-1.433 4.988 4.988 0 0 1 2.26-.534zM8.875 10.75a1.25 1.25 0 1 1 0-2.5 1.25 1.25 0 0 1 0 2.5zm6.25-2.5a1.25 1.25 0 1 1-.001 2.5 1.25 1.25 0 0 1 0-2.5zM19.17 17a8.695 8.695 0 0 0 1.58-5c0-3.23-1.764-6.05-4.375-7.566A8.698 8.698 0 0 0 12 3.25a8.69 8.69 0 0 0-4.375 1.184C5.014 5.95 3.25 8.77 3.25 12c0 1.859.586 3.581 1.579 5 1.583 2.264 4.205 3.75 7.171 3.75 2.965 0 5.586-1.486 7.17-3.75z",fillRule:"evenodd"}))};Z.defaultProps={name:"Sad"};var X=Z,ee=(n(1980),function(e){function t(e){var n;Object(l.a)(this,t),(n=Object(d.a)(this,Object(m.a)(t).call(this,e))).state={isGifReady:!1,isGifError:!1},n.renderLoadStatus=function(){var e=n.state.isGifError;return Object(f.b)("div",{className:"CommentSticker-load"},e?Object(f.b)(v.a.Fragment,null,Object(f.b)(X,{className:"CommentSticker-load-Icons"}),"加载失败"):Object(f.b)(v.a.Fragment,null,Object(f.b)($.a,{className:"CommentSticker-load-Icons"}),"加载中"))};var a=n.props.src;return Object(Y.loadImage)(Object(Y.imgUrl)(a)).then(function(){n.setState({isGifReady:!0})}).catch(function(){n.setState({isGifError:!0})}),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state.isGifReady,t=this.props,n=t.src,a=t.handleStickerClick;return Object(f.b)("div",{className:"CommentSticker"},e?Object(f.b)("img",{src:n,className:"CommentSticker-img",onClick:a}):this.renderLoadStatus())}}]),t}(v.a.Component));ee.propsTypes={handleStickerClick:y.a.func};var te=ee,ne=(n(1981),function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).handleOnRef=function(e){var t=n.props.onRef;t&&t(e)},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.className,n=e.sticker,a=e.stickers,o=e.disableButton,r=e.handleStickerPopoverOpen,i=e.handleStickerPopoverClose,s=e.resetStickers,c=e.addSticker,l=e.handleEmotionClick;return Object(f.b)(L.a,{className:t,arrowed:!0,ref:this.handleOnRef,globalClose:!n.length,preventCloseOnTarget:!0,onClick:l,onOpen:r,onClose:i,toggler:Object(f.b)(M.a,{label:"插入表情",icon:$.a,disabled:o}),placement:"bottom"},Boolean(n.length)&&Object(f.b)("li",{className:"StickerPopover-stickers-item StickerPopover-stickers-item-single"},Object(f.b)("img",{src:Object(Y.imgUrl)(n[0].url),alt:n[0].title}),Object(f.b)("div",{className:"closeButton",onClick:s},Object(f.b)(F.a,null))),!n.length&&Object(f.b)("div",{className:"StickerPopover-stickers-wrap"},Object(f.b)("ul",{className:"StickerPopover-stickers-list"},a.map(function(e){var t=e.url,n=e.title,a=e.id;return Object(f.b)("li",{className:"StickerPopover-stickers-item",key:a},Object(f.b)(te,{width:48,height:48,src:t,handleStickerClick:function(){return c(e)}}),Object(f.b)("p",null,n))}))))}}]),t}(b.Component));ne.propTypes={className:y.a.string,disableButton:y.a.bool},ne.defaultProps={disableButton:!0};var ae,oe,re,ie;n(1982);function se(){var e=Object(s.a)(["回复","",""]);return se=function(){return e},e}n.d(t,"a",function(){return ce});var ce=(ae=Object(j.connect)(function(e){return{stickers:e.commentsV2.stickers||[],commentWithPicPermission:e.commentsV2.commentWithPicPermission||{}}},{showNotification:z.h}),Object(O.withRouter)(oe=ae((ie=re=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).state={active:!1,disabled:!0,shown:!1,value:{toHTML:K},images:[],uploadIsFetchingNum:0,sticker:[],stickerIconActive:!1,toggleInputStyle:!1,commentTextLength:0},n.handleSubmit=n.context.authRequired(function(){var e=n.props,t=e.replyTo,a=e.onSubmit,o=e.onCancel,r=e.rootCommentId,i=e.isConversation,s=e.zaInfo.zaSubmitCommentId,c=n.state,l=c.images,u=c.sticker,d=n.input.toHTML();if(d||l.length||u.length){d&&n.saveLocalComment();var m=d;if(l.length||u.length){var h=l[0]||u[0],f=l[0]?l[0].url.includes(".gif")?"comment_gif":"comment_img":"comment_sticker";m+='<a class="'.concat(f,"\" href='").concat(h.url,"' data-width='").concat(h.dataRawwidth||"","' data-height='").concat(h.dataRawheight||"","'>[").concat(h.title||"图片","]</a>")}var b=a(m,t,{rootCommentId:r,isConversation:i});b.then?b.then(function(){o&&o(),n.input?(n.input.reset(),n.resetImage(),n.setState({value:{toHTML:K}},function(){return n.saveLocalComment()})):n.saveLocalComment({toHTML:K})}):(o&&o(),n.input.reset()),N.default.trackEvent(Object(p.default)(n),Object.assign({action:"Comment",element:"Button"},s&&{id:s}))}},void 0,z.b),n.handleCommentShow=n.context.authRequired(function(){n.setState({shown:!0}),n.hiddenInput.focus()}),n.handleCommentHide=function(){n.setState({shown:!1})},n.initLocalComment=function(){var e=n.props,t=e.type,a=e.id;if(t&&a){var o=R.a.get(U)||[],r="".concat(t,"_").concat(a),i=o.find(function(e){return e.key===r}),s=i&&i.value;s&&n.setState({value:{toHTML:function(){return s}},disabled:!1})}},n.saveLocalComment=function(e){var t=n.props,a=t.type,o=t.id;if(a&&o){var r=e?e.toHTML():n.state.value.toHTML(),i="".concat(a,"_").concat(o),s=(R.a.get(U)||[]).filter(function(e){return e.key!==i}),l=r?[].concat(Object(c.a)(s.slice(0,q-1)),[{key:i,value:r}]):s;R.a.set(U,l)}},n.handleChange=function(e){var t=n.state,a=t.sticker,o=t.images;a.length||o.length?n.setState({value:e}):n.setState({value:e,disabled:e.isEmpty}),n.handleInputChange()},n.handleFocus=function(){n.setState({active:!0},n.handleInputChange)},n.handleBlur=function(){var e=n.state,t=e.sticker,a=e.images;t.length||a.length||(n.setState({active:!1}),n.handleInputChange())},n.handleMobileComment=function(){n.handleSubmit(),n.handleCommentHide()},n.handleEmotionClick=function(){var e=n.state.stickerIconActive;e&&n.setState({stickerIconActive:e},n.stickerPopover.close)},n.handleInputChange=function(){var e,t=Object(C.findDOMNode)(n.input);t&&(t.getBoundingClientRect().height>40?n.setState({toggleInputStyle:!0}):n.setState({toggleInputStyle:!1}),e="innerText"in document?t.innerText.length:t.textContent.length,n.setState({commentTextLength:e}),n.imgUploadPopover&&n.imgUploadPopover.position(),n.stickerPopover&&n.stickerPopover.position())},n.handleStickerPopoverOpen=function(){n.setState({active:!0,stickerIconActive:!0},n.stickerPopover.position),setTimeout(n.stickerPopover.position,400)},n.handleStickerPopoverClose=function(){n.setState({stickerIconActive:!1})},n.handleImages=function(e){n.setState({images:e},n.imgUploadPopover.position)},n.handleInputActive=function(e){n.setState({active:e})},n.updatePublishStatus=function(e){n.setState({disabled:e})},n.resetStickers=function(){var e=n.state.value,t=void 0===e.isEmpty||e.isEmpty;n.stickerPopover&&n.stickerPopover.close(),n.setState({sticker:[],disabled:t})},n.resetImage=function(){n.resetStickers(),n.resetUploadImg()},n.resetUploadImg=function(){var e=n.state.value,t=void 0===e.isEmpty||e.isEmpty;n.imgUploadPopover&&n.imgUploadPopover.close(),n.setState({images:[],disabled:t})},n.addSticker=function(e){n.setState({sticker:[e],disabled:!1},n.stickerPopover.position)},n.focusInput=function(e){e.preventDefault(),n.input.focus()},n.createImageOnRef=function(e){n.imgUploadPopover=e},n.createStickerOnRef=function(e){n.stickerPopover=e},n.renderInput=function(e){var t=e.placeholder,a=e.className,o=n.props,r=o.autoFocus,i=o.stickers,s=o.commentWithPicPermission.commentWithPic,c=n.state,l=c.images,u=c.sticker,d=c.stickerIconActive,m=c.toggleInputStyle,p=c.active,h=c.disabled,b=c.commentTextLength,v=Boolean(u.length)||Boolean(l.length);return Object(f.b)("div",{className:w()("CommentEditorV2-inputWrap",{"CommentEditorV2-inputWrap--change":m,"CommentEditorV2-inputWrap--active":p||!h}),onClick:function(e){e.nativeEvent.stopImmediatePropagation()}},Object(f.b)(A.c,{keyMap:{FOCUS_COMMENT_INPUT:"shift+c"},handlers:{FOCUS_COMMENT_INPUT:n.focusInput}}),Object(f.b)(T.a,{className:w()("CommentEditorV2-input",a),defaultValue:n.state.value.toHTML(),richtext:!0,large:!0,spread:!0,allowMention:!0,allowPasteRichText:!1,autoFocus:r,outputBlockType:"div",onRef:function(e){n.input=e},placeholder:t,onFocus:n.handleFocus,onChange:n.handleChange,onSubmit:n.handleSubmit,minRows:5}),Object(f.b)("div",{className:w()("CommentEditorV2-inputUpload",{"CommentEditorV2-inputUpload--FlexEnd":m,"CommentEditorV2-inputUpload--SpaceBetween":m&&b>H})},m&&b>H&&Object(f.b)(x.a,{className:"CommentEditorV2-MaxLength",current:b,max:W}),Object(f.b)("div",{className:"CommentEditorV2-popoverWrap"},s&&Object(f.b)(Q,{onRef:n.createImageOnRef,images:l,disableButton:v,resetUploadImg:n.resetUploadImg,handleInputActive:n.handleInputActive,updatePublishStatus:n.updatePublishStatus,handleImages:n.handleImages}),Object(f.b)(ne,{className:w()("CommentEditorV2-inputUpLoad-Icon",{"CommentEditorV2-inputUpLoad-Icon--active":d&&!u.length}),onRef:n.createStickerOnRef,disableButton:v,handleEmotionClick:n.handleEmotionClick,handleStickerPopoverOpen:n.handleStickerPopoverOpen,handleStickerPopoverClose:n.handleStickerPopoverClose,stickerIconActive:d,sticker:u,stickers:i,resetStickers:n.resetStickers,addSticker:n.addSticker}))))},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.initLocalComment(),document.addEventListener("click",this.handleBlur)}},{key:"componentWillUnmount",value:function(){this.saveLocalComment(),document.removeEventListener("click",this.handleBlur)}},{key:"render",value:function(){var e=this.props,t=e.replyTo,n=e.commentNeedsReview,a=e.className,o=e.ownerAuthorIsOrg,r=e.ownerAuthorIsBrand,s=this.state,c=s.active,l=s.disabled,u=o?"机构":"作者",d={preset:"primary",color:"blue",children:"发布",disabled:l};if(t&&t.author){var m=I()(se(),t.author.member.name,n?"，评论由".concat(u,"筛选后公开"):"");return Object(f.b)("div",{className:w()(a,"CommentEditorV2--normal",{"CommentEditorV2--active":c||!l})},this.renderInput({placeholder:m}),Object(f.b)(E.c,Object(i.default)({},d,{className:"CommentEditorV2-singleButton",onClick:this.handleSubmit})))}var p="写下你的评论...";return n&&(p=r?"已开启预审评论，评论由品牌筛选后公开":o?"已开启预审评论，评论由机构筛选后公开":"评论由作者筛选后显示"),Object(f.b)("div",{className:w()(a,"CommentEditorV2--normal",{"CommentEditorV2--active":c||!l})},this.renderInput({placeholder:p}),Object(f.b)(E.c,Object(i.default)({},d,{className:"CommentEditorV2-singleButton",onClick:this.handleSubmit})))}}]),t}(b.Component),re.propTypes={className:y.a.string,defaultActive:y.a.bool,replyTo:y.a.object,inCommentItem:y.a.bool,commentNeedsReview:y.a.bool,canComment:y.a.object,onCancel:y.a.func,onSubmit:y.a.func.isRequired,zaInfo:y.a.object},re.defaultProps={defaultActive:!1,replyTo:null,inCommentItem:!1,autoFocus:!0,ownerAuthorIsOrg:!1,ownerAuthorIsBrand:!1,zaInfo:{}},re.contextTypes={authRequired:y.a.func},oe=ie))||oe)||oe)},1958:function(e,t,n){"use strict";var a,o,r,i,s=n(22),c=n(4),l=n(5),u=n(8),d=n(6),m=n(7),p=n(0),h=n(1),f=n.n(h),b=n(2),v=n.n(b),g=n(18),y=n(26),C=n(11),O=n.n(C),j=n(151),k=n(15),w=n(2193),N=n(1754),S=n(1757),I=n(2226),P=n(2227),R=n(2194),E=n(2228),x=n(2229),A=n(2230),T=n(23),L=n(74),M=n(517),_=n(117),D=n(1846),F=n(200),B=n(103),z=n(1955),V=n(9),U=n(31),q=n(484),W=n(54),H=n(1809),K=(n(1983),function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).state={previewImg:null},n.handlePreview=function(e){var t=e.target,a=n.props.onPreviewImage;"function"==typeof a?a(e).catch(function(){n.setState({previewImg:t})}):n.setState({previewImg:t})},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"mount",value:function(){var e=this;this.imagesGifNode=this.root.getElementsByClassName("comment_gif"),this.imagesNode=this.root.getElementsByClassName("comment_img"),this.imagesStickerNode=this.root.getElementsByClassName("comment_sticker"),this.imgNode=this.root.getElementsByClassName("origin_image zh-lightbox-thumb"),this.imagesNodes=Array.from([].concat(Object(V.a)(this.imagesGifNode),Object(V.a)(this.imagesNode),Object(V.a)(this.imagesStickerNode),Object(V.a)(this.imgNode))).map(function(t){var n=t.dataset||{},a=n.width,o=n.height,r=n.rawwidth,i=n.rawheight,s=Number(a||r),c=Number(o||i),l=document.createElement("div");l.className="Richtext-content_img",t.parentNode.replaceChild(l,t);var u=t.getAttribute("href")||t.getAttribute("src"),d=new Image,m=t.getAttribute("class");return"comment_sticker"!==m&&l.addEventListener("click",e.handlePreview),d.className=m,d.src=u,d.dataset.original=Object(W.imgUrl)(u,"r"),d.dataset.rawwidth=s,d.onload=function(){s===c||"comment_sticker"===m?l.classList.add("Richtext-content_img-square"):s>c?l.classList.add("Richtext-content_img-square--wideShape"):l.classList.add("Richtext-content_img-square--highShape"),l.appendChild(d)},l})}},{key:"unmount",value:function(){this.imagesNodes&&this.imagesNodes.forEach(function(e){Object(U.unmountComponentAtNode)(e)})}},{key:"componentDidMount",value:function(){this.mount()}},{key:"componentWillUpdate",value:function(e){this.props.html!==e.html&&this.unmount()}},{key:"componentDidUpdate",value:function(e){e.html!==this.props.html&&this.mount()}},{key:"componentWillUnmount",value:function(){this.unmount()}},{key:"render",value:function(){var e=this,t=this.state.previewImg,n=this.props,a=n.html,o=n.className;return Object(p.b)("div",{className:O()("CommentRichText",o),ref:function(t){return e.root=t}},Object(p.b)(H.a,{html:a}),t&&Object(p.b)(q.a,{className:"CommentRichText-ImageView",img:t,onClose:function(){return e.setState({previewImg:null})}}))}}]),t}(h.Component)),G=n(21);n(1984);n.d(t,"a",function(){return Q});var Q=(a=Object(g.connect)(function(e){return{isWechat:e.env.userAgent.Wechat,permission:Object(L.R)(e)}}),Object(y.withRouter)(o=a((i=r=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).state={reportModalShown:!1,isReplying:!1,guideShown:!1,deleteModal:!1},n.toggleReply=n.context.authRequired(function(){n.setState({isReplying:!n.state.isReplying})},void 0,T.b),n.openReportModal=n.context.authRequired(function(){n.setState({reportModalShown:!0})}),n.like=n.context.authRequired(function(e){var t=n.props;(0,t.onLike)(t.comment.id,e)},G.N.like,T.b),n.dislike=n.context.authRequired(function(){var e=n.props;(0,e.onDislike)(e.comment.id)},G.N.like,T.b),n.delete=function(){var e=n.props;return(0,e.onDelete)(e.comment.id)},n.feature=function(e){var t=n.props,a=t.onFeature,o=t.comment.id;a(e?"".concat(o,"_featured"):o)},n.collapse=function(){var e=n.props;(0,e.onCollapse)(e.comment.id)},n.approve=function(){var e=n.props;(0,e.onApprove)(e.comment.id)},n.reject=function(){var e=n.props;(0,e.onReject)(e.comment.id)},n.showConversation=function(e){var t=n.props;(0,t.onShowConversation)({commentId:t.comment.id,isAnchorComments:e})},n.stopReply=function(){n.setState({isReplying:!1})},n.closeReportModal=function(e){if(e){var t=e.result.payload,a=t&&t.message||t&&t.code&&"举报失败";e.commentDeleteResult&&!(e.commentDeleteResult.payload||{}).code?D.b.showModal({reportText:a}):Object(_.b)(a||"举报成功")}n.setState({reportModalShown:!1})},n.handleToggleGuide=function(){n.setState({guideShown:!n.state.guideShown})},n.handleCloseDelete=function(){return n.setState({deleteModal:!1})},n.handleDelete=function(){return n.setState({deleteModal:!0})},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"renderRoleInfo",value:function(e,t){return"normal"===e?null:Object(p.b)("span",{className:"CommentItemV2-roleInfo"},"ancestor"===e||"author"===e&&"question"===t?" (提问者) ":" (作者) ")}},{key:"renderReplyTo",value:function(){var e=this.props.comment,t=e.replyToAuthor,n=e.resourceType;if(!t)return null;var a=t.member,o=void 0===a?{}:a,r=t.role;return Object(p.b)(f.a.Fragment,null,Object(p.b)("span",{className:"CommentItemV2-reply"},"回复"),Object(p.b)(B.a,{noBadge:!0,noHoverCard:!0,user:o}),this.renderRoleInfo(r,n))}},{key:"renderItem",value:function(){var e,t=this,n=this.props,a=n.isConversation,o=n.ownerAuthorIsOrg,r=n.parent,i=r.canComment,c=(i=void 0===i?{status:!0}:i).status,l=r.questionType,u=n.commentNeedsReview,d=n.comment,m=n.onReply,h=n.status,b=n.type,v=n.canOperate,g=n.commentPattern,y=n.rootCommentId,C=n.byComment,T=n.isReverseAndStatusOpen,L=n.hasRecommend,_=n.permission.canBrandAdminEdit,V=n.showCollapsed,U=this.state,q=U.reportModalShown,W=U.isReplying,H=d.id,G=d.author,Q=d.content,Y=d.voteCount,$=d.replyToAuthor,J=d.isAuthor,Z=d.createdTime,X=d.featured,ee=d.voting,te=d.reviewing,ne=d.disliked,ae=d.resourceType,oe=d.childCommentCount,re=d.allowDelete,ie=d.allowVote,se=d.canRecommend,ce=d.canCollapse,le=d.collapsedReason,ue=void 0===le?"":le,de=d.isDelete,me=d.collapsed,pe=me&&!V,he=pe?"该评论已被折叠":Q,fe=de||pe,be=G||{},ve=be.member,ge=be.role,ye=Boolean($),Ce=X&&(oe>0||ye)&&!a||C&&ye||T&&ye,Oe=J||re&&("question"!==b||"commercial"===l),je=Object(p.b)("div",{className:"CommentItemV2-footer"},Object(p.b)(k.c,{className:O()("CommentItemV2-likeBtn",ee&&"is-liked"),preset:"plain",onClick:this.like,disabled:J},Object(p.b)(w.a,{style:{marginRight:5},center:!0,size:16}),Y>0?Y:"赞"),me&&ue&&Object(p.b)("div",{className:"CommentItemV2-walleTag"},"阴阳怪气自动折叠"===ue&&Object(p.b)(N.a,{size:16,className:"CommentItemV2-walleIcon"}),ue),Ce&&Object(p.b)(k.c,{preset:"plain",className:"CommentItemV2-talkBtn",onClick:function(){return t.showConversation(ye)}},Object(p.b)(S.a,{style:{marginRight:5},center:!0,size:16}),"查看回复"),!J&&c&&!me&&Object(p.b)(k.c,{preset:"plain",className:O()({"CommentItemV2-hoverBtn":!W}),onClick:this.toggleReply},Object(p.b)(I.a,{style:{marginRight:5},center:!0,size:16}),W?"取消回复":"回复"),se&&!L&&v&&Object(p.b)(k.c,{className:O()({"CommentItemV2-hoverBtn":!J&&!W}),preset:"plain",onClick:function(){return t.feature(X)}},Object(p.b)(P.a,{style:{marginRight:5},center:!0,size:16}),X?"取消推荐":"推荐"),ce&&!J&&Object(p.b)(k.c,{className:O()({"CommentItemV2-hoverBtn":!J&&!W}),preset:"plain",onClick:this.collapse},Object(p.b)(R.a,{style:{marginRight:5},center:!0,size:14}),me?"取消折叠":"折叠"),ie&&!J&&v&&Object(p.b)(k.c,{className:O()({"CommentItemV2-hoverBtn":!W}),preset:"plain",onClick:this.dislike},Object(p.b)(w.a,{style:{transform:"rotate(180deg)",marginRight:5},size:16,center:!0}),ne?"取消踩":"踩"),J||Object(p.b)(f.a.Fragment,null,Object(p.b)(k.c,{className:"CommentItemV2-hoverBtn",preset:"plain",onClick:this.openReportModal},Object(p.b)(E.a,{style:{marginRight:5},center:!0,size:16}),"举报"),"question"===b&&"commercial"===l&&_&&Object(p.b)(k.c,{className:"CommentItemV2-hoverBtn",preset:"plain",onClick:this.reject},Object(p.b)(R.a,{style:{marginRight:5},center:!0,size:16}),"隐藏")),Oe&&Object(p.b)(k.c,{className:O()({"CommentItemV2-hoverBtn":!J&&!W&&!W}),preset:"plain",onClick:this.handleDelete},Object(p.b)(x.a,{style:{marginRight:5},center:!0,size:16}),"删除"),Object(p.b)(D.a,{shown:this.state.deleteModal,id:H,onDelete:this.delete,onClose:this.handleCloseDelete}),Object(p.b)(F.a,Object(s.default)({type:"comment",urlToken:H,shown:q,onClose:this.closeReportModal},Oe&&{onDeleteComment:this.delete},{notification:{failure:M.a},zaEnabled:!0})));return e=W?Object(p.b)("div",null,je,Object(p.b)(z.a,{type:"comment",id:H,commentNeedsReview:u,className:"CommentItemV2-editor",defaultActive:!0,replyTo:d,onCancel:this.stopReply,onSubmit:m,rootCommentId:y,isConversation:a})):"reviewing"===h?Object(p.b)("div",{className:"CommentItemV2-footer"},Object(p.b)(k.c,{preset:"plain",onClick:this.approve},Object(p.b)(A.a,{style:{marginRight:5},center:!0,size:14}),"公开"),Object(p.b)(k.c,{className:"CommentItemV2-hoverBtn",preset:"plain",onClick:this.handleDelete},Object(p.b)(x.a,{style:{marginRight:5},center:!0,size:16}),"删除"),Object(p.b)(D.a,{shown:this.state.deleteModal,id:H,onDelete:this.delete,onClose:this.handleCloseDelete})):je,Object(p.b)("div",null,Object(p.b)("div",{className:"CommentItemV2-meta"},ve&&Object(p.b)(B.a,{className:"CommentItemV2-avatar",avatar:!0,noHoverCard:"fixed"===g,user:ve}),ve&&Object(p.b)(B.a,{noBadge:!0,noHoverCard:!0,user:ve}),this.renderRoleInfo(ge,ae),this.renderReplyTo(),te&&Object(p.b)(R.a,{className:"CommentItemV2-reviewing","data-tooltip":"".concat(!1===o?"评论未公开，由作者筛选后显示":"已开启预审评论，评论由机构筛选后公开"),center:!0,size:14}),Object(p.b)("span",{className:"CommentItemV2-time"},Object(j.toRelativeString)(Z))),Object(p.b)("div",{className:"CommentItemV2-metaSibling"},Object(p.b)(K,{className:O()("CommentItemV2-content",{"CommentItemV2-shield":fe}),html:he}),!fe&&e))}},{key:"render",value:function(){return this.renderItem()&&Object(p.b)("div",{className:"CommentItemV2",ref:this.props.onRef},this.renderItem())}}]),t}(h.Component),r.propTypes={comment:v.a.object.isRequired,parent:v.a.object.isRequired,commentNeedsReview:v.a.bool,type:v.a.string,isConversation:v.a.bool,onLike:v.a.func.isRequired,onShowConversation:v.a.func,onReply:v.a.func,onFeature:v.a.func,onDelete:v.a.func.isRequired,onCollapse:v.a.func,commentPattern:v.a.string,showCollapsed:v.a.bool},r.contextTypes={currentUser:v.a.object,authRequired:v.a.func},o=i))||o)||o)},1973:function(e,t,n){},1974:function(e,t,n){},1975:function(e,t,n){e.exports=n.p+"assets/deleteComment.97d8abc0.gif"},1976:function(e,t,n){},1979:function(e,t,n){},1980:function(e,t,n){},1981:function(e,t,n){},1982:function(e,t,n){},1983:function(e,t,n){},1984:function(e,t,n){},2112:function(e,t,n){"use strict";var a=n(1),o=n.n(a),r=n(10),i=function(e){return o.a.createElement(r.a,e,o.a.createElement("path",{d:"M18.453 7.992l-1.833-1.65.964-.978a1.223 1.223 0 0 1 1.73-.012l.005.006a1.24 1.24 0 0 1 .007 1.748l-.873.886zm-1.178 1.194l-5.578 5.66-1.935.697a.393.393 0 0 1-.504-.504l.697-1.935 5.488-5.567 1.832 1.65zM7.58 5.848l5.654.006-1.539 1.991-3.666.012A1.02 1.02 0 0 0 7 8.868v7.993c0 .558.46 1.01 1.029 1.01l7.941-.01c.568 0 1.03-.453 1.03-1.012v-4.061l2-1.442v6.002c0 1.397-1.2 2.501-2.62 2.501H7.574C6.153 19.85 5 18.717 5 17.32V8.35c0-1.397 1.16-2.502 2.58-2.502z"}))};i.defaultProps={name:"EditSurround"},t.a=i},2113:function(e,t,n){"use strict";var a=n(1),o=n.n(a),r=n(10),i=function(e){return o.a.createElement(r.a,e,o.a.createElement("path",{d:"M6 3.956v16.088C6 21.124 6.517 22 7.9 22c.326 0 .533-.087.896-.236L22 13.784c.571-.355 1.143-.87 1.143-1.784S22.57 10.571 22 10.216L8.796 2.236C8.433 2.087 8.226 2 7.9 2 6.514 2 6 2.876 6 3.956z"}))};i.defaultProps={name:"Play"},t.a=i},2133:function(e,t,n){"use strict";var a=n(1),o=n.n(a),r=n(10),i=function(e){return o.a.createElement(r.a,e,o.a.createElement("path",{d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10zm0-3.681a1.17 1.17 0 0 1-.846-.344 1.143 1.143 0 0 1-.354-.856c0-.328.118-.61.354-.847.236-.235.518-.353.846-.353.328 0 .61.115.846.344.236.23.354.515.354.856 0 .342-.118.626-.354.856-.236.229-.518.344-.846.344zm2.761-7.398c-.228.232-.637.621-1.227 1.17-.163.154-.295.29-.393.407a1.643 1.643 0 0 0-.22.32 1.614 1.614 0 0 0-.111.293c-.026.097-.066.267-.119.512-.09.518-.377.777-.857.777a.86.86 0 0 1-.63-.254c-.17-.17-.255-.421-.255-.755 0-.419.062-.78.187-1.087.125-.307.29-.576.497-.808.206-.231.485-.506.835-.825.307-.28.53-.49.666-.632.137-.142.252-.3.346-.474.093-.175.14-.364.14-.568 0-.399-.143-.735-.428-1.01-.286-.273-.655-.41-1.106-.41-.528 0-.917.138-1.166.414-.25.277-.46.684-.634 1.222-.163.563-.472.845-.928.845a.896.896 0 0 1-.68-.295c-.185-.197-.278-.41-.278-.64 0-.473.147-.952.44-1.438.292-.486.72-.888 1.28-1.207C10.683 6.16 11.339 6 12.087 6c.696 0 1.31.133 1.844.4a3.02 3.02 0 0 1 1.234 1.087c.291.459.436.957.436 1.495 0 .423-.083.794-.248 1.113a3.413 3.413 0 0 1-.59.826z",fillRule:"evenodd"}))};i.defaultProps={name:"Help"},t.a=i},2175:function(e,t,n){"use strict";var a=n(1),o=n.n(a),r=n(10),i=function(e){return o.a.createElement(r.a,e,o.a.createElement("path",{d:"M10.229 17.516c-.318.327-.75.484-1.199.484-.453 0-.884-.16-1.202-.488l-4.335-4.47a1.77 1.77 0 0 1 .007-2.459 1.663 1.663 0 0 1 2.397.01l3.137 3.246 9.072-9.329a1.662 1.662 0 0 1 2.397 0c.663.681.663 1.786 0 2.466L10.23 17.516z",fillRule:"evenodd"}))};i.defaultProps={name:"Check"},t.a=i},2182:function(e,t,n){"use strict";var a=n(4),o=n(5),r=n(8),i=n(6),s=n(7),c=n(9),l=n(1),u=n.n(l),d=n(19),m=n.n(d),p=n(15),h=function(e){function t(){var e,n;Object(a.a)(this,t);for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return(n=Object(r.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(s)))).handleClick=function(){var e=n.props;(0,e.onSelect)(e.page)},n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.text,n=e.isCurrent,a=e.className;return u.a.createElement(p.c,{preset:p.b.Plain,className:m()("PaginationButton",{"PaginationButton--current":n},a),onClick:this.handleClick,disabled:n},t)}}]),t}(l.Component),f=(n(2210),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Array.from({length:t},function(t,n){return n+e})}),b=function(e){function t(){return Object(a.a)(this,t),Object(r.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e,t=this.props,n=t.onSelect,a=t.className,o=t.clickCallback,r=this.props.current,i=this.props.total,s=o&&(e=o,function(){e.apply(void 0,arguments)})||n,l=function(e,t){var n="...";return t<=5?f(1,t):e>t-3?[1,n].concat(Object(c.a)(f(t-3,3)),[t]):e<=3?[1].concat(Object(c.a)(f(2,3)),[n,t]):[1,n].concat(Object(c.a)(f(e-Math.floor(1.5),3)),[n,t])}(r,i);return u.a.createElement("div",{className:m()("Pagination",a)},r>1&&r<=i&&u.a.createElement(h,{className:"PaginationButton-prev",onSelect:s,text:"上一页",page:r-1}),l.map(function(e,t){return"number"==typeof e?u.a.createElement(h,{onSelect:s,text:e,page:e,key:t,isCurrent:r===e}):u.a.createElement("button",{disabled:!0,key:t,className:"PaginationButton PaginationButton--ellipsis"},e)}),r>0&&r<i&&u.a.createElement(h,{className:"PaginationButton-next",onSelect:s,text:"下一页",page:r+1}))}}]),t}(l.Component);b.defaultProps={current:1,total:1,onSelect:function(){}},n.d(t,"a",function(){return b})},2193:function(e,t,n){"use strict";var a=n(1),o=n.n(a),r=n(10),i=function(e){return o.a.createElement(r.a,e,o.a.createElement("path",{d:"M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z",fillRule:"evenodd"}))};i.defaultProps={name:"Like"},t.a=i},2194:function(e,t,n){"use strict";var a=n(1),o=n.n(a),r=n(10),i=function(e){return o.a.createElement(r.a,e,o.a.createElement("path",{d:"M17.007 11.504c0 .65-.13 1.26-.36 1.83l3 3.073S23 14.136 23 11.504C23 8.008 17.255 4 11.995 4c-1.4 0-2.741.25-3.982.701l2.161 2.16c.57-.23 1.18-.36 1.831-.36a5.004 5.004 0 0 1 5.002 5.003zM2.57 4.342l2.067 2.075C3.499 7.258 1 9.119 1 11.504c0 3.336 5.79 7.503 11.005 7.503 1.55 0 3.031-.3 4.382-.84l.42.42 2.125 2.118s.782.571 1.314 0-.074-1.305-.074-1.305L3.955 3.183s-.76-.742-1.385-.19c-.626.554 0 1.35 0 1.35zm4.963 4.96l1.55 1.552c-.05.21-.08.43-.08.65 0 1.66 1.341 3.001 3.002 3.001.22 0 .44-.03.65-.08l1.551 1.551c-.67.33-1.41.53-2.2.53a5.004 5.004 0 0 1-5.003-5.002c0-.79.2-1.53.53-2.201zm4.312-.78l3.151 3.152.02-.16c0-1.66-1.34-3.001-3.001-3.001l-.17.01z",opacity:".9",fillRule:"evenodd"}))};i.defaultProps={name:"EyeSlash"},t.a=i},2210:function(e,t,n){},2226:function(e,t,n){"use strict";var a=n(1),o=n.n(a),r=n(10),i=function(e){return o.a.createElement(r.a,e,o.a.createElement("path",{d:"M22.959 17.22c-1.686-3.552-5.128-8.062-11.636-8.65-.539-.053-1.376-.436-1.376-1.561V4.678c0-.521-.635-.915-1.116-.521L1.469 10.67a1.506 1.506 0 0 0-.1 2.08s6.99 6.818 7.443 7.114c.453.295 1.136.124 1.135-.501V17a1.525 1.525 0 0 1 1.532-1.466c1.186-.139 7.597-.077 10.33 2.396 0 0 .396.257.536.257.892 0 .614-.967.614-.967z",fillRule:"evenodd"}))};i.defaultProps={name:"Reply"},t.a=i},2227:function(e,t,n){"use strict";var a=n(1),o=n.n(a),r=n(10),i=function(e){return o.a.createElement(r.a,e,o.a.createElement("path",{d:"M6.433 14.285l-.918 5.355c-.219 1.274.532 1.82 1.676 1.218l4.81-2.528 4.807 2.528c1.145.601 1.896.056 1.677-1.218l-.918-5.355 3.89-3.792c.925-.903.64-1.785-.64-1.97l-2.843-.414c-.538.583-4.195 4.547-5.757 6.12-.865.822-1.572.015-1.572.015l-1.92-1.906s-.405-.623.213-1.204c.62-.58 1.174-.193 1.174-.193l1.32 1.14 4.008-4.34-2.404-4.872c-.572-1.159-1.5-1.159-2.072 0L8.56 7.741l-5.376.781c-1.279.186-1.566 1.068-.64 1.971l3.89 3.792z",fillRule:"evenodd"}))};i.defaultProps={name:"Recommend"},t.a=i},2228:function(e,t,n){"use strict";var a=n(1),o=n.n(a),r=n(10),i=function(e){return o.a.createElement(r.a,e,o.a.createElement("path",{d:"M19.947 3.129c-.633.136-3.927.639-5.697.385-3.133-.45-4.776-2.54-9.949-.888-.997.413-1.277 1.038-1.277 2.019L3 20.808c0 .3.101.54.304.718a.97.97 0 0 0 .73.304c.275 0 .519-.102.73-.304.202-.179.304-.418.304-.718v-6.58c4.533-1.235 8.047.668 8.562.864 2.343.893 5.542.008 6.774-.657.397-.178.596-.474.596-.887V3.964c0-.599-.42-.972-1.053-.835z",fillRule:"evenodd"}))};i.defaultProps={name:"Report"},t.a=i},2229:function(e,t,n){"use strict";var a=n(1),o=n.n(a),r=n(10),i=function(e){return o.a.createElement(r.a,e,o.a.createElement("path",{d:"M16.464 4s.051-2-1.479-2H9C7.194 2 7.465 4 7.465 4H4.752c-2.57 0-2.09 3.5 0 3.5l1.213 13.027S5.965 22 7.475 22h8.987c1.502 0 1.502-1.473 1.502-1.473l1.2-13.027c2.34 0 2.563-3.5 0-3.5h-2.7zM8.936 18.5l-.581-9h1.802v9H8.936zm4.824 0v-9h1.801l-.61 9H13.76z",fillRule:"evenodd"}))};i.defaultProps={name:"Trash"},t.a=i},2230:function(e,t,n){"use strict";var a=n(1),o=n.n(a),r=n(10),i=function(e){return o.a.createElement(r.a,e,o.a.createElement("path",{d:"M1 11.5C1 15 7 19 12 19s11-4 11-7.5S17 4 12 4 1 8 1 11.5zm11 5c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm-3-5c0 1.66 1.34 3 3 3s3-1.34 3-3-1.34-3-3-3-3 1.34-3 3z",fillRule:"evenodd"}))};i.defaultProps={name:"Eye"},t.a=i},2238:function(e,t,n){"use strict";var a=n(1),o=n.n(a),r=n(10),i=function(e){return o.a.createElement(r.a,e,o.a.createElement("path",{d:"M12 11l-3.716 3.782a.758.758 0 0 1-1.064 0 .738.738 0 0 1 0-1.052l4.249-4.512a.758.758 0 0 1 1.064 0l4.246 4.512a.738.738 0 0 1 0 1.052.757.757 0 0 1-1.063 0L12.002 11z",fillRule:"evenodd"}))};i.defaultProps={name:"ArrowUp"},t.a=i},2251:function(e,t,n){"use strict";var a=n(4),o=n(5),r=n(8),i=n(6),s=n(7),c=n(0),l=n(1),u=n(2),d=n.n(u),m=n(11),p=n.n(m),h=n(204),f=n(15),b=n(63),v=n(513),g=n(2739),y={normal:{text:"默认排序",value:"reverse"},reverse:{text:"时间排序",value:"normal"}},C=function(e){function t(){var e,n;Object(a.a)(this,t);for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return(n=Object(r.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(s)))).state={text:"时间排序",value:"normal"},n.switchType=function(e){var t=n.state.value,a=n.props.onOrderChange,o=y[t],r=o.text,i=o.value;n.setState({text:r,value:i}),a&&a(i,e)},n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.state.text,t=this.props,n=t.isConversation,a=t.commentClosed;return t.shouldReverse?!n&&!a&&Object(c.b)(f.c,{preset:"plain",onClick:this.switchType,icon:g.a,label:"切换为".concat(e)}):null}}]),t}(l.Component);C.propTypes={isConversation:d.a.bool,commentClosed:d.a.bool,onOrderChange:d.a.func,shouldReverse:d.a.bool};var O=n(43),j=(n(2901),function(e){function t(){return Object(a.a)(this,t),Object(r.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.commentPattern,n=e.onNavBack;return Object(c.b)("h2",{className:"CommentTopbar-title"},"bottom"!==t?Object(c.b)(f.c,{className:"CommentTopbar-back",preset:"plain",onClick:n},Object(c.b)(O.a,{className:"CommentTopbar-backIcon",name:"arrowLeft",left:!0,width:14,height:14}),"返回评论"):Object(c.b)("div",null,"查看对话"))}}]),t}(l.Component));j.propTypes={commentPattern:d.a.string,onNavBack:d.a.func};n(2902);n.d(t,"a",function(){return k});var k=function(e){function t(){var e,n;Object(a.a)(this,t);for(var o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return(n=Object(r.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(s)))).renderTopBarSwitch=function(){var e=n.props,t=e.isMobile,a=e.status,o=e.isConversation,r=e.commentCount,i=e.onOrderChange,s=e.commentClosed,l=e.shouldReverse;return!t&&Boolean(r&&!s)&&"reviewing"!==a&&Object(c.b)(C,{isConversation:o,onOrderChange:i,commentClosed:s,shouldReverse:l})},n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"renderTitle",value:function(){var e=this.props,t=e.commentCount,n=e.commentClosed,a=e.isConversation,o=e.onNavBack,r=e.targetLink,i=e.isCommentReviewer,s=e.reviewingCounts,u=e.onStatusChange,d=e.status,m=e.commentPattern,v=e.isOrg,g=e.isMobile;return a?Object(c.b)(j,{commentPattern:m,onNavBack:o}):i&&!n?Object(c.b)("div",{className:"CommentTopbar-tabsWrapper"},Object(c.b)(h.b,{className:"CommentTopbar-tabs"},Object(c.b)(h.a,{className:"CommentTopbar-tab","aria-controls":"CommentTopbar-open",meta:Object(b.formatNumber)(t)},Object(c.b)(f.c,{className:p()("CommentTopbar-tabButton",{"is-active":"open"===d}),onClick:function(){return u("open")}},"公开评论")),!g&&Object(c.b)(h.a,{className:"CommentTopbar-tab","aria-controls":"CommentTopbar-reviewing",meta:void 0===s?null:Object(b.formatNumber)(s)},Object(c.b)(f.c,{className:p()("CommentTopbar-tabButton",{"is-active":"reviewing"===d}),onClick:function(){return u("reviewing")}},"待".concat(v?"审核":"筛选","评论")))),r):Object(c.b)(l.Fragment,null,Object(c.b)("h2",{className:"CommentTopbar-title"},t&&!n?"".concat(Object(b.formatNumber)(t)," 条评论"):"还没有评论",r))}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.onRef,a=e.isMobile;return Object(c.b)(v.a,{className:p()("CommentTopbar",t),onRef:n,header:this.renderTitle(),options:this.renderTopBarSwitch(),showOptions:!a})}}]),t}(l.Component);k.propTypes={commentCount:d.a.oneOfType([d.a.number,d.a.string]),isConversation:d.a.bool,onNavBack:d.a.func,isCommentReviewer:d.a.bool,onStatusChange:d.a.func,onOrderChange:d.a.func,status:d.a.string,reviewingCounts:d.a.oneOfType([d.a.number,d.a.string]),targetLink:d.a.node,commentClosed:d.a.bool,commentPattern:d.a.string,isOrg:d.a.bool,isMobile:d.a.bool,options:d.a.element,shouldReverse:d.a.bool},k.defaultProps={shouldReverse:!0}},2327:function(e,t,n){"use strict";var a=n(1),o=n.n(a),r=n(10),i=function(e){return o.a.createElement(r.a,e,o.a.createElement("path",{d:"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm-2.762-5.37c.243.246.452.37.78.37.33 0 .576-.203.827-.443.25-.24 7.052-7.054 7.052-7.054a.988.988 0 0 0-.311-1.354.973.973 0 0 0-1.345.315l-6.222 6.077-2.31-2.418a.971.971 0 0 0-1.368-.19.988.988 0 0 0-.188 1.377s2.841 3.074 3.085 3.32z",fillRule:"evenodd"}))};i.defaultProps={name:"CheckCircle"},t.a=i},2341:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var a=n(4),o=n(5),r=n(8),i=n(6),s=n(7),c=n(0),l=n(1),u=n(136),d=(n(2900),function(e){function t(){return Object(a.a)(this,t),Object(r.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.onRef;return Object(c.b)("div",{className:"Comments-pattern-loading",ref:e},Object(c.b)(u.a,null))}}]),t}(l.PureComponent))},2342:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var a=n(29),o=n(0),r=n(1),i=n.n(r),s=n(261),c=n(2238),l=n(169),u=n.n(l);n(2903);function d(e){var t=e.onClick,n=e.commentsElRef,r=i.a.useState(!1),l=Object(a.a)(r,2),d=l[0],m=l[1],p=i.a.useState(0),h=Object(a.a)(p,2),f=h[0],b=h[1];return i.a.useEffect(function(){var e=n.current;if(e){var t=e.getBoundingClientRect().right;b(t-16)}},[n]),i.a.useEffect(function(){var e=u()(function(){var e=n.current;if(e){var t=window.innerHeight,a=e.getBoundingClientRect(),o=a.top,r=a.bottom,i=a.height;m(i>500&&r>t&&o<0)}},100);return window.addEventListener("scroll",e),function(){e.cancel(),window.removeEventListener("scroll",e)}},[n]),Object(s.c)(d,null,{from:{opacity:0,left:f},enter:{opacity:1,left:f},leave:{opacity:0,left:f}}).map(function(e){var n=e.item,a=e.key,r=e.props;return n&&Object(o.b)(s.a.button,{key:a,style:r,onClick:t,className:"CommentCollapseButton"},"收起评论",Object(o.b)(c.a,{center:!0}))})}},2343:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(3);function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n.selectedKey,r=void 0===o?"selectedProps":o,i=n.dropedKey,s=void 0===i?"dropedProps":i;return Object.keys(e).reduce(function(n,o){var i=t.includes(o)?r:s;return Object.assign({},n,Object(a.a)({},i,Object.assign({},n[i],Object(a.a)({},o,e[o]))))},{})}},2344:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a=function(e){return"article"===e?"Post":"book_review"===e?"BookReview":"".concat(e.slice(0,1).toUpperCase()).concat(e.slice(1))}},2739:function(e,t,n){"use strict";var a=n(1),o=n.n(a),r=n(10),i=function(e){return o.a.createElement(r.a,e,o.a.createElement("path",{d:"M13.004 7V4.232c0-.405.35-.733.781-.733.183 0 .36.06.501.17l6.437 5.033c.331.26.376.722.1 1.033a.803.803 0 0 1-.601.264H2.75a.75.75 0 0 1-.75-.75V7.75A.75.75 0 0 1 2.75 7h10.254zm-1.997 9.999v2.768c0 .405-.35.733-.782.733a.814.814 0 0 1-.5-.17l-6.437-5.034a.702.702 0 0 1-.1-1.032.803.803 0 0 1 .6-.264H21.25a.75.75 0 0 1 .75.75v1.499a.75.75 0 0 1-.75.75H11.007z",fillRule:"evenodd"}))};i.defaultProps={name:"Switch"},t.a=i},2792:function(e,t,n){"use strict";var a=n(1),o=n.n(a),r=n(10),i=function(e){return o.a.createElement(r.a,e,o.a.createElement("path",{d:"M18 8c.1-3.308-2.592-6-5.9-6-3.308 0-6 2.692-6 6v2H5.002C4 10 4 11 4 11v9s0 2 2 2h12c2 0 2-1.97 2-1.97V11s0-1-1-1h-1V8zm-6-4c2.143.018 4.005 1.597 4 4v2H8V7.996C8.013 5.562 9.857 3.982 12 4z",fillRule:"evenodd"}))};i.defaultProps={name:"Lock"},t.a=i},2898:function(e,t,n){},2899:function(e,t,n){},2900:function(e,t,n){},2901:function(e,t,n){},2902:function(e,t,n){},2903:function(e,t,n){},2904:function(e,t,n){},2905:function(e,t,n){var a=n(837),o=n(277),r=n(509),i=Math.max,s=Math.min;e.exports=function(e,t,n){var c=null==e?0:e.length;if(!c)return-1;var l=c-1;return void 0!==n&&(l=r(n),l=n<0?i(c+l,0):s(l,c-1)),a(e,o(t,3),l,!0)}},2906:function(e,t,n){},2907:function(e,t,n){},2908:function(e,t,n){},2909:function(e,t){e.exports={attributes:{width:"72px",height:"58px",viewBox:"0 0 72 58"},content:'<defs>         <path d="M0.00434937116,11.7604183 C0.0014585125,11.8367351 0,11.9134174 0,11.9904392 L0,52.0095608 C0,55.3137533 2.68603825,58 5.99943435,58 L66.0005656,58 C69.3089213,58 72,55.317989 72,52.0095608 L72,11.9904392 C72,8.68624675 69.3139617,6 66.0005656,6 L31.1520961,6 L30.2346555,3.7077864 C29.4154984,1.66113281 26.9585394,0 24.7478675,0 L6.18638069,0 C2.86742525,0 0.139552484,2.68348852 0.0902454792,5.99373937 L0.00434937116,11.7604183 Z" id="path-1"></path>         <mask id="mask-2" maskContentUnits="userSpaceOnUse" maskUnits="objectBoundingBox" x="0" y="0" width="72" height="58" fill="white">             <use xlink:href="#path-1"></use>         </mask>     </defs>     <g id="空状态" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">         <g id="collection" transform="translate(-39.000000, -30.000000)" stroke="#E7EAF1">             <g transform="translate(39.000000, 30.000000)" id="Group-7">                 <g>                     <use id="Combined-Shape" mask="url(#mask-2)" stroke-width="6" xlink:href="#path-1"></use>                     <path d="M36.4126782,38.4800003 L30.2669271,41.2927815 C29.7656337,41.522213 29.4096881,41.2718295 29.4738593,40.716584 L30.2498317,34.0024302 L25.6755762,29.0266708 C25.3024658,28.6208107 25.4306014,28.2049135 25.9785012,28.0943637 L32.6038296,26.7575697 L35.9225353,20.8696 C36.1932338,20.3893332 36.6283715,20.3826781 36.9028211,20.8696 L40.2215268,26.7575697 L46.8468552,28.0943637 C47.3872665,28.2034026 47.5280608,28.6151866 47.1497802,29.0266708 L42.5755247,34.0024302 L43.3514971,40.716584 C43.4147912,41.2642406 43.0666691,41.5253922 42.5584293,41.2927815 L36.4126782,38.4800003 Z" id="Star" stroke-width="3"></path>                 </g>             </g>         </g>     </g>'}},2910:function(e,t,n){},2911:function(e,t,n){},2912:function(e,t,n){},2913:function(e,t,n){},2914:function(e,t,n){},2915:function(e,t,n){},2916:function(e,t,n){},2917:function(e,t,n){},2983:function(e,t,n){},2984:function(e,t,n){},2985:function(e,t,n){},2986:function(e,t,n){},2989:function(e,t,n){"use strict";n.r(t);var a=n(4),o=n(5),r=n(8),i=n(6),s=n(7),c=n(0),l=n(1),u=n.n(l),d=n(11),m=n.n(d),p=n(272),h=n.n(p),f=n(16);n(556);var b=function(e){function t(){var e,n;Object(a.a)(this,t);for(var o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return(n=Object(r.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(s)))).rootRef=u.a.createRef(),n.unobserve=h.a,n.renderTarget=function(){var e=n.props.item,t=e.content.target,a=t.text,o=t.link,r=e.id,i=e.target,s=e.target,l=(s=void 0===s?{}:s).id,u=s.target,d=void 0===u?{}:u,m=d.type;return i&&"comment"===i.type?n.renderCommentButton(a,{type:m,href:o,byComment:l,target:d,notificationId:r}):Object(c.b)("span",null,o?Object(c.b)("a",{href:o,"data-za-detail-view-id":5109},a):Object(c.b)("span",null,a))},n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.addObserve,n=e.item.attachInfo,a=this.rootRef.current;f.default.setModule(a,{module:"Content"},{attached_info_bytes:n}),this.unobserve=t(a)}},{key:"componentWillUnmount",value:function(){this.unobserve()}},{key:"renderCommentButton",value:function(e,t){var n=this,a=t.href,o=t.byComment,r=t.notificationId;return Object(c.b)("a",{href:"".concat(a).concat(o?"#comment-".concat(o,"?notificationId=").concat(r):""),"data-za-detail-view-id":5109,onClick:function(e){e.preventDefault(),n.props.onCommentsModalOpen(t)}},e)}},{key:"render",value:function(){var e,t=this.props.item,n=t.content,a=n.verb,o=n.actors,r=t.isRead;return Object(c.b)("div",{ref:this.rootRef,className:m()("PushNotifications-item",{"PushNotifications-newItem":!r})},Object(c.b)("span",null,(e=o,Array.isArray(e)||(e=[e]),e.map(function(e,t){return Object(c.b)("span",{className:"PushNotifications-actor",key:t},e.link?Object(c.b)("a",{href:e.link,"data-za-detail-view-id":5109},e.name):Object(c.b)("span",null,e.name))})))," ",a," ",this.renderTarget())}}]),t}(l.Component);t.default=b},2999:function(e,t,n){"use strict";n.r(t);var a,o,r,i,s,c=n(22),l=n(24),u=n(3),d=n(4),m=n(5),p=n(8),h=n(6),f=n(7),b=n(0),v=n(2),g=n.n(v),y=n(1),C=n.n(y),O=n(16),j=n(196),k=n(102),w=n.n(k),N=n(1776),S=n(15),I=n(44),P=(n(2911),"oneself"),R="enterprise",E=[{title:"发表澄清声明",image:"https://zhstatic.zhihu.com/assets/report/Statement@3x.png",description:(a={},Object(u.a)(a,P,"个人可以对站内关于自身的不实描述内容发表澄清声明，声明通过审核后，将会以标记的形式显示在投诉内容的上方，点击可跳转至您的声明全文页面"),Object(u.a)(a,R,"企业可以对站内关于自身的不实描述内容发表澄清声明，声明通过审核后，将会以标记的形式显示在投诉内容的上方，点击可跳转至您的声明全文页面"),a),defaultReasonIdMap:(o={},Object(u.a)(o,P,46),Object(u.a)(o,R,48),o)},{title:"提交侵权举报",image:"https://zhstatic.zhihu.com/assets/report/Infringement@3x.png",description:Object(b.b)("span",null,"您提交的侵权举报将会根据知乎侵权举报规范进行受理"),defaultReasonIdMap:(r={},Object(u.a)(r,P,47),Object(u.a)(r,R,49),r),memberReasonIdMap:(i={},Object(u.a)(i,P,12),Object(u.a)(i,R,13),i)}],x=(s={},Object(u.a)(s,R,"当您发现知乎上存在涉嫌侵犯您企业合法权益的内容时，您可以先尝试与作者沟通解决，如沟通无效，也可以通过以下方式向知乎提出诉求。"),Object(u.a)(s,P,"当您发现知乎上存在涉嫌侵犯您个人合法权益的内容时，您可以通过以下方式向知乎提出诉求。"),s),A=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(p.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).handleClick=function(e){O.default.trackEvent(e,{id:3467,aciton:"Click"})},n}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){O.default.trackCardShow(null,{id:3466})}},{key:"render",value:function(){var e=this,t=this.props,n=t.onSubMenuEnter,a=t.onBackClick,o=t.activeId,r=t.isMobile,i=t.type,s=["answer","article","pin"].includes(i)?E:E.slice(1),c=function(e,t){return("member"===e?10===t:29===t)?P:R}(i,o);return Object(b.b)("section",{className:w()("ReportInfringement",{"ReportInfringement--mobile":r})},Object(b.b)("p",{className:"ReportInfringement-subtitle"},x[c]),Object(b.b)("ul",{className:"ReportInfringement-list"},s.map(function(t){var a=t.image,o=t.title,r=t.description,s=t.defaultReasonIdMap,l=t.memberReasonIdMap,u=("member"===i?l:s)[c],d=r[c]||r;return Object(b.b)("li",{className:"ReportInfringement-item",key:o,"data-za-module":"Content","data-za-detail-view-path-module_name":o,onClick:function(t){e.handleClick(t.currentTarget),n(u)}},Object(b.b)("img",{className:"ReportInfringement-image",src:a}),Object(b.b)("div",{className:"ReportInfringement-content"},Object(b.b)("h1",{className:"ReportInfringement-itemTitle"},o),Object(b.b)("p",{className:"ReportInfringement-itemDescription"},d)),Object(b.b)(N.a,{className:"ReportInfringement-arrow"}))})),Object(b.b)(I.a,{direction:"horizontal"},Object(b.b)(S.c,{"data-za-module":"Content","data-za-detail-path-view-module_name":"返回",onClick:function(t){e.handleClick(t.currentTarget),a()}},"返回")))}}]),t}(C.a.Component),T=n(39),L=function(e){return"https://www.zhihu.com/account/infringement?".concat(Object(T.stringify)(e))};n(2912);function M(e){var t=e.infringementType;return Object(b.b)("p",{className:"ReportOrgContent"},"若您已注册机构号，可使用",Object(b.b)("span",{className:"ReportOrgContent-highlight"},"机构号"),"declare"===t?"发表澄清声明":"提交侵权举报","，",Object(b.b)("span",{className:"ReportOrgContent-highlight"},"免提交资质材料"),"。")}n(2913);function _(e){var t=e.infringementType,n=e.isIndividualReason,a=e.onBackClick,o="declare"===t;return Object(b.b)("div",{className:"ReportInfringementMobile"},Object(b.b)("p",{className:"ReportInfringementMobile-text"},"1."," ",o?"".concat(n?"个人":"企业","可以对站内关于自身的不实描述内容发表澄清声明，声明通过审核后，将会以标记的方式形式显示在投诉内容的上方，点击可跳转至您的声明全文。"):"您提交的侵权举报将会根据知乎侵权举报规范进行受理。"),Object(b.b)("p",{className:"ReportInfringementMobile-text"},"2. 根据",Object(b.b)("a",{className:"ReportInfringementMobile-link",href:"https://www.zhihu.com/terms#sec-report",target:"_blank",rel:"noopener noreferrer"},"知乎侵权举报规范"),"，您需按照提示提供完整、有效的证明材料，",o?"以发表澄清声明。":"并规范填写投诉说明。","若您已确认完毕，",Object(b.b)("span",{className:"ReportInfringementMobile-bold"},"请到桌面版网页进行诉求提交。")),!n&&Object(b.b)("p",{className:"ReportInfringementMobile-text"},"若您已注册机构号，可使用机构号".concat(o?"发表澄清声明":"提交侵权举报","，免提交资质材料。")),Object(b.b)("img",{className:"ReportInfringementMobile-img",src:"https://zhstatic.zhihu.com/report/app_report.png"}),Object(b.b)(S.c,{color:S.a.Blue,preset:S.b.Primary,onClick:a,className:"ReportInfringementMobile-button"},"我知道了"))}n(2914);var D=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(p.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).handleClick=function(e){O.default.trackEvent(null,{id:3469,action:"Click"},{button:{text:e}})},n}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){O.default.trackCardShow(null,{id:3468})}},{key:"render",value:function(){var e=this,t=this.props,n=t.onBackClick,a=t.urlToken,o=t.type,r=46===t.activeId;return t.isMobile?Object(b.b)(_,{isIndividualReason:r,infringementType:"declare",onBackClick:n}):Object(b.b)("section",{className:"ReportDeclare"},Object(b.b)("div",{className:"ReportDeclare-description"},"当您发现知乎上有关于您",r?"个人":"企业","的侵权内容时，您可通过此方式发表澄清声明。",Object(b.b)("br",null),Object(b.b)("br",null),"申请发表澄清声明的流程如下：",Object(b.b)("ul",null,Object(b.b)("li",null,"1. 在站内写一篇",Object(b.b)("a",{href:"https://zhuanlan.zhihu.com/write",target:"_blank",rel:"noopener noreferrer",onClick:function(){return e.handleClick("澄清声明文章")}},"澄清声明文章"),"并发布。",Object(b.b)("a",{href:"https://zhstatic.zhihu.com/assets/report/template-v2.png",target:"_blank",rel:"noopener noreferrer",onClick:function(){return e.handleClick("查看模版")}},"查看模版"),Object(b.b)("br",null)),Object(b.b)("li",null,"2.返回此页面继续发表声明，您需按照提示提供完整、有效的证明材料。",Object(b.b)("br",null)),Object(b.b)("li",null,"3.审核通过后，侵权纠纷内容上会关联展示您的澄清声明，点击可跳转至您的声明全文。")),!r&&Object(b.b)(M,{infringementType:"declare"})),Object(b.b)(I.a,{direction:"horizontal"},Object(b.b)(S.c,{onClick:n},"返回"),Object(b.b)(S.c,{onClick:function(){return e.handleClick("继续发表声明")},component:"a",href:L({infringementType:"declare",resourceId:a,type:o,reasonType:r?"inflictIndividual":"enterprise"}),className:"ReportDeclare-continue",color:S.a.Blue,preset:S.b.Primary},"继续发表声明")))}}]),t}(C.a.Component),F=(n(2915),function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(p.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).handleClick=function(e){O.default.trackEvent(null,{id:3510,aciton:"Click"},{button:{text:e}})},n}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){O.default.trackCardShow(null,{id:3509})}},{key:"render",value:function(){var e=this,t=this.props,n=t.onBackClick,a=t.urlToken,o=t.type,r=t.activeId,i="member"===o?12===r:47===r;return t.isMobile?Object(b.b)(_,{isIndividualReason:i,infringementType:"trespass",onBackClick:n}):Object(b.b)("section",{className:"ReportTrespass"},Object(b.b)("p",{className:"ReportTrespass-description"},"根据",Object(b.b)("a",{href:"https://www.zhihu.com/terms#sec-report",onClick:function(){e.handleClick("知乎侵权举报规范")}},"知乎侵权举报规范"),"，您需按照提示提供完整、有效的证明材料，并规范填写投诉说明。若您已确认完毕，请继续提交举报信息。"),!i&&Object(b.b)(M,{infringementType:"trespass"}),Object(b.b)(I.a,{direction:"horizontal"},Object(b.b)(S.c,{onClick:function(){e.handleClick("返回"),n()}},"返回"),Object(b.b)(S.c,{onClick:function(){e.handleClick("继续提交举报")},component:"a",href:L({resourceId:a,type:o,reasonType:i?"inflictIndividual":"enterprise"}),className:"ReportTrespass-continue",color:S.a.Blue,preset:S.b.Primary},"继续提交举报")))}}]),t}(C.a.Component)),B=[{id:0,text:"举报",childIds:[1,2,3,4,5,21,7,8,9]},{id:1,text:"低质问题",types:["question","drama_statement"],childIds:[23,33,34,40,35,27,22]},{id:2,text:"垃圾广告信息",reason:"spam",copywriter:{title:"举报说明",placeholder:"举报详细说明（选填）",isRequired:!1},disabled:!0},{id:3,text:"不友善行为",types:["answer","comment","drama_bullet","article","column","pin","book_review","favlist","discussion_review","zvideo"],childIds:[40,41]},{id:4,text:"有害信息",childIds:[19,30,39,26,18,28]},{id:5,text:"涉嫌侵权",childIds:[20,29,12],types:["question","drama_statement","answer","comment","drama_bullet","article","column","pin","book_review"],reason:"infringement",disabled:!0},{id:6,types:[]},{id:7,text:"其他",reason:"old",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0,types:["question","answer","comment","article","column","message","member","favlist","activity","book_review","discussion_review","drama_statement","drama_bullet"]},{id:8,reason:"direction",shouldShow:function(e){return e.isColumnArticle}},{id:9,reason:"tipjar",shouldShow:function(e){return e.isTipjarEnabled}},{id:12,reason:"enterprise",disabled:!0,customComponent:A},{id:17,reason:"spam"},{id:18,reason:"illegality",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0},{id:19,reason:"politics"},{id:20,reason:"repost",copywriter:{title:"举报说明",placeholder:"原文链接或补充说明（必填）"},types:["answer","article","column","pin","book_review"],disabled:!0},{id:21,reason:"temptation",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0,types:["answer","comment","drama_bullet","article","column","zvideo"]},{id:22,reason:"personal"},{id:23,reason:"ambiguity"},{id:24,reason:"worthless"},{id:25,reason:"rumour"},{id:26,reason:"suicide",types:["question","drama_statement","answer","article","column","pin","book_review","comment","drama_bullet","zvideo"]},{id:27,reason:"medicine"},{id:28,reason:"superstition"},{id:29,reason:"oneself",disabled:!0,customComponent:A},{id:30,reason:"porn"},{id:31,reason:"pirate"},{id:32,reason:"invalid"},{id:33,reason:"subjective"},{id:34,reason:"rumour"},{id:35,reason:"provoke"},{id:36,reason:"edit"},{id:37,reason:"harassment"},{id:38,reason:"hatred"},{id:39,text:"不实信息",types:["answer","comment","drama_bullet","article","column","pin","book_review","zvideo"],childIds:[42,43,44,45]},{id:40,reason:"abuse"},{id:41,reason:"unfriendly",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0},{id:42,reason:"untruth_science",text:"科学类不实信息",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0},{id:43,reason:"untruth_rumor",text:"社会谣言类不实信息",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0},{id:44,reason:"untruth_fake_profile",text:"编造经历类不实信息",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0,types:["answer","comment","drama_bullet","article","column","pin","book_review"]},{id:45,text:"诽谤等侵权信息",childIds:[20,29,12],types:["answer","comment","drama_bullet","article","column","pin","book_review"]},{id:46,customComponent:D,text:"发表澄清声明",reason:"declare",subtitle:"个人侵权"},{id:47,customComponent:F,text:"提交侵权举报",reason:"trespass",subtitle:"个人侵权"},{id:48,customComponent:D,text:"发表澄清声明",reason:"declare",subtitle:"企业侵权"},{id:49,customComponent:F,text:"提交侵权举报",reason:"trespass",subtitle:"企业侵权"}],z=[{id:0,text:"举报",childIds:[1,2,3,4]},{id:1,text:"垃圾广告信息",reason:"spam"},{id:2,text:"不友善行为",reason:"unkind"},{id:3,text:"有害信息",reason:"imitation"},{id:4,text:"其他",reason:"old",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0}],V=[{id:0,text:"举报",childIds:[1,2,3]},{id:1,reason:"abuse"},{id:2,reason:"harassment"},{id:3,reason:"spam"}],U=[{id:0,text:"举报",childIds:[1,4,6,7]},{id:1,text:"冒充我或他人",childIds:[8,9],reason:"fake",disabled:!0},{id:4,reason:"spam",text:"垃圾广告帐号"},{id:6,reason:"profile",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0},{id:7,reason:"old",text:"其他",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0},{id:8,text:"冒充我",subtitle:"请选择举报理由",reason:"oneself",disabled:!0,childIds:[10,11]},{id:9,reason:"impersonate",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},text:"冒充他人",disabled:!0},{id:10,text:"个人侵权",isRequired:!0,customComponent:A},{id:11,text:"企业侵权",isRequired:!0,customComponent:A},{id:12,isRequired:!0,customComponent:F,text:"提交侵权举报",reason:"trespass",subtitle:"个人侵权"},{id:13,isRequired:!0,customComponent:F,text:"提交侵权举报",reason:"trespass",subtitle:"企业侵权"}],q=[{id:0,text:"举报",childIds:[2,3,4,5,14,15,16,17,18,700]},{id:2,reason:"abuse",text:"骚扰/辱骂/歧视等不友善行为"},{id:3,reason:"illegality",text:"发过违反法律法规的内容"},{id:4,reason:"spam",text:"垃圾广告帐号"},{id:5,reason:"politics",text:"发过政治敏感内容"},{id:14,reason:"minor"},{id:15,reason:"porn"},{id:16,reason:"uncivilized_behavior"},{id:17,reason:"suicide",text:"疑似自杀或自残"},{id:18,reason:"superstition"},{id:700,reason:"old",text:"其他",copywriter:{title:"举报说明",placeholder:"举报详细说明（必填）"},disabled:!0}],W=n(29),H=n(30),K=n(61),G=n.n(K),Q=n(262),Y=n(2327),$=function(e){function t(){var e;return Object(d.a)(this,t),(e=Object(p.a)(this,Object(h.a)(t).call(this))).handleClick=e.handleClick.bind(Object(H.default)(e)),e}return Object(f.a)(t,e),Object(m.a)(t,[{key:"handleClick",value:function(){var e=this.props,t=e.id,n=e.reason,a=e.disabled,o=e.onSubMenuEnter,r=e.onItemSelect;n&&!a?r(t):o(t)}},{key:"render",value:function(){var e=this.props,t=e.reason,n=e.text,a=e.disabled,o=e.isSelected,r=e.id,i=n||Q.b[t];return Boolean(t&&!a)?Object(b.b)("label",{className:"ReportMenu-item",htmlFor:t},Object(b.b)("div",{className:"ReportMenu-itemValue needsclick"},i),Object(b.b)("input",{className:"ReportMenu-itemCheck",type:"radio",name:"report",value:r,id:t,checked:o,onChange:this.handleClick}),Object(b.b)(Y.a,{size:18,className:"ReportMenu-itemCheckIcon",name:"checkRound"})):Object(b.b)("button",{className:"ReportMenu-item",onClick:this.handleClick},Object(b.b)("span",{className:"ReportMenu-itemValue"},i),Object(b.b)(N.a,{size:18}))}}]),t}(y.Component);$.propTypes={id:g.a.number.isRequired,reason:g.a.string,text:g.a.string,disabled:g.a.bool,isSelected:g.a.bool,onSubMenuEnter:g.a.func.isRequired,onItemSelect:g.a.func.isRequired};var J=function(e){function t(){return Object(d.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){switch(this.props.reason){case"privacy":return Object(b.b)("div",{className:"ReportMenu-inner"},Object(b.b)("div",{className:"ReportMenu-paragraph"},"您好，当您发现知乎上有泄漏您隐私的内容时，您可向知乎进行举报。 请您把以下内容通过邮件发送到 ",Object(b.b)("a",{className:"ReportMenu-link",href:"mailto:i@zhihu.com"},"i@zhihu.com")," 邮箱，我们会尽快处理。"),Object(b.b)("ul",{className:"ReportMenu-paragraph"},Object(b.b)("li",null,"1. 您认为哪些内容泄露了您的隐私？（请在邮件中列出您举报的内容、链接地址，并给出简短的说明）"),Object(b.b)("li",null,"2. 您是谁？（身份证明材料，可以是身份证或护照等证件）")),Object(b.b)("div",{className:"ReportMenu-paragraph ReportMenu-paragraph--light"},"邮件格式请参考",Object(b.b)("a",{className:"ReportMenu-link--light",href:"https://www.zhihu.com/terms#sec-report",target:"_blank",rel:"noopener noreferrer"},"这里"),"；"));case"defamation":return Object(b.b)("div",{className:"ReportMenu-inner"},Object(b.b)("div",{className:"ReportMenu-paragraph"},"您好，当您发现知乎上有诽谤您的内容时，您可以向知乎进行举报。 请您把以下内容通过邮件发送到",Object(b.b)("a",{className:"ReportMenu-link",href:"mailto:i@zhihu.com"}," ","i@zhihu.com"," "),"邮箱，我们会尽快处理。"),Object(b.b)("ul",{className:"ReportMenu-paragraph"},Object(b.b)("li",null,"1. 您举报的内容以及侵犯了您什么权益？（请在邮件中列出您举报的内容、链接地址，并给出简短的说明）"),Object(b.b)("li",null,"2. 您是谁？（身份证明材料，可以是身份证或护照等证件）")),Object(b.b)("div",{className:"ReportMenu-paragraph ReportMenu-paragraph--light"},"邮件格式请参考 ",Object(b.b)("a",{className:"ReportMenu-link--light",href:"https://www.zhihu.com/terms#sec-report",target:"_blank",rel:"noopener noreferrer"},"这里")," ；"));default:return null}}}]),t}(y.Component);J.propTypes={reason:g.a.string.isRequired};var Z=n(92),X=function(e){function t(){return Object(d.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props,t=e.copywriter.placeholder,n=e.onDetailInput,a=e.errorText,o=e.checkCustomReasonContent;return Object(b.b)("div",{className:"ReportMenu-inner"},Object(b.b)(Z.a,{multiline:!0,grey:!0,rows:5,className:"ReportMenu-textarea",placeholder:t,onChange:function(e){return n(e.target.value)},onBlur:o}),Object(b.b)("div",{className:"ReportMenu-errorText"},a))}}]),t}(y.Component);X.propTypes={onDetailInput:g.a.func.isRequired,copywriter:g.a.object,errorText:g.a.string};n(2916);var ee=function(e){function t(){return Object(d.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props,t=e.checked,n=e.onChange,a=e.name,o=e.text,r=e.desc,i=a||o;return Object(b.b)("div",null,Object(b.b)("label",{className:"ReportOption-check",htmlFor:i},Object(b.b)("input",{type:"checkbox",name:i,checked:t,onChange:n}),Object(b.b)("span",null,"同时",o)),r&&Object(b.b)("div",{className:"ReportOption-desc"},r))}}]),t}(y.Component),te=function(e){return e.length>150?{isLegal:!1,errorReason:Q.a.contentTooLong}:/[\u4e00-\u9fa5a-zA-Z0-9]/.test(e)?{isLegal:!0,errorReason:""}:{isLegal:!1,errorReason:Q.a.contentIllegal}},ne=(n(2917),function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(p.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={blockChecked:null,commentChecked:null,activeId:0,parentId:null,selectedId:null,errorText:"",isMobile:!1,isSubmiting:!1,isSubmited:!1,path:[]},n.menuItems={},n.getReportText=function(e){if(!e)return"";var t=n.props.nodes[e];return t&&(t.text||Q.b[t.reason])||""},n.getReportLevel=function(){return"第 ".concat(n.state.path.length+1," 级")},n.handleItemSelect=function(e){var t=n.selectedId===e?null:e;n.setState({selectedId:t});var a=n.props,o=a.zaEnabled,r=a.type;t&&o&&O.default.trackEvent(null,{action:"Select",element:"Menu",id:2883,name:n.getReportLevel()},{button:{text:n.getReportText(e)},report:{id:e,type:r}})},n.handleSubMenuEnter=function(e){n.setState(function(t){var n=t.activeId,a=t.path;return{activeId:e,parentId:n,selectedId:null,path:a.concat([e])}});var t=n.props,a=t.zaEnabled,o=t.type;a&&O.default.trackEvent(null,{action:"Expand",element:"Menu",id:2883,name:n.getReportLevel()},{button:{text:n.getReportText(e)},report:{id:e,type:o}})},n.getCommentChecked=function(){var e=n.state,t=e.commentChecked,a=e.parentId,o=e.activeId;return"boolean"==typeof t?t:[2,3].includes(a||o)},n.handleDetailInput=function(e){n.setState({customReason:e,errorText:""})},n.handleBackClick=function(){var e=n.props.nodes,t=n.state,a=t.parentId,o=t.path,r=Object.keys(e).find(function(t){var n=e[t].childIds;return n&&n.includes(a)});n.setState({activeId:a,parentId:r&&Number(r),selectedId:null,hasWarning:!1,customReason:"",errorText:"",path:o.slice(0,-1)});var i=n.props,s=i.zaEnabled,c=i.type;s&&O.default.trackEvent(null,{action:"Back",element:"Button",id:2884,name:n.getReportLevel()},{report:{id:n.state.activeId,type:c}})},n.handleSubmitAppeal=function(){var e="",t=n.state.activeId,a=n.props,o=a.type,r=a.urlToken,i=a.nodes;"enterprise"===i[t].reason||13===t?e="org":"oneself"!==i[t].reason&&37!==t||(e="people"),window.open("//www.zhihu.com/account/complaints/".concat(e,"/").concat(o,"/").concat(r))},n.handleSubmit=function(){var e=n.state,t=e.selectedId,a=e.customReason,o=e.activeId,r=e.parentId,i=n.getCommentChecked();if(n.isSubmitEnabled()&&n.checkCustomReasonContent()){var s=n.props,c=s.nodes,l=s.onSubmit,u=s.onDeleteComment,d=c[t||o],m=d.reason,p=d.id;n.setState({isSubmiting:!0});var h=l({reason:m,customReason:a});h&&h.then?h.then(n.submitEnd):n.submitEnd();var f=u&&[2,3].includes(r||o),b=n.props,v=b.zaEnabled,g=b.type;v&&(O.default.trackEvent(null,{id:2885,name:n.getReportLevel(),action:"Click"},{report:{type:g},button:{text:n.getReportText(p)}}),O.default.trackEvent(Object(H.default)(n),Object.assign({action:"Report",element:"Button"},f&&{id:3039,name:m}),Object.assign({report:{id:p,type:g}},f&&{button:{text:i?"举报并删除":"仅举报"}})))}},n.submitEnd=function(e){n.setState({isSubmiting:!1,isSubmited:!0});var t=n.state.blockChecked,a=n.props,o=a.onBlockUser,r=a.onDeleteComment,i=a.onEnd;Promise.all([t&&o&&o(),n.getCommentChecked()&&r&&r()].map(function(e){return Promise.resolve(e).catch(function(e){return e})})).then(function(t){var n=Object(W.a)(t,2),a=n[0],o=n[1];i&&i({result:e,blockUserResult:a,commentDeleteResult:o})})},n.checkCustomReasonContent=function(){var e=n.state,t=e.activeId,a=e.customReason,o=n.props.nodes[t].copywriter;if((14===t||24===t||Boolean(o))&&a){var r=te(a),i=r.isLegal,s=r.errorReason;if(!i)return n.setState({errorText:s}),!1}return!0},n}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.type,t=G()(navigator.userAgent);this.setState({isMobile:t.Mobile}),O.default.trackCardShow(null,{id:2890},{button:{text:e}})}},{key:"componentWillUpdate",value:function(e,t){var n=this.state.activeId,a=t.activeId,o=this.props,r=o.nodes,i=o.onContentChange;if(a!==n){var s=r[a],c=s.reason,l=s.text,u=s.childIds,d=s.copywriter,m=s.subtitle;i(l||Q.b[c],m||d&&d.title||(u?void 0:""))}}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.zaEnabled,n=e.type,a=this.state.isSubmited;t&&!a&&O.default.trackEvent(null,{id:4328,action:"Close",name:this.getReportLevel()},{report:{type:n}})}},{key:"isSubmitEnabled",value:function(){var e=this.state,t=e.selectedId,n=e.activeId,a=e.customReason,o=this.props.nodes;return t||(Boolean(o[n].copywriter)||14===n||24===n)&&(!1===o[n].copywriter.isRequired||a)}},{key:"render",value:function(){var e=this,t=this.props,n=t.nodes,a=t.options,o=Object(l.a)(t,["nodes","options"]),r=this.state,i=r.activeId,s=r.parentId,u=r.selectedId,d=r.errorText,m=r.isMobile,p=n[i],h=p.reason,f=p.childIds,v=p.copywriter,g=p.customComponent;if(void 0!==g)return Object(b.b)(g,Object(c.default)({onBackClick:this.handleBackClick,onItemSelect:this.handleItemSelect,onSubMenuEnter:this.handleSubMenuEnter},this.props,this.state));var y=Boolean(f),C=14===i||24===i||Boolean(v),O=y&&Object(b.b)("div",{className:"ReportMenu-inner ReportMenu-options"},f.map(function(e){return n[e]}).filter(function(e){return e&&(!e.shouldShow||e.shouldShow(o))}).map(function(t){return Object(b.b)($,Object(c.default)({ref:function(n){e.menuItems[t.id]=n},key:t.id},t,{isSelected:u===t.id,onSubMenuEnter:e.handleSubMenuEnter,onItemSelect:e.handleItemSelect}))})," ")||C&&Object(b.b)(X,{onDetailInput:this.handleDetailInput,copywriter:v,errorText:d,checkCustomReasonContent:this.checkCustomReasonContent})||Object(b.b)(J,{isMobile:m,reason:h}),j=y&&o.talkerToken&&Object(b.b)(ee,{checked:this.state.blockChecked,text:"将此人屏蔽",onChange:function(t){return e.setState({blockChecked:t.target.checked})}}),k=s||i,N=o.onDeleteComment&&[2,3].includes(k)&&Object(b.b)(ee,{checked:this.getCommentChecked(),desc:Boolean(k)&&"社区鼓励举报".concat(n[k].text,"，同时可以直接删除该评论，删除操作并不影响对违规内容和违规用户的处理。"),onChange:function(t){return e.setState({commentChecked:t.target.checked})},text:"删除该评论"}),P=this.props.isSubmiting;return Object(b.b)("div",{className:w()("ReportMenu",{"ReportMenu-mobile":m})},O,(j||N)&&Object(b.b)("div",null,j,N,a),Object(b.b)(I.a,{direction:"horizontal"},"number"==typeof s&&Object(b.b)(S.c,{onClick:this.handleBackClick}," 返回 "),y||C?Object(b.b)(S.c,{className:"ReportMenu-button",disabled:P||!this.isSubmitEnabled(),onClick:this.handleSubmit,color:"blue",preset:"primary"},"举报"):!m&&Object(b.b)(S.c,{onClick:this.handleSubmitAppeal,preset:"primary",color:"blue"},"进入诉求提交页面")))}}]),t}(y.Component));ne.propTypes={nodes:g.a.object.isRequired,onContentChange:g.a.func.isRequired,onSubmit:g.a.func.isRequired,onEnd:g.a.func,onBlockUser:g.a.func,onDeleteComment:g.a.func,isColumnArticle:g.a.bool,isTipjarEnabled:g.a.bool};var ae=ne,oe=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(p.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).filterNodes=function(e,t,n){var a=e.filter(function(e){return!!e.isRequired||(-1!=["infringement","repost","oneself","enterprise","fake"].indexOf(e.reason)||0===e.id||("question"!==t||-1==["closed","suggested","evaluated","locked"].indexOf(n)||0===e.id)&&("member"!==t||-1==["ban","hang"].indexOf(n)||"profile"===e.reason))});return 1===a.length&&0===a[0].id&&(a=[]),a},n}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e,t=this.props,n=t.type,a=t.status,o=Object(l.a)(t,["type","status"]);return e="message"===n?V:-1!==["member","club_mask"].indexOf(n)?U:-1!==["drama","drama_connect_member"].indexOf(n)?q:"favlist"===n?z:B.filter(function(e){return!e.types||e.types.includes(n)}),e=this.filterNodes(e,n,a),Object(b.b)(ae,Object(c.default)({nodes:e.reduce(function(e,t){return Object.assign({},e,Object(u.a)({},t.id,t))},{})},o,{type:n}))}}]),t}(y.Component);oe.propTypes={type:g.a.string.isRequired};var re=n(2343),ie=n(2344),se=n(49),ce="请选择举报理由",le="举报",ue=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(p.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={title:void 0!==n.props.title?n.props.title:le,subtitle:void 0!==n.props.subtitle?n.props.subtitle:ce},n.handleSubmit=function(e){var t=e.reason,a=e.customReason,o=n.props,r=o.urlToken,i=o.type;return n.props.doReport(r,i,t,a)},n.handleContentChange=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ce;n.setState({title:e,subtitle:t})},n.handleClose=function(){n.props.zaEnabled&&O.default.trackEvent(n.container,{action:"Ok"},{button:{text:"知道了"}}),n.props.onClose()},n}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidUpdate",value:function(e){if(!e.shown&&this.props.shown){var t=this.props,n=t.type,a=t.id;O.default.setModule(this.container,{module:"ReportDialog"},{card:{card_type:"Content",content:Object(u.a)({type:Object(ie.a)(n)},"comment"===n?"id":"token",String(a))}})}}},{key:"render",value:function(){var e=this,t=this.props,n=t.shown,a=t.onClose,o=Object(l.a)(t,["shown","onClose"]),r=this.state,i=r.title,s=r.subtitle,u=Object(re.a)(o,Object.keys(j.b.propTypes)),d=u.selectedProps,m=u.dropedProps;return Object(b.b)(j.b,Object(c.default)({title:i,subtitle:s,onClose:this.handleClose,className:"ReportModal"},d),n&&Object(b.b)(oe,Object(c.default)({ref:function(t){e.container=t},onSubmit:this.handleSubmit,onEnd:a,onContentChange:this.handleContentChange},m)))}}]),t}(y.Component);ue.propTypes={onClose:g.a.func.isRequired,type:g.a.oneOf(se.a).isRequired,shown:g.a.bool.isRequired,isColumnArticle:g.a.bool,isTipjarEnabled:g.a.bool,onBlockUser:g.a.func,onDeleteComment:g.a.func,doReport:g.a.func.isRequired,zaEnabled:g.a.bool},ue.defaultTypes={zaEnabled:!1},n.d(t,"ReportModal",function(){return ue})},3002:function(e,t,n){"use strict";n.r(t);var a=n(22),o=n(24),r=n(4),i=n(5),s=n(8),c=n(6),l=n(7),u=n(0),d=n(2),m=n.n(d),p=n(1),h=n(15),f=(n(669),n(44)),b=n(16),v=n(196),g=n(30),y=n(92),C=n(492),O=function(e,t,n){return n&&void 0!==t&&(e||!t)},j=20,k=60,w=function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(s.a)(this,Object(c.a)(t).call(this))).shouldSubmitIsDisabled=function(){var t=e.state,n=t.title,a=t.description;return!n||n.length>j||a.length>k},e.state={isPublic:!0,title:"",description:""},e.handleSubmit=e.handleSubmit.bind(Object(g.default)(e)),e}return Object(l.a)(t,e),Object(i.a)(t,[{key:"handleSubmit",value:function(e){e.preventDefault();var t=this.state,n=t.isPublic,a=t.title,o=t.description;if(a){var r=this.props,i=r.onSubmit,s=r.onBack,c=r.authRequired,l=r.isActive,u={title:a,description:o,isPublic:n};O(n,l,c)?c(i)(u):(i(u),s())}}},{key:"render",value:function(){var e=this,t=this.state,n=t.title,a=t.description,o=t.isPublic,r=this.props.onBack,i=this.shouldSubmitIsDisabled();return Object(u.b)("form",{className:"Favlists-content",onSubmit:this.handleSubmit},Object(u.b)("div",{className:"Favlists-addItems"},Object(u.b)("div",{className:"Favlists-addItem"},Object(u.b)(y.a,{className:"Favlists-titleInput",placeholder:"收藏标题",onChange:function(t){var n=t.target.value;e.setState({title:n})}}),Object(u.b)("div",{className:"Favlists-inputTips"},Object(u.b)(C.a,{name:"收藏标题",current:n?n.length:0,max:j}))),Object(u.b)("div",{className:"Favlists-addItem"},Object(u.b)(y.a,{multiline:!0,className:"Favlists-descritionInput",placeholder:"收藏描述（可选）",onChange:function(t){var n=t.target.value;e.setState({description:n})},rows:5}),Object(u.b)("div",{className:"Favlists-inputTips"},Object(u.b)(C.a,{name:"收藏描述",current:a?a.length:0,max:k}))),Object(u.b)("div",{className:"Favlists-addItem"},Object(u.b)("label",{className:"Favlists-privacyOption"},Object(u.b)("input",{className:"Favlists-privacyOptionRadio",name:"isPublic",type:"radio",value:"true",checked:o,onChange:function(){return e.setState({isPublic:!0})}}),Object(u.b)("span",null,"公开"),Object(u.b)("span",{className:"Favlists-privacyOptionTips"},"有其他人关注此收藏夹时不可设置为私密")),Object(u.b)("label",{className:"Favlists-privacyOption"},Object(u.b)("input",{className:"Favlists-privacyOptionRadio",name:"isPublic",type:"radio",value:"false",checked:!o,onChange:function(){return e.setState({isPublic:!1})}}),Object(u.b)("span",null,"私密"),Object(u.b)("span",{className:"Favlists-privacyOptionTips"},"只有你自己可以查看这个收藏夹")))),Object(u.b)(f.a,{direction:"horizontal",className:""},r&&Object(u.b)(h.c,{onClick:r},"返回"),Object(u.b)(h.c,{color:"blue",preset:"primary",type:"submit",disabled:i},"确认创建")))}}]),t}(p.Component);w.propTypes={onSubmit:m.a.func.isRequired,onBack:m.a.func,authRequired:m.a.func};var N=w,S=n(87),I=n(144),P=n(2792),R=function(e){function t(){var e,n;Object(r.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(s.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).handleChange=function(){var e=n.props;(0,e.onChange)(e.id,n.props.checked)},n}return Object(l.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.zaEnabled,n=e.id;t&&b.default.setModule(this,{module:"CollectionItem"},{card:{card_type:"Content",content:{type:"Collection",token:String(n)}}})}},{key:"render",value:function(){var e=this.props,t=e.answerCount,n=e.title,o=e.isPublic,r=e.checked,i=void 0!==r&&r?{preset:"primary",color:"grey",children:"已收藏"}:{color:"blue",children:"收藏"};return Object(u.b)("div",{className:"Favlists-item"},Object(u.b)("div",{className:"Favlists-itemInner"},Object(u.b)("div",{className:"Favlists-itemName"},Object(u.b)("span",{className:"Favlists-itemNameText"},n),!1===o&&Object(u.b)("span",{className:"Favlists-itemIcon"},Object(u.b)(P.a,{size:16}))),Object(u.b)("div",{className:"Favlists-itemContent"},t," 条内容")),Object(u.b)(h.c,Object(a.default)({},i,{className:"Favlists-updateButton",onClick:this.handleChange})))}}]),t}(p.Component),E=function(e){function t(){var e,n;Object(r.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(s.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).items={},n.handleFavlistItemChange=function(e,t){b.default.trackEvent(n.items[e],{action:t?"UnCollect":"Collect",element:"Button",is_intent:!1}),n.props.onUpdate(e,t)},n}return Object(l.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.relations,o=t.items,r=t.isFetching,i=t.isDrained,s=t.onAdd,c=t.onLoad;return Object(u.b)("div",{className:"Favlists-content"},Object(u.b)(S.b,{isLocal:!0,isLoading:r,isDrained:i,onLoad:c,placeholder:Object(u.b)(I.a,{title:!0}),getContainer:function(e){return e},className:"Favlists-items"},o.map(function(t){return Object(u.b)(R,Object(a.default)({key:t.id,onChange:e.handleFavlistItemChange,checked:n[t.id]},t,{ref:function(n){e.items[t.id]=n}}))})),!o.length&&r||Object(u.b)("div",{className:"Favlists-actions"},Object(u.b)(h.c,{className:"Favlists-addButton",onClick:s,preset:"primary",color:"blue"},"创建收藏夹")))}}]),t}(p.Component);E.propTypes={isFecthing:m.a.bool,relations:m.a.object,onUpdate:m.a.func.isRequired,onAdd:m.a.func.isRequired,onLoad:m.a.func.isRequired,items:m.a.array.isRequired,isDrained:m.a.bool,authRequired:m.a.func};var x=E,A=n(2343),T=n(2344),L=(n(2909),n(2910),{list:{title:"添加收藏",tips:function(e){return e?"请选择你想添加的收藏夹":"你可以创建多个收藏夹，将答案分类收藏"}},add:{title:"创建新收藏夹"}}),M=function(e){function t(){var e,n;Object(r.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(s.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={status:n.props.defaultStatus},n.handleCloseModal=function(){n.props.onClose&&n.props.onClose(),n.setState({status:"list"})},n.handleUpdate=function(e,t){var a=n.props,o=a.onUpdateFav,r=a.id,i=a.type,s=a.items,c=a.authRequired,l=a.isUserActive,u=s.find(function(t){return t.id===e})||{},d=[e,r,i,u.isPublic];return!t&&O(u.isPublic,l,c)?c(o).apply(void 0,d):o.apply(void 0,d)},n.handleAdd=function(){return n.setState({status:"add"})},n.handleBack=function(){return n.setState({status:"list"})},n}return Object(l.a)(t,e),Object(i.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.shown,a=t.items,o=t.id,r=t.type,i=t.onFetchRelations,s=e.items,c=e.relations;if(i&&(s.length!==a.length&&e.shown||s.length&&!n&&e.shown)){var l=(c?s.filter(function(e){return!{}.hasOwnProperty.call(c,e.id)}):s).map(function(e){return e.id});l.length&&i(o,r,l)}s.length>a.length&&this.setState({status:"list"})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.id,a=t.type,o=t.shown,r=t.zaEnabled;o&&!e.shown&&this.container&&r&&b.default.setModule(this.container,{module:"CollectionDialogue"},{card:{card_type:"Content",content:{type:Object(T.a)(a),token:String(n)}}})}},{key:"render",value:function(){var e,t=this,n=this.state.status,r=L[n],i=r.title,s=r.tips,c=this.props,l=c.shown,d=c.defaultStatus,m=c.relations,p=c.onFavlistAdd,b=c.onLoad,g=c.isFetching,y=c.isDrained,C=c.items,O=c.zaEnabled,j=c.authRequired,k=c.isUserActive,w=Object(o.a)(c,["shown","defaultStatus","relations","onFavlistAdd","onLoad","isFetching","isDrained","items","zaEnabled","authRequired","isUserActive"]),S=!(y&&!C.length),I=Object(A.a)(w,Object.keys(v.b.propTypes)).selectedProps;return e="list"===n?S?Object(u.b)(x,{ref:function(e){t.container=e},items:C,isFetching:g,isDrained:y,relations:m,onAdd:this.handleAdd,onUpdate:this.handleUpdate,onLoad:b,zaEnabled:O}):Object(u.b)(f.a,null,Object(u.b)(h.c,{preset:"primary",color:"blue",onClick:this.handleAdd},"创建收藏夹"),Object(u.b)(h.c,{onClick:this.handleCloseModal},"取消")):Object(u.b)(N,{onSubmit:p,isActive:k,onBack:"add"===d?this.handleCloseModal:this.handleBack,authRequired:j}),Object(u.b)(v.b,Object(a.default)({},I,{onClose:this.handleCloseModal,title:i,subtitle:s&&s(S),buttonGroupOnly:!S,className:"FavlistsModal",size:"large"}),l&&e)}}]),t}(p.Component);M.propTypes={id:m.a.oneOfType([m.a.string,m.a.number]),type:m.a.oneOf(["answer","article","pin"]),relations:m.a.object,onUpdateFav:m.a.func.isRequired,onFavlistAdd:m.a.func.isRequired,onFetchRelations:m.a.func,onClose:m.a.func.isRequired,shown:m.a.bool,zaEnabled:m.a.bool,authRequired:m.a.func,isUserActive:m.a.number},M.defaultProps={defaultStatus:"list",relations:{},authRequired:function(e){return e}};var _=M;n.d(t,"FavlistsModal",function(){return _})},3006:function(e,t,n){"use strict";n.r(t);var a=n(22),o=n(24),r=n(4),i=n(5),s=n(8),c=n(6),l=n(7),u=n(0),d=n(1),m=n.n(d),p=n(2),h=n.n(p),f=n(18),b=n(11),v=n.n(b),g=n(527),y=n(2905),C=n.n(y),O=n(87),j=n(2182),k=n(63),w=n(23),N=n(64),S=n(491),I=n(27),P=n(74),R=n(279),E=n(1955),x=n(2341),A=n(2251),T=n(2342),L=n(1958),M=n(3),_=n(15),D=(n(2906),5),F=2,B=function(e){function t(){var e,n;Object(r.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(s.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={},n.handleClick=function(){var e=n.props,t=e.loadRestComments,a=e.onShowConversation,o=e.comment,r=o.id,i=o.childCommentCount,s=i<=D&&i>F;(s?t:a)({commentId:r}),s&&n.setState(Object(M.a)({},"hide_".concat(r),!0))},n.handleRef=function(e){var t=n.props.onRef;"function"==typeof t&&t(e)},n}return Object(l.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.comment,n=t.id,a=t.childCommentCount,o=e.isFetching,r=e.className,i=this.state["hide_".concat(n)],s=a<=D&&a>F?"展开其他 ".concat(a-F," 条回复"):"查看全部 ".concat(a," 条回复");return Object(u.b)("div",{className:r,ref:this.handleRef},!i&&Object(u.b)("div",{className:"CommentMoreReplyButton"},Object(u.b)(_.c,{preset:"plain",onClick:this.handleClick},s)),o&&Object(u.b)(O.a,{className:"CommentMoreReplyButton",small:!0}))}}]),t}(d.Component);B.propTypes={comment:h.a.object.isRequired,isFetching:h.a.bool,onShowConversation:h.a.func,loadRestComments:h.a.func};n(2907);var z,V=Object(f.connect)(null,{loadConversation:g.g})(z=function(e){function t(){var e,n;Object(r.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(s.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).loadRestComments=function(e){var t=e.commentId;(0,n.props.loadConversation)({id:t,isLoadRest:!0})},n}return Object(l.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.parent,n=t.type,a=t.author,o=(a=void 0===a?{isOrg:!1}:a).isOrg,r=e.parent,i=e.commentNeedsReview,s=e.onShowConversation,c=e.status,l=e.onItemLike,m=e.onItemDelete,p=e.onItemCollapse,h=e.onItemDislike,f=e.onItemApprove,b=e.onItemReject,g=e.canOperateItem,y=e.commentPattern,C=e.conversation,O=void 0===C?{}:C,j=e.entities,k=e.byComment,w=e.isReverseAndStatusOpen,N=e.comment,S=e.onReply,I=e.onFeature,P=e.ids,R=e.showCollapsed,E=N.id,x=N.featured,A=N.childComments,T=void 0===A?[]:A,M=N.childCommentCount,_=void 0===M?0:M,D=x?"".concat(E,"_featured"):"".concat(E),F=!x&&P.includes("".concat(E,"_featured")),z=Boolean(T.length)&&!w,V=_<=5&&_>2,U=T.map(function(e){return j.comments[e]}),q=!x&&_>2&&!w,W=(V&&O[E]||{isFetching:!1}).isFetching;return Object(u.b)(d.Fragment,null,Object(u.b)("li",{className:v()({"NestComment--rootCommentNoChild":!z,"NestComment--rootComment":z}),key:D},Object(u.b)(L.a,{key:D,comment:N,status:c,type:n,parent:r,canOperate:g,commentNeedsReview:i,onShowConversation:s,ownerAuthorIsOrg:o,onLike:l,onReply:S,onFeature:I,onDelete:m,onCollapse:p,onDislike:h,onApprove:f,onReject:b,commentPattern:y,rootCommentId:E,byComment:k,isReverseAndStatusOpen:w,hasRecommend:F,showCollapsed:R})),z&&U.map(function(e){var t=e.id,a=e.featured,d=a?"".concat(t,"_featured"):"".concat(t),v=!a&&P.includes("".concat(t,"_featured"));return Object(u.b)("li",{className:"NestComment--child",key:d},Object(u.b)(L.a,{key:d,comment:e,status:c,type:n,parent:r,canOperate:g,commentNeedsReview:i,onShowConversation:s,ownerAuthorIsOrg:o,onLike:l,onReply:S,onFeature:I,onDelete:m,onCollapse:p,onDislike:h,onApprove:f,onReject:b,commentPattern:y,rootCommentId:E,hasRecommend:v,showCollapsed:R}))}),q&&Object(u.b)(B,{comment:N,isFetching:W,onShowConversation:s,loadRestComments:this.loadRestComments}))}}]),t}(d.Component))||z;function U(e){var t=e.id,n=e.replyTo,a=e.isConversation;if(e.isNotification)return{type:"notification"};if(a)return{type:"conversation"};if(!n)return{type:"comment"};var o=n.featured,r=n.replyToAuthor,i=n.id;return t===i&&o?r?{type:"replyToSubFeatured"}:{type:"replyToFeatured"}:t!==i||r?t!==i&&r?{type:"replyToSubCommon"}:{type:"comment"}:{type:"replyToCommon"}}n(2908);var q,W,H,K=Object(f.connect)(function(e,t){var n=t.parent,a=t.parent,o=a.type,r=a.id,i=t.status,s=t.order,c=t.byComment,l=t.commentPattern,u=t.notificationId,d=e.entities,m=e.commentsV2,p=e.commentsV2,h=p.conversation,f=p.stickers,b=void 0===f?[]:f,v=p.commentWithPicPermission,g=p.notificationsComments,y="".concat(o,"_").concat(r),O=m.parent,j=d.comments[c],k=m.pagination;"reviewing"===i&&(k=m.reviewing);var w="reverse"===s&&"open"===i;w&&(k=m.reverse);var N=[],S=m.collapsed[y]||{};S.ids&&S.ids.length>0&&(N=S.ids.map(function(e){return d.comments[e]}));u&&(k=g,y=u);var R=k[y]||{isPrevDrained:!1,isFetching:!1,isDrained:!1,ids:[]},E=R.isFetching,x=R.isPrevDrained,A=R.isDrained,T=R.ids,L=R.newIds,M=void 0===L?[]:L,_=R.totals,D="bottom"!==l?T:M,F=D.map(function(e){return d.comments[e]}),B=C()(D,function(e){return String(e).includes("_featured")});return{currentUser:Object(I.c)(e),isFetching:E,isPrevDrained:x,isDrained:A,totals:u?F.length:_,collapsedInfo:S,collapsedComments:N,targetComment:j,conversation:h,entities:d,stickers:b,lastFeaturedIndex:B,comments:F,isReverseAndStatusOpen:w,commentWithPicPermission:v,ids:D,parent:Object.assign({},n,{},O[y]),permission:Object(P.R)(e)}},{loadComments:g.f,loadConversation:g.g,addComment:g.a,loadStickers:g.j,clearNotification:w.e,getCommentWithPicPermission:g.e,loadNotificationComments:g.i,loadAnswerCommentPermission:N.n,loadArticleCommentPermission:S.b})((H=W=function(e){function t(){var e,n;Object(r.a)(this,t);for(var o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];return(n=Object(s.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).state={collapsed:!0,current:1},n.commentsWithPaginationElRef=m.a.createRef(),n.load=function(e,t,a){if(!n.props.isFetching&&!n.props.parent.adminClosedComment){var o=e||n.props,r=o.order,i=o.status,s=o.parent,c=s.id,l=s.type,u=o.commentPattern,d=o.needLoadCommentPermission,m=o.loadComments,p=o.notificationId,h=o.loadNotificationComments;if(p)return h(p);if(d&&n.loadCommentPermission(l,c),a){m(l,c,{order:r,isPrevious:t,status:"collapsed",commentPattern:u},!0)}else m(l,c,{order:r,isPrevious:t,status:i,commentPattern:u})}},n.addComment=function(e,t,a){var o=a.rootCommentId,r=a.isConversation,i=n.props,s=i.parent,c=s.id,l=s.type,u=i.commentId,d=i.addComment,m=i.notificationId;return d({parentType:l,parentId:c,content:e,replyTo:t,conversationId:u,rootCommentId:o,isConversation:r,notificationId:m,replyType:U({id:o,replyTo:t,isConversation:r,isNotification:Boolean(m)}).type})},n.featureItem=function(e){(0,n.props.onItemFeature)(e,n.lastFeaturedIndex)},n.handleOpenCollapsed=function(){n.setState({collapsed:!1}),n.load(n.props,!1,!0)},n.handlePageSelect=function(e){var t=n.props.onPaginationClick,a=n.state.current;t&&t(a,e),n.commentsElement.scrollIntoView(),n.setState({current:e}),n.loadByPagination(e)},n.loadByPagination=function(e,t){var a=t||n.props,o=a.order,r=a.status,i=a.parent,s=i.id,c=i.type,l=a.commentPattern,u=a.needLoadCommentPermission,d=a.loadComments;u&&n.loadCommentPermission(c,s),d(c,s,{order:o,isPrevious:!1,status:r,commentPattern:l,current:e})},n.renderComment=function(e){var t=e.id,o=e.featured?"".concat(t,"_featured"):t,r=!n.state.collapsed;return Object(u.b)("ul",{className:"NestComment",key:o},Object(u.b)(V,Object(a.default)({comment:e,onReply:n.addComment,onFeature:n.featureItem,showCollapsed:r},n.props)))},n.renderNormalComments=function(e){var t=n.state.collapsed,a=n.props,o=a.byComment,r=a.lastFeaturedIndex,i=a.parent,s=i.featuredCounts,c=i.commonCounts,l=[],d=s>0;return n.lastFeaturedIndex=0,e.length>0&&e.forEach(function(a,i){if(o||!a.collapsed){var m=e[i-1];a.collapsed&&(m&&m.collapsed||l.push(n.renderCollapsedDivider()),t)||(i===r&&l.push(Object(u.b)("div",{className:"NestComment-nextSiblings--noBorder",key:"NestComment-nextSiblings--noBorder"})),d&&0===i&&-1!==r&&l.push(Object(u.b)("div",{className:"CommentListV2-header-divider",key:"divider-featured"},"精选评论（",s,"）")),l.push(n.renderComment(a)),i===r&&(n.lastFeaturedIndex=i,l.push(Object(u.b)("div",{className:"CommentListV2-header-divider",key:"divider-comment"},"评论（",c,"）"))))}}),l},n.renderCollapsedComments=function(){var e=n.props,t=e.collapsedComments,a=e.isDrained,o=e.parent,r=(o=void 0===o?{}:o).collapsedCounts;return!a||r<=0?[]:t.map(function(e){return n.renderComment(e)})},n.renderComments=function(e){return e.map(n.renderComment)},n.renderCollapsedDivider=function(){var e=n.props,t=e.isDrained,a=e.parent.collapsedCounts;return!t||a<=0?[]:n.state.collapsed?Object(u.b)("div",{className:"CommentListV2-action",key:"collapsed"},Object(u.b)("div",{className:"CommentListV2-expendCollapseButton"},Object(u.b)("span",{onClick:n.handleOpenCollapsed},Object(k.formatNumber)(a)," 条评论被折叠"),"（",Object(u.b)("a",{href:"//www.zhihu.com/question/52029856/answer/128623557",target:"_blank",rel:"noopener noreferrer"},"为什么？"),"）")):Object(u.b)("div",{className:"CommentListV2-divider",key:"divider-collapsed"},Object(u.b)("div",{className:"CommentListV2-dividerLine"}),Object(u.b)("div",{className:"CommentListV2-dividerText"},Object(k.formatNumber)(a)," 条评论被折叠（",Object(u.b)("a",{href:"//www.zhihu.com/question/52029856/answer/128623557",target:"_blank",rel:"noopener noreferrer"},"为什么？"),"）"))},n.renderCollapsedInfiLoader=function(){var e=n.state.collapsed;if(e)return[];var t=n.props.collapsedInfo,a=(t=void 0===t?{}:t).isFetching,o=t.isPrevDrained,r=t.isDrained;return Object(u.b)(O.b,{className:"CommentListV2",onRef:function(e){n.listEl=e},isLocal:!0,isLoading:a,isPrevDrained:o,isDrained:r,onLoad:function(t){return n.load(n.props,t,!e)},placeholder:Object(u.b)(O.a,{className:"CommentItem",small:!0})},n.renderCollapsedComments())},n.renderPatternContent=function(e){var t=n.props,a=t.isFetching,o=t.parent.adminClosedComment,r=t.byComment,i=t.status,s=t.order,c=t.totals,l=t.showPackupButton,d=t.handlePackupButton,m=Math.ceil(c/20),p=n.state.current;return o?null:a?Object(u.b)(x.a,null):Object(u.b)("div",{ref:n.commentsWithPaginationElRef},Object(u.b)("div",{className:"CommentListV2"},"normal"===s&&"open"===i?n.renderNormalComments(e):n.renderComments(e)),m>1&&Object(u.b)(j.a,{className:"CommentsV2-pagination",current:p,total:m,onSelect:n.handlePageSelect}),!r&&n.renderCollapsedDivider(),!r&&n.renderCollapsedInfiLoader(),l&&Object(u.b)(T.a,{onClick:d,commentsElRef:n.commentsWithPaginationElRef}))},n.renderModalContent=function(e){var t=n.props,o=t.collapsedInfo,r=t.parent.adminClosedComment,i=t.status,s=t.order,c=t.byComment,l=n.state.collapsed,d=l?n.props:o,m=d.isFetching,p=d.isDrained,h=d.isPrevDrained;if(p&&e.length<=0||r)return Object(u.b)("div",{className:"CommentsV2-empty"},Object(u.b)(R.a,{entityType:"comments"}));return Object(u.b)(O.b,Object(a.default)({className:"CommentListV2",onRef:function(e){n.listEl=e},isLocal:!0,isLoading:m,isPrevDrained:h,isDrained:p,onLoad:function(e){return n.load(n.props,e,!l)},placeholder:Object(u.b)(O.a,{className:"CommentItemV2",small:!0})},{getContainer:function(e){return e}}),"normal"===s&&"open"===i?n.renderNormalComments(e):n.renderComments(e),!c&&n.renderCollapsedDivider(),!c&&n.renderCollapsedComments())},n.renderCommentEdit=function(){var e=n.props,t=e.parent,a=t.canComment,o=(a=void 0===a?{status:!0}:a).status,r=a.reason,i=t.author,s=(i=void 0===i?{isOrg:!1}:i).isOrg,c=t.type,l=t.id,d=t.adminClosedComment,m=t.questionType,p=e.byComment,h=e.autoFocus,f=e.commentNeedsReview,b=e.zaInfo,g=d?"当前内容暂时无法评论":r,y=h&&!p;return o&&!d?Object(u.b)(E.a,{className:"CommentsV2-footer",type:c,id:l,commentNeedsReview:f,onSubmit:n.addComment,autoFocus:y,ownerAuthorIsOrg:s,ownerAuthorIsBrand:"commercial"===m,zaInfo:b}):Object(u.b)("div",{className:v()("CommentsV2-disabledText")},Object(u.b)("div",{className:"CommentsV2-disabledReason"},g))},n}return Object(l.a)(t,e),Object(i.a)(t,[{key:"loadCommentPermission",value:function(e,t){var n=this.props,a=n.loadAnswerCommentPermission,o=n.loadArticleCommentPermission;switch(e){case"answer":return a(t);case"article":return o(t);default:return null}}},{key:"componentDidMount",value:function(){var e=this.props,t=e.commentPattern,n=e.parent.adminClosedComment,a=e.stickers,o=e.loadStickers,r=e.getCommentWithPicPermission,i=e.commentWithPicPermission,s=e.currentUser,c=this.state.current;"bottom"!==t||n||this.loadByPagination(c),!a.length&&o(),void 0===i.commentWithPic&&s&&r()}},{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.order,a=t.status,o=t.targetComment,r=t.commentPattern;n===e.order&&a===e.status||("bottom"===r?(this.setState({current:1}),this.loadByPagination(1,e)):this.load(e),this.setState({collapsed:!0}));var i=e.targetComment;i!==o&&i&&this.setState({collapsed:i.collapsed})}},{key:"componentWillUnmount",value:function(){Object(w.e)(w.b)}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,o=t.comments,r=t.commentPattern,i=t.commentInputPosition,s=t.isAuthor,c=t.parent,l=c.author,d=(l=void 0===l?{isOrg:!1}:l).isOrg,m=c.commentPermission,p=c.reviewingCounts,h=c.commentCount,f=c.adminClosedComment,b=t.totals,g=t.status,y=t.order,C=t.onStatusChange,O=t.onOrderChange,j=t.targetLink,k=t.shouldReverse,w=t.permission.canBrandAdminEdit,N="censor"===m&&(s||w),S=N?{isCommentReviewer:N,onStatusChange:C,status:g,reviewingCounts:p}:{status:g};return Object(u.b)("div",{className:v()("CommentsV2 CommentsV2--withEditor",{"CommentsV2-withPagination":"bottom"===r},n),ref:function(t){e.commentsElement=t}},Object(u.b)(A.a,Object(a.default)({commentCount:void 0!==h?h:b,shouldReverse:k,commentClosed:f,targetLink:j,order:y,onOrderChange:O,commentPattern:r,isOrg:d},S)),"top"===i&&this.renderCommentEdit(),"bottom"===r?this.renderPatternContent(o):this.renderModalContent(o),"bottom"===i&&this.renderCommentEdit())}}]),t}(d.Component),W.propTypes={type:h.a.string,parent:h.a.object.isRequired,targetLink:h.a.node,commentNeedsReview:h.a.bool,byComment:h.a.oneOfType([h.a.number,h.a.string]),commentPattern:h.a.string,commentInputPosition:h.a.oneOf(["top","bottom"]),showPackupButton:h.a.bool,handlePackupButton:h.a.func,onPaginationClick:h.a.func,autoFocus:h.a.bool,shouldReverse:h.a.bool},W.contextTypes={authRequired:h.a.func.isRequired},W.defaultProps={commentInputPosition:"bottom",showPackupButton:!0,autoFocus:!0,shouldReverse:!0},q=H))||q;var G,Q,Y,$=n(30),J=n(9),Z=n(96),X=n.n(Z),ee=n(243),te=n.n(ee),ne=n(196),ae=n(1783),oe=Object(f.connect)(function(e,t){var n=t.conversationId,a=t.isAnchorComments,o=e.entities.comments,r=e.commentsV2,i=r.conversation,s=r.conversationMore,c=i[n]||{isFetching:!1,isDrained:!1,isPrevDrained:!1,ids:[]},l=c.isFetching,u=c.isDrained,d=c.isPrevDrained,m=c.ids,p=c.totals,h=c.topComments,f=(h=void 0===h?{}:h).paging,b=(f||{}).isEnd,v=s[n]||{isFetching:!1,isDrained:!1,ids:[]},g=v.isFetching,y=v.isDrained,C=v.ids,O=C.map(function(e){return o[e]}),j=m.map(function(e){return o[e]}),k=o["".concat(n,"_featured")]||o[n]||{},w=a?te()(C.length?[].concat(Object(J.a)(j.slice(0,4)),Object(J.a)(O),Object(J.a)(j.slice(4))):j,"id"):[k].concat(Object(J.a)(j)),N=f?[].concat(Object(J.a)(j.slice(0,3)),Object(J.a)(O)).length:-1;return{isFetching:l,isDrained:u,isPrevDrained:d,totals:p,comments:w,openComment:k,topCommentsPaging:f,isConversationMoreFetching:g,isConversationMoreDrained:b||y,offsetIndex:N}},{loadConversation:g.g,addComment:g.a,loadMoreAnchorComments:g.h})((Y=Q=function(e){function t(){var e,n;Object(r.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(s.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).load=function(){var e=n.props,t=e.isAnchorComments,a=e.conversationId;(0,e.loadConversation)({id:a,isAnchorComments:t})},n.addComment=function(e,t,a){var o=a.rootCommentId,r=a.isConversation,i=n.props,s=i.parent,c=s.type,l=s.id,u=i.conversationId,d=i.addComment,m=i.isAnchorComments;return d({parentType:c,parentId:l,content:e,replyTo:t,conversationId:u,rootCommentId:o,isConversation:r,replyType:U({id:o,replyTo:t,isConversation:r}).type,isAnchorComments:m})},n.loadMoreAnchorComments=function(){var e=n.props,t=e.conversationId,a=e.topCommentsPaging,o=void 0===a?{}:a;(0,e.loadMoreAnchorComments)({conversationId:t,nextUrl:o.next})},n.createOnRef=X()(function(e){return function(t){var a=n.props.byComment;parseInt(e)===Number(a)&&(n.targetCommentEl=t)}}),n.scrollToTarget=function(){var e=Object($.default)(n),t=e.targetCommentEl,a=e.listEl;if(a&&t){var o=t.getBoundingClientRect(),r=o.top,i=o.height,s=a.getBoundingClientRect(),c=s.top,l=s.height;n.listEl.scrollTop+=r-c-(l-i)/2,t.classList.add("CommentItemV2--highlighted"),setTimeout(function(){return t.classList.remove("CommentItemV2--highlighted")},2e3),t.tabIndex=-1,t.focus()}},n}return Object(l.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.props.byComment&&this.scrollToTarget()}},{key:"componentDidUpdate",value:function(e){!e.comments.length&&this.props.comments.length&&this.props.byComment&&this.scrollToTarget()}},{key:"render",value:function(){var e=this,t=this.props,n=t.onItemLike,a=t.onItemDelete,o=t.onItemFeature,r=t.onItemApprove,i=t.onItemCollapse,s=t.onItemDislike,c=t.onNavBack,l=t.canOperateItem,m=t.isFetching,p=t.comments,h=void 0===p?[]:p,f=t.commentNeedsReview,b=t.openComment.collapsed,v=t.parent,g=t.commentPattern,y=t.totals,C=t.isDrained,j=t.isPrevDrained,k=t.isConversationMoreFetching,w=t.isConversationMoreDrained,N=t.offsetIndex,S=null;return m&&!h.length?S=Object(u.b)(d.Fragment,null,Object(u.b)(O.a,{className:"CommentItemV2",small:!0}),Object(u.b)("div",{className:"CommentsV2-openComment-divider"}),Object(u.b)("div",{className:"CommentsV2-replyNum"},"".concat(y," 条回复"))):h.length&&(S=h.map(function(t,c){return c?w||c!==N||k?k&&c===N?Object(u.b)(d.Fragment,{key:t.id},Object(u.b)(L.a,{key:t.id,onRef:e.createOnRef(t.id),isConversation:!0,commentNeedsReview:f,canOperate:l,parent:v,comment:t,onLike:n,onDelete:a,onFeature:o,onApprove:r,onCollapse:i,onDislike:s,collapsedShown:b,onReply:e.addComment}),Object(u.b)(O.a,{key:"NestCoomment-moreCommentButton-PlaceHolder",className:"NestCoomment-moreCommentButton ",small:!0})):Object(u.b)(L.a,{key:t.id,onRef:e.createOnRef(t.id),isConversation:!0,commentNeedsReview:f,canOperate:l,parent:v,comment:t,onLike:n,onDelete:a,onFeature:o,onApprove:r,onCollapse:i,onDislike:s,collapsedShown:b,onReply:e.addComment}):Object(u.b)(d.Fragment,{key:t.id},Object(u.b)(L.a,{key:t.id,onRef:e.createOnRef(t.id),isConversation:!0,commentNeedsReview:f,canOperate:l,parent:v,comment:t,onLike:n,onDelete:a,onFeature:o,onApprove:r,onCollapse:i,onDislike:s,collapsedShown:b,onReply:e.addComment}),Object(u.b)("div",{key:"NestCoomment-moreCommentButton",preset:"plain",className:"NestCoomment-moreCommentButton",onClick:e.loadMoreAnchorComments},Object(u.b)(ae.a,null),Object(u.b)("p",null,"点击查看更多回复"))):Object(u.b)(d.Fragment,{key:t.id},Object(u.b)("div",{className:"CommentsV2-openComment"},Object(u.b)(L.a,{key:t.id,onRef:e.createOnRef(t.id),isConversation:!0,commentNeedsReview:f,canOperate:l,parent:v,comment:t,onLike:n,onDelete:a,onFeature:o,onApprove:r,onCollapse:i,onDislike:s,collapsedShown:b,onReply:e.addComment})),Object(u.b)("div",{className:"CommentsV2-openComment-divider"}),Object(u.b)("div",{key:"".concat(t.id,"-title")},Object(u.b)("div",{className:"CommentsV2-replyNum"},"".concat(y," 条回复"))))})),"bottom"===g?Object(u.b)(ne.b,{size:"fullPage",onClose:c},Object(u.b)("div",{className:"CommentsV2"},Object(u.b)(A.a,{isConversation:!0,commentPattern:g}),Object(u.b)(O.b,{className:"CommentListV2",onRef:function(t){e.listEl=t},isLocal:!0,isLoading:m,isDrained:C,isPrevDrained:j,onLoad:this.load,placeholder:Object(u.b)(O.a,{className:"CommentItemV2",small:!0}),getContainer:function(e){return e}},S))):Object(u.b)("div",{className:"CommentsV2"},Object(u.b)(A.a,{isConversation:!0,onNavBack:c}),Object(u.b)(O.b,{className:"CommentListV2",onRef:function(t){e.listEl=t},isLocal:!0,isLoading:m,isDrained:C,isPrevDrained:j,onLoad:this.load,placeholder:Object(u.b)(O.a,{className:"CommentItemV2",small:!0}),getContainer:function(e){return e}},S))}}]),t}(d.Component),Q.propTypes={conversationId:h.a.number.isRequired,type:h.a.string,parent:h.a.object.isRequired,commentNeedsReview:h.a.bool},Q.contextTypes={currentUser:h.a.object,authRequired:h.a.func.isRequired},G=Y))||G;var re,ie,se,ce=n(150);n.d(t,"default",function(){return le});var le=Object(f.connect)(null,{updateCommentLikeStatus:g.o,updateCommentFeatureStatus:g.n,deleteComment:g.d,updateCommentCollapsed:g.l,updateCommentDisliked:g.m,approveComment:g.b,rejectComment:g.k})(re=Object(ce.a)(null)((se=ie=function(e){function t(){var e,n;Object(r.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(s.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={openedCommentId:null,isAnchorComments:!1,status:"open",order:"normal"},n.showConversation=function(e){var t=e.commentId,a=e.isAnchorComments;n.setState({openedCommentId:t,isAnchorComments:a})},n.showComments=function(){n.setState({openedCommentId:null,isAnchorComments:!1})},n.delete=function(e){var t=n.props,a=t.parent;return(0,t.deleteComment)(e,a.type,a.id)},n.feature=function(e){var t=n.props,a=t.parent,o=t.updateCommentFeatureStatus,r=t.notificationId;o({id:n.state.openedCommentId,commentId:e,parentId:a.id,parentType:a.type,notificationId:r})},n.like=function(e,t){var a=n.props,o=a.onItemLike,r=a.updateCommentLikeStatus;o&&o(e,t),r(e)},n.collapse=function(e){var t=n.props,a=t.parent;(0,t.updateCommentCollapsed)(e,a.type,a.id)},n.dislike=function(e){(0,n.props.updateCommentDisliked)(e)},n.approve=function(e){var t=n.props,a=t.parent,o=t.type;(0,t.approveComment)(e,a.type||o,a.id)},n.reject=function(e){var t=n.props,a=t.parent,o=t.type;(0,t.rejectComment)(e,a.type||o,a.id)},n.handleStatusChange=function(e){n.setState({status:e})},n.handleOrderChange=function(e,t){var a=n.props.onOrderChange;a&&a(e,t),n.setState({order:e})},n}return Object(l.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.onMount;e&&e(this.commentsContainerNode)}},{key:"render",value:function(){var e=this,t=this.props,n=t.parent,r=t.commentPattern,i=t.type,s=t.parent,c=(s=void 0===s?{}:s).commentPermission,l=s.relationship,d=void 0===l?{}:l,m=s.author,p=void 0===m?{}:m,h=t.needLoadCommentPermission,f=t.byComment,b=Object(o.a)(t,["parent","commentPattern","type","parent","needLoadCommentPermission","byComment"]),g=this.context.currentUser,y=void 0===d.isAuthor?g&&p.urlToken&&g.urlToken===p.urlToken:d.isAuthor,C="censor"===c&&!y,O="answer"===i||"article"===i,j=this.state,k=j.openedCommentId,w=j.status,N=j.order,S=j.isAnchorComments,I=S&&(k||f)||f;return Object(u.b)("div",{className:"Comments-container",ref:function(t){return e.commentsContainerNode=t}},Object(u.b)(K,Object(a.default)({className:v()({"CommentsV2--hidden":k&&"bottom"!==r})},b,{type:i,order:N,status:w,parent:n,commentPattern:r,commentNeedsReview:C,canOperateItem:O,onShowConversation:this.showConversation,onItemLike:this.like,onItemFeature:this.feature,onItemDelete:this.delete,onItemCollapse:this.collapse,onItemDislike:this.dislike,onItemApprove:this.approve,onItemReject:this.reject,byComment:I,onStatusChange:this.handleStatusChange,onOrderChange:this.handleOrderChange,needLoadCommentPermission:h,isAuthor:y})),k&&Object(u.b)(oe,Object(a.default)({},b,{parent:n,type:i,canOperateItem:O,onItemLike:this.like,onItemFeature:this.feature,onItemDelete:this.delete,onItemCollapse:this.collapse,onItemDislike:this.dislike,onItemApprove:this.approve,onItemReject:this.reject,commentPattern:r,conversationId:k,onNavBack:this.showComments,byComment:I,isAnchorComments:S,commentNeedsReview:C,onShowConversation:this.showConversation})))}}]),t}(d.Component),ie.propTypes={type:h.a.string.isRequired,parent:h.a.object.isRequired,onOrderChange:h.a.func,onItemLike:h.a.func,isAuthor:h.a.bool,onMount:h.a.func},ie.defaultProps={type:"answer"},ie.contextTypes={currentUser:h.a.object,authRequired:h.a.func.isRequired},re=se))||re)||re},3007:function(e,t,n){"use strict";n.r(t);var a,o,r,i,s=n(22),c=n(24),l=n(4),u=n(5),d=n(8),m=n(6),p=n(7),h=n(0),f=n(2),b=n.n(f),v=n(1),g=n.n(v),y=n(18),C=n(11),O=n.n(C),j=n(511),k=n(16),w=n(96),N=n.n(w),S=n(2133),I=n(116),P=n(87),R=n(2182),E=n(15),x=n(63),A=n(485),T=n(23),L=n(64),M=n(491),_=n(279),D=n(481),F=n(9),B=n(30),z=n(26),V=n(821),U=n.n(V),q=n(35),W=n.n(q),H=n(196),K=n(168),G=n(496),Q=n(55);n(2898);function Y(){var e=Object(D.a)(["回复","",""]);return Y=function(){return e},e}var $="zhihu::comment_local_key",J=5,Z=function(){return""},X=(a=Object(y.connect)(function(e){return{shouldOia:Object(Q.f)(e)}}),Object(z.withRouter)(o=a((i=r=function(e){function t(e,n){var a;return Object(l.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e,n))).initLocalComment=function(){var e=a.props,t=e.type,n=e.id;if(t&&n){var o=W.a.get($)||[],r="".concat(t,"_").concat(n),i=o.find(function(e){return e.key===r}),s=i&&i.value;s&&a.setState({value:{toHTML:function(){return s}},disabled:!1})}},a.saveLocalComment=function(e){var t=a.props,n=t.type,o=t.id;if(n&&o){var r=e?e.toHTML():a.state.value.toHTML(),i="".concat(n,"_").concat(o),s=(W.a.get($)||[]).filter(function(e){return e.key!==i}),c=r?[].concat(Object(F.a)(s.slice(0,J-1)),[{key:i,value:r}]):s;W.a.set($,c)}},a.handleChange=function(e){a.setState({value:e,disabled:e.isEmpty})},a.handleCommentShow=a.context.authRequired(function(){a.setState({shown:!0}),a.hiddenInput.focus()}),a.handleCommentHide=function(){a.setState({shown:!1})},a.handleMobileComment=function(){a.onSubmit(),a.handleCommentHide()},a.focusInput=function(e){e.preventDefault(),a.input.focus()},a.onChange=a.handleChange.bind(Object(B.default)(a)),a.onFocus=a.handleFocus.bind(Object(B.default)(a)),a.onBlur=a.handleBlur.bind(Object(B.default)(a)),a.onSubmit=a.context.authRequired(a.handleSubmit.bind(Object(B.default)(a)),void 0,T.b),a.state={active:e.defaultActive,disabled:!0,shown:!1,value:{toHTML:Z}},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.initLocalComment()}},{key:"componentWillUnmount",value:function(){this.saveLocalComment()}},{key:"handleFocus",value:function(){this.setState({active:!0})}},{key:"handleBlur",value:function(){var e=this;setTimeout(function(){return e.setState({active:!1})},100)}},{key:"handleSubmit",value:function(){var e=this,t=this.props,n=t.replyTo,a=t.onSubmit,o=t.onCancel,r=this.input.toHTML();if(r&&a){this.saveLocalComment();var i=a(r,n);i.then?i.then(function(){o&&o(),e.input?(e.input.reset(),e.setState({value:{toHTML:Z}},function(){return e.saveLocalComment()})):e.saveLocalComment({toHTML:Z})}):(o&&o(),this.input.reset()),k.default.trackEvent(this,{action:"Comment",element:"Button"})}}},{key:"renderInput",value:function(e){var t=this,n=e.placeholder,a=e.className,o=this.props.autoFocus;return Object(h.b)(g.a.Fragment,null,Object(h.b)(K.c,{keyMap:{FOCUS_COMMENT_INPUT:"shift+c"},handlers:{FOCUS_COMMENT_INPUT:this.focusInput}}),Object(h.b)(G.a,{className:O()("CommentEditor-input",a),defaultValue:this.state.value.toHTML(),richtext:!0,large:!0,spread:!0,allowMention:!0,allowPasteRichText:!1,autoFocus:Boolean(!1)||o,outputBlockType:"div",onRef:function(e){t.input=e},placeholder:n,onFocus:this.onFocus,onBlur:this.onBlur,onChange:this.onChange,onSubmit:this.onSubmit,minRows:5}))}},{key:"render",value:function(){var e=this.props,t=e.replyTo,n=e.commentNeedsReview,a=e.className,o=(e.onClick,e.onCancel),r=e.ownerAuthorIsOrg,i=e.ownerAuthorIsBrand,c=(e.type,e.id,e.shouldOia,e.preset,this.state),l=c.active,u=c.disabled,d=r?"机构":"作者";if(t){var m=U()(Y(),t.author.member.name,n?"，评论由".concat(d,"筛选后公开"):"");return Object(h.b)("div",{className:O()(a,"CommentEditor--inCommentItem",{"CommentEditor--active":l||!u})},this.renderInput({placeholder:m}),Object(h.b)("div",{className:"CommentEditor-actions"},Object(h.b)(E.c,{preset:"plain",onClick:o},"取消"),Object(h.b)(E.c,{preset:"primary",color:"blue",onClick:this.onSubmit,disabled:u},"评论")))}var p="写下你的评论...";n&&(p=i?"已开启预审评论，评论由品牌筛选后公开":r?"已开启预审评论，评论由机构筛选后公开":"评论由作者筛选后显示");O()(a,"CommentEditor--normal"),this.state.shown;var f={preset:"primary",color:"blue",children:"评论",disabled:u};return Object(h.b)("div",{className:O()(a,"CommentEditor--normal",{"CommentEditor--active":l||!u})},this.renderInput({placeholder:p}),Object(h.b)(E.c,Object(s.default)({},f,{className:"CommentEditor-singleButton",onClick:this.onSubmit})))}}]),t}(v.Component),r.contextTypes={authRequired:b.a.func},o=i))||o)||o);X.defaultProps={defaultActive:!1,replyTo:null,inCommentItem:!1,autoFocus:!0,ownerAuthorIsOrg:!1,ownerAuthorIsBrand:!1},X.propTypes={className:b.a.string,defaultActive:b.a.bool,replyTo:b.a.object,inCommentItem:b.a.bool,commentNeedsReview:b.a.bool,canComment:b.a.object,onCancel:b.a.func,onSubmit:b.a.func.isRequired};var ee,te,ne,ae,oe=X,re=n(2230),ie=n(2229),se=n(2193),ce=n(1754),le=n(1757),ue=n(2226),de=n(2227),me=n(2194),pe=n(2228),he=(n(56),n(1935),n(151)),fe=n(21),be=n(200),ve=n(1809),ge=n(103),ye=n(1846),Ce=n(117),Oe=n(517),je=(n(2899),ee=Object(y.connect)(function(e){return{isWechat:e.env.userAgent.Wechat,shouldSpecialOia:Object(Q.g)(e)}}),Object(z.withRouter)(te=ee((ae=ne=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).state={reportModalShown:!1,isReplying:!1,collapsed:!0,guideShown:!1},n.getRedirectUrl=function(){var e=n.props.parent;switch(e.type){case"answer":return"/question/".concat(e.question.id,"/answer/").concat(e.id);case"article":return"https://zhuanlan.zhihu.com/p/".concat(e.id);default:return""}},n.like=n.context.authRequired(function(e){var t=n.props;(0,t.onLike)(t.comment.id,e)},fe.N.like,T.b),n.dislike=n.context.authRequired(function(){var e=n.props;(0,e.onDislike)(e.comment.id)},fe.N.like,T.b),n.delete=function(){var e=n.props;(0,e.onDelete)(e.comment.id)},n.feature=function(){var e=n.props;(0,e.onFeature)(e.comment.id)},n.collapse=function(){var e=n.props;(0,e.onCollapse)(e.comment.id)},n.approve=function(){var e=n.props;(0,e.onApprove)(e.comment.id)},n.showConversation=function(){var e=n.props;(0,e.onShowConversation)(e.comment.id)},n.startReply=n.context.authRequired(function(){n.setState({isReplying:!0})},void 0,T.b),n.stopReply=function(){n.setState({isReplying:!1})},n.openReportModal=n.context.authRequired(function(){n.setState({reportModalShown:!0})}),n.closeReportModal=function(e){if(e){var t=e.result.payload,a=t&&t.message||t&&t.code&&"举报失败";e.commentDeleteResult&&!(e.commentDeleteResult.payload||{}).code?ye.b.showModal({reportText:a}):Object(Ce.b)(a||"举报成功")}n.setState({reportModalShown:!1})},n.handleExpand=function(){n.setState({collapsed:!1})},n.handleToggleGuide=function(){n.setState({guideShown:!n.state.guideShown})},n.handleDelete=function(){return n.setState({deleteModal:!0})},n.handleCloseDelete=function(){return n.setState({deleteModal:!1})},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"renderRoleInfo",value:function(e,t){return"normal"===e?null:Object(h.b)("span",{className:"CommentItem-roleInfo"},"ancestor"===e||"author"===e&&"question"===t?" (提问者) ":" (作者) ")}},{key:"renderReplyTo",value:function(){var e=this.props.comment,t=e.replyToAuthor,n=e.resourceType;if(!t)return null;var a=t.member,o=void 0===a?{}:a,r=t.role;return Object(h.b)("span",null,Object(h.b)("span",{className:"CommentItem-reply"},"回复"),Object(h.b)(ge.a,{className:O()({"CommentItem-userLink":!1}),noBadge:!0,noHoverCard:!0,user:o}),this.renderRoleInfo(r,n))}},{key:"renderInner",value:function(){var e=this,t=this.props,n=t.comment,a=n.isDelete,o=n.collapsed,r=t.isConversation,i=t.ownerAuthorIsOrg;if(a)return r?Object(h.b)("div",{className:"CommentItem-deletedContent"},"这里有一条已删除的评论"):null;if(o&&r&&this.state.collapsed)return Object(h.b)("div",{className:"CommentItem-deletedContent"},"这里有一条已折叠的评论，",Object(h.b)(E.c,{preset:"plain",onClick:this.handleExpand},"查看"));var c,l=this.state,u=l.reportModalShown,d=l.isReplying,m=this.props,p=m.parent,f=p.canComment,b=(f=void 0===f?{status:!0}:f).status,v=p.questionType,g=m.commentNeedsReview,y=m.comment,C=m.onReply,j=m.status,k=m.type,w=m.canOperate,N=m.commentPattern,S=m.isMobile,I=y.id,P=y.author,R=y.content,x=y.voteCount,A=y.replyToAuthor,T=y.isAuthor,L=y.isParentAuthor,M=y.createdTime,_=y.featured,D=y.voting,F=y.reviewing,B=y.disliked,z=y.resourceType,V=y.collapsedReason,U=void 0===V?"":V,q=P||{},W=q.member,H=q.role;if(d)c=Object(h.b)(oe,{type:"comment",id:I,commentNeedsReview:g,className:"CommentItem-editor",defaultActive:!0,replyTo:y,onCancel:this.stopReply,onSubmit:C});else if("reviewing"===j)c=Object(h.b)("div",{className:"CommentItem-footer"},Object(h.b)(E.c,{preset:"plain",onClick:this.approve},Object(h.b)(re.a,{style:{marginRight:5},center:!0,size:14}),"公开"),Object(h.b)(E.c,{className:O()({"CommentItem-hoverBtn":!0}),preset:"plain",onClick:this.handleDelete},Object(h.b)(ie.a,{style:{marginRight:5},center:!0,size:16}),"删除"));else{var K=T||L&&("question"!==k||"commercial"===v);c=Object(h.b)("div",{className:O()("CommentItem-footer",{"CommentItem-mobileFooter":!1})},Object(h.b)(E.c,{className:O()("CommentItem-likeBtn",D&&"is-liked"),preset:"plain",onClick:this.like,disabled:T},Object(h.b)(se.a,{style:{marginRight:5},center:!0,size:16}),x>0?x:"赞"),o&&U&&Object(h.b)("div",{className:"CommentItem-walleTag"},"阴阳怪气自动折叠"===U&&Object(h.b)(ce.a,{size:16,className:"CommentItem-walleIcon"}),U),!r&&A&&Object(h.b)(E.c,{preset:"plain",className:"CommentItem-talkBtn",onClick:this.showConversation},Object(h.b)(le.a,{style:{marginRight:5},center:!0,size:16}),"查看对话"),!r&&!T&&b&&!o&&Object(h.b)(E.c,{preset:"plain",className:O()({"CommentItem-hoverBtn":!0}),onClick:this.startReply},Object(h.b)(ue.a,{style:{marginRight:5},center:!0,size:16}),"回复"),L&&w&&!S&&Object(h.b)(E.c,{className:O()({"CommentItem-hoverBtn":!T}),preset:"plain",onClick:this.feature},Object(h.b)(de.a,{style:{marginRight:5},center:!0,size:16}),_?"取消推荐":"推荐"),L&&w&&!S&&Object(h.b)(E.c,{className:O()({"CommentItem-hoverBtn":!T}),preset:"plain",onClick:this.collapse},Object(h.b)(me.a,{style:{marginRight:5},center:!0,size:14}),o?"取消折叠":"折叠"),!L&&!T&&w&&!S&&Object(h.b)(E.c,{className:O()({"CommentItem-hoverBtn":!0}),preset:"plain",onClick:this.dislike},Object(h.b)(se.a,{style:{transform:"rotate(180deg)",marginRight:5},size:16,center:!0}),B?"取消踩":"踩"),T||Object(h.b)(E.c,{className:O()({"CommentItem-hoverBtn":!0}),preset:"plain",onClick:this.openReportModal},Object(h.b)(pe.a,{style:{marginRight:5},center:!0,size:16}),"举报"),K&&Object(h.b)(E.c,{className:O()({"CommentItem-hoverBtn":!T}),preset:"plain",onClick:this.handleDelete},Object(h.b)(ie.a,{style:{marginRight:5},center:!0,size:16}),"删除"),!1,!1,Object(h.b)(ye.a,{shown:this.state.deleteModal,id:I,onDelete:this.delete,onClose:this.handleCloseDelete}),Object(h.b)(be.a,Object(s.default)({type:"comment",urlToken:I,shown:u,onClose:this.closeReportModal},K&&{onDeleteComment:function(){return e.props.onDelete(I)}},{notification:{failure:Oe.a},zaEnabled:!0})))}return Object(h.b)("div",null,Object(h.b)("div",{className:"CommentItem-meta"},W&&Object(h.b)(ge.a,{className:"CommentItem-avatar",avatar:!0,noHoverCard:"fixed"===N,user:W}),W&&Object(h.b)(ge.a,{className:O()({"CommentItem-userLink":!1}),noBadge:!0,noHoverCard:!0,user:W}),this.renderRoleInfo(H,z),this.renderReplyTo(),F&&Object(h.b)(me.a,{className:"CommentItem-reviewing","data-tooltip":"".concat(!1===i?"评论未公开，由作者筛选后显示":"已开启预审评论，评论由机构筛选后公开"),center:!0,size:14}),Object(h.b)("span",{className:"CommentItem-time"},Object(he.toRelativeString)(M))),Object(h.b)(ve.a,{className:"CommentItem-content",html:R}),c)}},{key:"render",value:function(){var e=this.renderInner(),t=this.props,n=t.parent;n.type,n.id,t.isWechat;return e&&Object(h.b)("div",{className:"CommentItem",ref:this.props.onRef},e,!1)}}]),t}(v.PureComponent),ne.propTypes={comment:b.a.object.isRequired,parent:b.a.object.isRequired,commentNeedsReview:b.a.bool,type:b.a.string,isConversation:b.a.bool,onLike:b.a.func.isRequired,onShowConversation:b.a.func,onReply:b.a.func,onFeature:b.a.func,onDelete:b.a.func.isRequired,onCollapse:b.a.func,commentPattern:b.a.string,isMobile:b.a.bool},ne.contextTypes={currentUser:b.a.object,authRequired:b.a.func},te=ae))||te)||te),ke=n(2341),we=n(2251),Ne=n(2342);n(2904);function Se(e,t){switch(e){case"answer":return Object(L.n)(t);case"article":return Object(M.b)(t);default:return null}}var Ie=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).state={collapsed:!0,current:1},n.commentsWithPaginationElRef=g.a.createRef(),n.load=function(e,t,a){if(!n.props.isFetching&&!n.props.parent.adminClosedComment){var o=e||n.props,r=o.order,i=o.byComment,s=o.status,c=o.parent,l=c.id,u=c.type,d=o.dispatch,m=o.commentPattern;if(o.needLoadCommentPermission&&Se(u,l)&&d(Se(u,l)),a){d(Object(j.e)(u,l,{order:r,isPrevious:t,byComment:i,status:"collapsed",commentPattern:m},!0))}else d(Object(j.e)(u,l,{order:r,isPrevious:t,byComment:i,status:s,commentPattern:m}))}},n.addComment=function(e,t){var a=n.props,o=a.parent,r=o.id,i=o.type,s=a.dispatch,c=[i,r,e];return t&&(c[3]=t.id),s(j.a.apply(void 0,c))},n.featureItem=function(e){n.props.onItemFeature(e,n.lastFeaturedIndex)},n.handleOpenCollapsed=function(){n.setState({collapsed:!1}),n.load(n.props,!1,!0)},n.createOnRef=N()(function(e){return function(t){var a=n.props.byComment;e===Number(a)&&(n.targetCommentEl=t)}}),n.handlePageSelect=function(e){var t=n.props.onPaginationClick,a=n.state.current;t&&t(a,e),n.commentsElement.scrollIntoView(),n.setState({current:e}),n.loadByPagination(e)},n.loadByPagination=function(e,t){var a=t||n.props,o=a.order,r=a.byComment,i=a.status,s=a.parent,c=s.id,l=s.type,u=a.dispatch,d=a.commentPattern;a.needLoadCommentPermission&&Se(l,c)&&u(Se(l,c)),u(Object(j.e)(l,c,{order:o,isPrevious:!1,byComment:r,status:i,commentPattern:d,current:e}))},n.renderComment=function(e){var t=n.props,a=t.parent,o=a.type,r=a.author,i=(r=void 0===r?{isOrg:!1}:r).isOrg,s=t.isMobile,c=t.parent,l=t.commentNeedsReview,u=t.onShowConversation,d=t.status,m=t.onItemLike,p=t.onItemDelete,f=t.onItemCollapse,b=t.onItemDislike,v=t.onItemApprove,g=t.canOperateItem,y=t.commentPattern;return Object(h.b)(je,{key:e.id,isMobile:s,comment:e,onRef:n.createOnRef(e.id),status:d,type:o,parent:c,canOperate:g,commentNeedsReview:l,onShowConversation:u,ownerAuthorIsOrg:i,onLike:m,onReply:n.addComment,onFeature:n.featureItem,onDelete:p,onCollapse:f,onDislike:b,onApprove:v,commentPattern:y})},n.renderNormalComments=function(e){var t=n.state.collapsed,a=n.props.byComment,o=[];if(n.lastFeaturedIndex=0,e.length>0){var r=e[0].featured,i=!1;e.forEach(function(s,c){if(a||!s.collapsed){var l=e[c-1];if(!s.collapsed||(l&&l.collapsed||o.push(n.renderCollapsedDivider()),!t)){o.push(n.renderComment(s));var u=e[c+1];r&&!i&&s.featured&&(!u||!u.featured)&&(i=!0,n.lastFeaturedIndex=c,o.push(Object(h.b)("div",{className:"CommentList-divider",key:"divider-featured"},Object(h.b)("div",{className:"CommentList-dividerLine"}),Object(h.b)("div",{className:"CommentList-dividerText"},"以上为精选评论",Object(h.b)(S.a,{className:"CommentList-questionMark","data-tooltip":"精选评论包含回答作者推荐的评论和部分高赞评论",center:!0,size:16})))))}}})}return o},n.renderCollapsedComments=function(){var e=[],t=n.props.collapsedComments;return n.state.collapsed||!t||t.length<=0?[]:(e.push(t.map(function(e){return n.renderComment(e)})),e)},n.renderComments=function(e){return e.map(n.renderComment)},n.renderCollapsedDivider=function(){var e=n.props,t=e.isDrained,a=e.parent.collapsedCounts;return!t||a<=0?[]:n.state.collapsed?Object(h.b)("div",{className:"CommentList-action",key:"collapsed"},Object(h.b)("div",{className:"CommentList-expendCollapseButton"},Object(h.b)("span",{onClick:n.handleOpenCollapsed},Object(x.formatNumber)(a)," 条评论被折叠"),"（",Object(h.b)("a",{href:"//www.zhihu.com/question/52029856/answer/128623557",target:"_blank",rel:"noopener noreferrer"},"为什么？"),"）")):Object(h.b)("div",{className:"CommentList-divider",key:"divider-collapsed"},Object(h.b)("div",{className:"CommentList-dividerLine"}),Object(h.b)("div",{className:"CommentList-dividerText"},Object(x.formatNumber)(a)," 条评论被折叠（",Object(h.b)("a",{href:"//www.zhihu.com/question/52029856/answer/128623557",target:"_blank",rel:"noopener noreferrer"},"为什么？"),"）"))},n.renderCollapsedInfiLoader=function(){var e=n.state.collapsed;if(e)return[];var t=n.props.collapsedInfo,a=(t=void 0===t?{}:t).isFetching,o=t.isPrevDrained,r=t.isDrained;return Object(h.b)(P.b,{className:"CommentList",onRef:function(e){n.listEl=e},isLocal:!0,isLoading:a,isPrevDrained:o,isDrained:r,onLoad:function(t){return n.load(n.props,t,!e)},placeholder:Object(h.b)(P.a,{className:"CommentItem",small:!0})},n.renderCollapsedComments())},n.renderPatternContent=function(e){var t=n.props,a=t.isFetching,o=t.parent.adminClosedComment,r=t.byComment,i=t.status,s=t.order,c=t.totals,l=t.showPackupButton,u=t.handlePackupButton,d=Math.ceil(c/20),m=n.state.current;return o?null:a?Object(h.b)(ke.a,null):Object(h.b)("div",{ref:n.commentsWithPaginationElRef},Object(h.b)("div",{className:"CommentList"},"normal"===s&&"open"===i?n.renderNormalComments(e):n.renderComments(e)),d>1&&Object(h.b)(R.a,{className:"comments-pagination",current:m,total:d,onSelect:n.handlePageSelect}),!r&&n.renderCollapsedDivider(),!r&&n.renderCollapsedInfiLoader(),l&&Object(h.b)(Ne.a,{onClick:u,commentsElRef:n.commentsWithPaginationElRef}))},n.renderModalContent=function(e){var t=n.props,a=t.collapsedInfo,o=t.parent.adminClosedComment,r=t.status,i=t.order,c=t.byComment,l=n.state.collapsed,u=l?n.props:a,d=u.isFetching,m=u.isDrained,p=u.isPrevDrained;if(m&&e.length<=0||o)return Object(h.b)("div",{className:"Comments-empty"},Object(h.b)(_.a,{entityType:"comments"}));var f={getContainer:function(e){return e}};return Object(h.b)(P.b,Object(s.default)({className:"CommentList",onRef:function(e){n.listEl=e},isLocal:!0,isLoading:d,isPrevDrained:p,isDrained:m,onLoad:function(e){return n.load(n.props,e,!l)},placeholder:Object(h.b)(P.a,{className:"CommentItem",small:!0})},f),"normal"===i&&"open"===r?n.renderNormalComments(e):n.renderComments(e),!c&&n.renderCollapsedDivider(),!c&&n.renderCollapsedComments())},n.renderCommentEdit=function(e){var t=n.props,a=t.parent,o=a.canComment,r=(o=void 0===o?{status:!0}:o).status,i=o.reason,c=a.author,l=(c=void 0===c?{isOrg:!1}:c).isOrg,u=a.type,d=a.id,m=a.adminClosedComment,p=a.questionType,f=t.byComment,b=t.autoFocus,v=t.commentNeedsReview,g=m?"当前内容暂时无法评论":i,y=b&&!f;return r&&!m?Object(h.b)(oe,Object(s.default)({className:"Comments-".concat("top"===e?"top":"footer"),type:u,id:d,commentNeedsReview:v,onSubmit:n.addComment,autoFocus:y,ownerAuthorIsOrg:l,ownerAuthorIsBrand:"commercial"===p},"top"===e&&{preset:"default",onClick:function(e){k.default.trackEvent(e.target,{id:3905})}})):"top"!==e&&Object(h.b)("div",{className:O()("Comments-disabledText",{"Comments-disabledText--fixed":!1})},Object(h.b)("div",{className:"Comments-disabledReason"},g))},n.renderBottomButton=function(){var e=n.props.params,t=e.id,a=e.answerId,o=Boolean(a);return Object(h.b)("div",{className:"Comments-footer CommentEditor--normal"},Object(h.b)(E.c,{className:"CommentEditor-startCommentButton",preset:"primary",color:"blue",onClick:function(){return Object(I.b)(Object(A.a)(o?{type:"answer",id:a}:{type:"question",id:t},{utm_content:"comment_area"}),{zaProps:{id:3906}})}},"打开 App 参与站内讨论"))},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.byComment,n=e.commentPattern,a=e.parent.adminClosedComment,o=this.state.current;t&&this.scrollToTarget(),"bottom"!==n||a||this.loadByPagination(o)}},{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.order,a=t.status,o=t.targetComment,r=t.commentPattern;n===e.order&&a===e.status||("bottom"===r?(this.setState({current:1}),this.loadByPagination(1,e)):this.load(e),this.setState({collapsed:!0}));var i=e.targetComment;!o&&i&&this.setState({collapsed:!i.collapsed})}},{key:"componentDidUpdate",value:function(e){!e.comments.length&&this.props.comments.length&&this.props.byComment&&this.scrollToTarget()}},{key:"componentWillUnmount",value:function(){this.props.dispatch(Object(T.e)(T.b))}},{key:"scrollToTarget",value:function(){var e=this.targetCommentEl,t=this.listEl;if(t&&e){var n=e.getBoundingClientRect(),a=n.top,o=n.height,r=t.getBoundingClientRect(),i=r.top,s=r.height;this.listEl.scrollTop+=a-i-(s-o)/2,e.classList.add("CommentItem--highlighted"),setTimeout(function(){return e.classList.remove("CommentItem--highlighted")},2e3),e.tabIndex=-1,e.focus()}}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,a=t.isAuthor,o=t.comments,r=t.commentPattern,i=t.commentInputPosition,c=t.parent,l=c.canComment,u=(l=void 0===l?{status:!0}:l).status,d=c.author,m=(d=void 0===d?{isOrg:!1}:d).isOrg,p=c.commentPermission,f=c.reviewingCounts,b=c.commentCount,v=c.adminClosedComment,g=t.totals,y=t.status,C=t.order,j=t.onStatusChange,k=t.onOrderChange,w=t.targetLink,N=o.filter(function(e){return!e.isDelete}),S="censor"===p&&a,I=S?{isCommentReviewer:S,onStatusChange:j,status:y,reviewingCounts:f}:{status:y},P=O()({Comments:!0,"Comments--withEditor":!0,"Comments-withPagination":"bottom"===r},n);return Object(h.b)("div",{className:P,ref:function(t){e.commentsElement=t}},Object(h.b)(we.a,Object(s.default)({commentCount:void 0!==b?b:g,commentClosed:v,targetLink:w,order:C,onOrderChange:k,commentPattern:r,isOrg:m,options:this.renderCommentEdit("top")},I)),"top"===i&&this.renderCommentEdit(),"bottom"===r?this.renderPatternContent(N):this.renderModalContent(N),"bottom"===i&&!u&&this.renderCommentEdit(),"bottom"===i&&u&&this.renderBottomButton())}}]),t}(v.Component);Ie.propTypes={type:b.a.string,parent:b.a.object.isRequired,targetLink:b.a.node,commentNeedsReview:b.a.bool,byComment:b.a.oneOfType([b.a.number,b.a.string]),commentPattern:b.a.string,commentInputPosition:b.a.oneOf(["top","bottom"]),showPackupButton:b.a.bool,handlePackupButton:b.a.func,onPaginationClick:b.a.func,autoFocus:b.a.bool},Ie.contextTypes={authRequired:b.a.func.isRequired},Ie.defaultProps={commentInputPosition:"bottom",showPackupButton:!0,autoFocus:!0};var Pe=Object(y.connect)(function(e,t){var n=t.parent,a=t.parent,o=a.type,r=a.id,i=t.status,s=t.order,c=t.byComment,l=t.commentPattern,u=e.entities,d=e.comments,m="".concat(o,"_").concat(r),p=d.parent,h=d.pagination;"reviewing"===i&&(h=d.reviewing),"reverse"===s&&"open"===i&&(h=d.reverse);var f=[],b=d.collapsed[m]||{};b.ids&&b.ids.length>0&&(f=b.ids.map(function(e){return u.comments[e]}));var v=h[m]||{isPrevDrained:!1,isFetching:!1,isDrained:!1,ids:[]},g=v.isFetching,y=v.isPrevDrained,C=v.isDrained,O=v.ids,j=v.newIds,k=void 0===j?[]:j;return{isFetching:g,isPrevDrained:y,isDrained:C,totals:v.totals,comments:("bottom"!==l?O:k).map(function(e){return u.comments[e]}),collapsedInfo:b,collapsedComments:f,targetComment:u.comments[c],parent:Object.assign({},n,{},p[m])}})(Ie);var Re=function(e){function t(e,n){var a;return Object(l.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e,n))).load=a.load.bind(Object(B.default)(a)),a.addComment=n.authRequired(a.addComment.bind(Object(B.default)(a)),void 0,T.b),a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.load()}},{key:"load",value:function(){this.props.dispatch(Object(j.f)(this.props.commentId))}},{key:"addComment",value:function(e,t){var n=this.props,a=n.parent,o=a.type,r=a.id,i=n.commentId,s=n.dispatch,c=[o,r,e,t.id,i];return s(j.a.apply(void 0,c))}},{key:"render",value:function(){var e,t,n,a=this.props,o=a.onItemLike,r=a.onItemDelete,i=a.onItemFeature,s=a.onItemApprove,c=a.onItemCollapse,l=a.onItemDislike,u=a.onNavBack,d=a.canOperateItem,m=a.isFetching,p=a.comments,f=a.commentNeedsReview,b=a.openComment.collapsed,v=a.parent,g=a.parent.canComment,y=(g=void 0===g?{status:!0}:g).status,C=g.reason,O=a.commentPattern,j=a.commentId,k=this.context.currentUser;return Boolean(k&&p.find(function(e){return e.author&&e.author.member.urlToken===k.urlToken}))&&(t=(e=p.filter(function(e){return e.author&&e.author.member.urlToken!==k.urlToken}))[e.length-1]),m&&!p.length?n=Object(h.b)(P.a,{className:"CommentItem",small:!0}):p.length&&(n=p.map(function(e,t){return Object(h.b)(je,{key:t,isConversation:!0,commentNeedsReview:f,canOperate:d,parent:v,comment:e,onLike:o,onDelete:r,onFeature:i,onApprove:s,onCollapse:c,onDislike:l,collapsedShown:b})})),"bottom"===O?Object(h.b)(H.b,{size:"fullPage",onClose:u},Object(h.b)("div",{className:"Comments"},Object(h.b)(we.a,{isConversation:!0,commentPattern:O}),Object(h.b)("div",{className:"CommentList"},n))):Object(h.b)("div",{className:"Comments"},Object(h.b)(we.a,{isConversation:!0,onNavBack:u}),Object(h.b)("div",{className:"CommentList"},n),t&&(y?Object(h.b)(oe,{id:j,type:"conversation",className:"Comments-footer",replyTo:t,commentNeedsReview:f,onSubmit:this.addComment}):Object(h.b)("div",{className:"Comments-disabledText"},C)))}}]),t}(v.Component);Re.propTypes={commentId:b.a.number.isRequired,type:b.a.string,parent:b.a.object.isRequired,commentNeedsReview:b.a.bool},Re.contextTypes={currentUser:b.a.object,authRequired:b.a.func.isRequired};var Ee,xe,Ae,Te=Object(y.connect)(function(e,t){var n=t.commentId,a=e.entities.comments,o=e.comments.conversation[n]||{isFetching:!1,isDrained:!1,ids:[]};return{isFetching:o.isFetching,isDrained:o.isDrained,comments:o.ids.map(function(e){return a[e]}),openComment:a[n]}})(Re),Le=n(150),Me=Object(Le.a)(null)((Ae=xe=function(e){function t(e){var n;Object(l.a)(this,t),(n=Object(d.a)(this,Object(m.a)(t).call(this,e))).state={openedCommentId:null,status:"open",order:"normal"},n.like=function(e,t){var a=n.props,o=a.onItemLike,r=a.dispatch;o&&o(e,t),r(Object(j.j)(e))},n.collapse=function(e){var t=n.props,a=t.dispatch,o=t.parent;a(Object(j.g)(e,o.type,o.id))},n.dislike=function(e){return n.props.dispatch(Object(j.h)(e))},n.approve=function(e){var t=n.props,a=t.dispatch,o=t.parent,r=t.type;a(Object(j.b)(e,o.type||r,o.id))},n.handleStatusChange=function(e){n.setState({status:e})},n.handleOrderChange=function(e,t){n.props.onOrderChange&&n.props.onOrderChange(e,t),n.setState({order:e})};var a=e.parent,o=e.dispatch;return n.feature=function(e,t){return o(Object(j.i)(e,a.id,a.type,t))},n.delete=function(e){return o(Object(j.d)(e,a.type,a.id))},n.showConversation=function(e){return n.setState({openedCommentId:e})},n.showComments=function(){return n.setState({openedCommentId:null})},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.onMount;e&&e(this.domNode)}},{key:"render",value:function(){var e=this,t=this.props,n=t.parent,a=t.commentPattern,o=t.type,r=t.parent,i=(r=void 0===r?{}:r).commentPermission,l=r.relationship,u=void 0===l?{}:l,d=r.author,m=void 0===d?{}:d,p=t.needLoadCommentPermission,f=Object(c.a)(t,["parent","commentPattern","type","parent","needLoadCommentPermission"]),b=this.context.currentUser,v=void 0===u.isAuthor?b&&m.urlToken&&b.urlToken===m.urlToken:u.isAuthor,g="censor"===i&&!v,y="answer"===o||"article"===o,C=this.state,j=C.openedCommentId,k=C.status,w=C.order,N={commentNeedsReview:g,parent:n,type:o,canOperateItem:y,onShowConversation:this.showConversation,onItemLike:this.like,onItemFeature:this.feature,onItemDelete:this.delete,onItemCollapse:this.collapse,onItemDislike:this.dislike,onItemApprove:this.approve};return Object(h.b)("div",{className:"Comments-container",ref:function(t){return e.domNode=t}},Object(h.b)(Pe,Object(s.default)({},f,N,{commentPattern:a,className:O()({"Comments--hidden":j&&"bottom"!==a}),order:w,status:k,onStatusChange:this.handleStatusChange,onOrderChange:this.handleOrderChange,needLoadCommentPermission:p,isAuthor:v})),j&&Object(h.b)(Te,Object(s.default)({},f,N,{commentPattern:a,commentId:j,onNavBack:this.showComments})))}}]),t}(v.Component),xe.propTypes={type:b.a.string.isRequired,parent:b.a.object.isRequired,onOrderChange:b.a.func,onItemLike:b.a.func,isAuthor:b.a.bool,onMount:b.a.func},xe.defaultProps={type:"answer"},xe.contextTypes={currentUser:b.a.object,authRequired:b.a.func.isRequired},Ee=Ae))||Ee;t.default=Object(y.connect)()(Me)},3009:function(e,t,n){"use strict";n.r(t);var a=n(4),o=n(5),r=n(8),i=n(6),s=n(7),c=n(0),l=n(1),u=n.n(l),d=n(2),m=n.n(d),p=n(11),h=n.n(p),f=n(15),b=n(44),v=n(761),g=n(134),y=n(43),C=n(30),O=(n(2983),8),j=9,k=13,w=48,N=57;function S(e,t){return e?t?!0===t?"":t:e:""}var I=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(r.a)(this,Object(i.a)(t).call(this,e))).onInputFocus=n.onInputFocus.bind(Object(C.default)(n)),n.onInputChange=n.onInputChange.bind(Object(C.default)(n)),n.onKeyDown=n.onKeyDown.bind(Object(C.default)(n)),n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"onInputFocus",value:function(){this.props.onFocus()}},{key:"onInputChange",value:function(e){var t=String(e.target.value);if(t){t=t[t.length-1];var n=this.props.chars,a=this.props.length;n.length===a?n=n.replace(/.$/,t):n+=t,this.props.onChange(n),n.length===a&&this.props.onFinish(n)}}},{key:"onKeyDown",value:function(e){var t=e.keyCode;if(!e.metaKey&&!e.ctrlKey&&t!==j&&t!==k){var n=this.props.chars;t===O?(n=n.slice(0,-1),this.props.onChange(n)):(t<w||t>N)&&(e.preventDefault(),this.props.onError(e))}}},{key:"focus",value:function(){this.input.focus()}},{key:"blur",value:function(){this.input.blur()}},{key:"render",value:function(){var e=this,t=this.props,n=t.length,a=t.chars,o=t.maskChar,r=t.autoFocus,i=t.className,s=t.children,l=a.length===n?n-1:a.length,u=a[l]||"";return Object(c.b)("label",{className:h()("TPass",i)},Object(c.b)("span",{className:"TPass-wrapper"},Object(c.b)(P,{length:n,chars:a,maskChar:o}),Object(c.b)("input",{className:"TPass-input",value:u,style:{left:60*l},onFocus:this.onInputFocus,onChange:this.onInputChange,onKeyDown:this.onKeyDown,onPaste:function(e){return e.preventDefault()},type:"number",min:"0",max:"9",pattern:"[0-9]*",autoFocus:r,ref:function(t){e.input=t}})),s)}}]),t}(u.a.Component);function P(e){for(var t,n=e.length,a=e.chars,o=e.maskChar,r=[],i=0;i<n;i+=1)t=a[i],r.push(Object(c.b)("span",{className:h()("TPassBox",{"TPassBox-mask":t&&Boolean(o)}),key:i},S(t,o)));return Object(c.b)("span",{className:"TPassBoxes"},r)}I.defaultProps={length:6,chars:"",maskChar:!1,autoFocus:!1,onFocus:function(){},onChange:function(){},onError:function(){},onFinish:function(){}},I.propTypes={length:m.a.number,chars:m.a.string,maskChar:m.a.oneOfType([m.a.bool,m.a.string]),autoFocus:m.a.bool,onFocus:m.a.func,onChange:m.a.func,onError:m.a.func,onFinish:m.a.func,className:m.a.string,children:m.a.node};var R=I,E=(n(2984),function(e){function t(){return Object(a.a)(this,t),Object(r.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props;return Object(c.b)("div",{className:h()("Spinner",e)},Object(c.b)("i",{className:"Spinner-loading"}))}}]),t}(l.Component));E.propTypes={className:m.a.string};var x=n(108),A=(n(2985),11);function T(){this.payments={},this.chosePaymentName=null,this.codeUrl="",this.qrLoaded=!1,this.need=null,this.passcode="",this.needSMS=!1,this.smsTimer=0,this.isInProgress=!1,this.error=null}var L=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(r.a)(this,Object(i.a)(t).call(this,e))).onPasscodeFocus=function(){n.state.error&&(n.setState({error:null}),6===n.state.passcode.length&&n.setState({passcode:""}))},n.onPasscodeInput=function(e){"object"==typeof e&&(e=e.target.value),n.setState({passcode:e})},n.onPasscodeFinish=function(e){n.tpass.blur(),n.payWithBalance(e)},n.onSendSMSCode=function(){n.props.trade.resendSMSCode(function(){n.startSMSTimer(),n.smsInput.focus()},function(e){n.setState({error:e})})},n.onQrLoad=function(){n.setState({qrLoaded:!0})},n.onBalanceFormSubmit=function(e){e.preventDefault(),n.payWithBalance(n.state.passcode)},n.setPayments=function(e){n.setState({payments:e})},n.confirmPayment=function(){var e=n.state,t=e.choseName,a=e.payments,o=n.props.onConfirmPayment,r=t;if(t||(r=a.balance&&a.balance.enable?"balance":"wechat"),o(!r),n.setState({chosePaymentName:r}),"wechat"===r&&n.isInWechat){var i=n.props.tradeNumber,s="".concat(location.protocol,"//").concat(location.host).concat(location.pathname),c="".concat("https://www.zhihu.com/pay/weixin/pay?service_id=".concat(A)+"&trade_number=".concat(i,"&redirect_uri=").concat(encodeURIComponent(s)));window.location.replace(c)}else n.props.trade["wechat"===r?"initWechatPay":"initBalancePay"]()},n.pid=0,n.smsTimer=null,n.state=new T,n.isInWechat=e.ua.Wechat,n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){var e=this.props.trade;this.getPaymentsList(e),this.initListeners(e)}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.trade!==this.props.trade&&(this.setState(new T),setTimeout(function(){t.getPaymentsList(e.trade)},300),this.initListeners(e.trade))}},{key:"componentWillUnmount",value:function(){window.clearInterval(this.smsTimer),this.props.trade.dispose()}},{key:"getPaymentsList",value:function(e){var t=this;if(e){var n=this.pid+=1;e.getPaymentsList(function(e){t.pid===n&&t.setPayments(e)})}}},{key:"initListeners",value:function(e){var t=this;e&&e.on("payInited",function(e,n){t.setState(Object.assign({},n))}).on("paySuccess",function(){t.setState({isInProgress:!1,error:null}),t.props.onSuccess()}).on("payCancel",function(){t.setState({isInProgress:!1,chosePaymentName:null})}).on("payFail",function(e){var n=e;"object"!=typeof e||e instanceof Error||(n=e.message),t.setState({isInProgress:!1,error:n}),t.props.onFail(e)}).on("needSMS",function(e){t.setState({isInProgress:!1,error:null,needSMS:e.message,passcode:""})}).on("needWechatCode",function(){t.props.onError("needWechatCode")}).on("error",function(e,n){t.props.onError(e,n)})}},{key:"startSMSTimer",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:60;window.clearInterval(this.smsTimer),this.setState({smsTimer:t}),this.smsTimer=window.setInterval(function(){(t-=1)<=0?(window.clearInterval(e.smsTimer),e.smsTimer=null,e.setState({smsTimer:0})):e.setState({smsTimer:t})},1e3)}},{key:"payWithBalance",value:function(e){return 6!==e.length?(this.setState({error:"请输入 6 位支付密码"}),!1):(this.setState({isInProgress:!0,error:null}),this.props.trade.payWithBalance(e))}},{key:"renderPaymentsList",value:function(){var e=this,t=this.state,n=t.payments,a=t.chosePaymentName,o=t.choseName,r=this.props.trade;if(a)return null;var i=n.balance&&n.balance.amount,s=r.info.total,l=n.wechat&&n.wechat.enable,u=n.balance&&n.balance.enable,d=n.balance&&!n.balance.enable,m=i>=s?"使用余额（剩余 ".concat((i/100).toFixed(2),"）"):"微信支付",p=i>=s?"wallet":"wechatPayment",h="PaymentItem-".concat(i>=s?"wallet":"wechatPayment");o&&(m="wechat"===o?"微信支付":"使用余额（剩余 ".concat((i/100).toFixed(2),"）"),p="wechat"===o?"wechatPayment":"wallet",h="PaymentItem-".concat("wechat"===o?"wechatPayment":"wallet"));var b=Object(c.b)("div",null,Object(c.b)(y.a,{name:p,className:h}),Object(c.b)(f.c,{className:"Payment-Popover"},m),Object(c.b)(y.a,{className:"Select-arrow",name:"select"}));return Object(c.b)("div",{className:"PaymentsList"},Object(c.b)("span",{className:"Payment-Topline"}),Object(c.b)("span",{className:"PaymentWay"},"支付方式"),Object(c.b)(x.a,{placeholder:b},Object(c.b)(g.b,{plain:!0,className:"Payment-select",listClassName:"Payment-select-list",targetClassName:"Popover-targetContainer-verification",text:i>=s?"使用余额（剩余 ".concat((i/100).toFixed(2),"）"):"微信支付",menuToggler:b,onChange:function(t){"disabled"!==t&&e.setState({choseName:t})}},u&&Object(c.b)(g.a,{value:"balance",className:"PaymentItem"},Object(c.b)(y.a,{name:"wallet",className:"PaymentItem-wallet"}),"使用余额（剩余 ".concat((i/100).toFixed(2),"）")),d&&Object(c.b)(g.a,{value:"disabled",className:"PaymentItem PaymentItem--disabled"},Object(c.b)(y.a,{name:"wallet",className:"PaymentItem-wallet"}),"使用余额（剩余 ".concat((i/100).toFixed(2),"）")),l&&Object(c.b)(g.a,{value:"wechat",className:"PaymentItem"},Object(c.b)(y.a,{name:"wechatPayment",className:"PaymentItem-wechatPayment"}),"微信支付"))),Object(c.b)("span",{className:"Payment-Bottomline"}),Object(c.b)(f.c,{className:"Payment-CheckedButton",onClick:this.confirmPayment},"确认支付"))}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,a=t.trade,o=this.state,r=o.payments,i=o.chosePaymentName,s=o.codeUrl,l=o.needSMS,u=o.isInProgress;return a?Object(c.b)("div",{className:h()("Payment",n)},Object.keys(r).length?this.renderPaymentsList():Object(c.b)("div",{className:"Payment-placeholder"},Object(c.b)(E,null)),"wechat"===i&&Object(c.b)("div",{className:"Payment-wechatPay"},Object(c.b)("div",{className:"Payment-wechatPayTitle"},Object(c.b)("i",{className:"icon icon-ic_wechatpay PaymentIconWechat"}),"微信支付"),!this.isInWechat&&Object(c.b)("div",null,"使用微信扫描二维码完成支付"),this.state.qrLoaded?Object(c.b)("span",{className:"Payment-qrWrapper"},Object(c.b)("img",{role:"presentation",src:"//www.zhihu.com/qrcode?url=".concat(s),width:"150",height:"150"})):Object(c.b)("div",{className:"Payment-qrPlaceholder"},Object(c.b)(E,null),!this.isInWechat&&Object(c.b)("div",null,"正在生成二维码"),s&&Object(c.b)("img",{role:"presentation",src:"//www.zhihu.com/qrcode?url=".concat(s),width:"1",height:"1",onLoad:this.onQrLoad}))),"balance"===i&&Object(c.b)("form",{onSubmit:this.onBalanceFormSubmit,className:"Payment-balancePay"},Object(c.b)("div",{className:"Payment-balancePayTitle"},Object(c.b)("i",{className:"icon icon-wallet PaymentIconWallet"}),"余额支付"),!l&&Object(c.b)("div",null,Object(c.b)("div",{className:"Payment-description"},"请输入 6 位数知乎支付密码，用于支付验证。"),Object(c.b)(R,{chars:this.state.passcode,onFocus:this.onPasscodeFocus,onChange:this.onPasscodeInput,maskChar:!0,onFinish:this.onPasscodeFinish,className:h()("Payment-tpass",{"Payment-errorInput":this.state.error,"Payment-progressing":u}),autoFocus:!0,ref:function(t){e.tpass=t}},u&&Object(c.b)(E,{className:"Payment-balancePaySpinner"}))),Boolean(l)&&Object(c.b)("div",{className:"Payment-balancePaySms"},Object(c.b)("div",{className:"Payment-balancePaySmsText"},String(l)),Object(c.b)("input",{onChange:this.onPasscodeInput,value:this.state.passcode,className:h()("Payment-sms","SimpleInput",{"Payment-errorInput":this.state.error}),type:"text",pattern:"\\d{6}",minLength:"6",maxLength:"6",title:"验证码应为 6 位数字",placeholder:"输入 6 位数验证码",required:!0,autoFocus:!0,ref:function(t){e.smsInput=t}}),this.state.smsTimer?Object(c.b)("button",{className:"Payment-sendSms",type:"button",disabled:!0},this.state.smsTimer," 秒后可重发"):Object(c.b)("button",{onClick:this.onSendSMSCode,className:"Payment-sendSms",type:"button"},"发送验证码")),Object(c.b)("div",{className:"Payment-balancePayFooter"},Object(c.b)("p",{className:"Payment-errorTip",style:{visibility:this.state.error?"visible":"hidden"}},this.state.error),Boolean(l)&&Object(c.b)(f.c,{color:"blue",disabled:u,className:"Payment-balancePayConfirmBtn",type:"submit"},"确认")),!l&&Object(c.b)("div",{className:"Payment-balancePayForget"},"如果忘记密码请邮件联系"," ",Object(c.b)("email",{className:"Payment-email"},"i@zhihu.com")))):Object(c.b)("div",{className:h()("Payment",n)},Object(c.b)("div",{className:"Payment-placeholder Payment-placehoder--empty"},Object(c.b)(E,null)))}}]),t}(u.a.Component);L.propTypes={trade:m.a.object,autoChooseSinglePayment:m.a.bool,onSuccess:m.a.func.isRequired,onFail:m.a.func,onError:m.a.func,onConfirmPayment:m.a.func},L.defaultProps={trade:null,onSuccess:function(){},onFail:function(){},onError:function(){},autoChooseSinglePayment:!0,className:""};var M=L,_=n(210),D="",F=null;var B=n(21);n(2986);n.d(t,"TipjarDialog",function(){return U});var z=[200,500,1e3,5e3,1e4,2e4],V=100,U=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(r.a)(this,Object(i.a)(t).call(this,e))).lockScroll=function(){document.body.classList.add("scroll-locked"),n.scrollTop=window.scrollY,document.body.style.width="100%",document.body.style.position="fixed",document.body.style.top=-n.scrollTop+"px"},n.unlockScroll=function(){document.body.classList.remove("scroll-locked"),document.body.style.width=null,document.body.style.position=null,void 0!==n.scrollTop&&(window.scrollTo(0,n.scrollTop),n.scrollTop=void 0),document.body.style.top=null},n.onConfirmPayment=function(e){n.setState({chosePaymentName:e})},n.onPaySuccess=function(){n.props.onPaySuccess(),n.setState({chosePaymentName:!0,colseTijarDialogStatus:!0,trade:void 0,currentAmount:"",customButton:!1})},n.handleCustomAmount=function(){n.state.trade&&n.state.trade.dispose(),n.setState({showCustom:!0})},n.handleCustomChange=function(e){var t=e.target.value;isNaN(t)?n.setState({customAmount:""}):n.setState({customAmount:parseInt(t)||""})},n.handleCustomKeyUp=function(e){13===e.keyCode&&n.handleSubmitCustom()},n.handleSubmitCustom=function(){var e=n.state.customAmount*V;e>0&&e<=5e4&&(n.setState({customButton:!0,showCustom:!1,colseTijarDialogStatus:!1}),n.createTrade(e))},n.closeModal=function(){n.state.trade&&n.state.trade.dispose(),n.setState(n.getDefaultState())},n.handleAmountButton=function(e){n.createTrade(e.currentTarget.dataset.amount),n.setState({colseTijarDialogStatus:!1,customButton:!1,showCustom:!1})},n.createTrade=function(e){n.setState({tradeLoading:!0,currentAmount:e});var t=n.props.ua;n.props.addReward(e,t.Wechat?"wechat":"normal"),n.setState({tradeLoading:!1})},n.colseTijarDialog=function(){n.setState({chosePaymentName:!0,colseTijarDialogStatus:!0,trade:void 0,currentAmount:""}),n.props.colseTijarDialog()},n.state=n.getDefaultState(),n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.showTip()}},{key:"componentDidUpdate",value:function(e){var t=e.TipjarRender,n=this.props,a=n.tradeNumber,o=n.type,r=n.isMobile,i=n.TipjarRender,s=this.state,c=s.trade,l=s.colseTijarDialogStatus,u="article"===o?11:17;if(a&&(!c||a!==c.tradeNo)&&!l){var d=new window.zhihu.pay.Trade(a,u);this.setState({trade:d})}r&&(!t&&i?this.lockScroll():t&&!i&&this.unlockScroll())}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.TipjarRender,n=e.isMobile;t&&this.props.removeTradeNumber(),t&&n&&this.unlockScroll()}},{key:"getDefaultState",value:function(){return{showCustom:!1,customAmount:"",currentAmount:"",showTipModal:!1,customButton:!1,chosePaymentName:!0,colseTijarDialogStatus:!1}}},{key:"showTip",value:function(){var e,t,n=this;e="https://pay.zhihu.com/api/js",t=function(){n.setState({showTipModal:!0})},D&&e&&e!==D&&t(new Error("A pay-sdk from different source has been load")),D=e,window.zhihu&&window.zhihu.pay?window.zhihu.pay.ready(t):(F||(F=Object(_.loadScript)(e)),F.then(function(){return window.zhihu.pay.ready(t)},function(e){t(e),F=null}))}},{key:"renderAmountCustom",value:function(){var e=this.state,t=e.showCustom,n=e.customAmount,a=e.currentAmount,o=e.customButton;return Object(c.b)("div",{className:"Reward-TipjarDialog-amountCustom"},t?Object(c.b)("div",{className:"Reward-TipjarDialog-amountInput"},Object(c.b)("input",{name:"",type:"text",className:"SimpleInput",placeholder:"你想赞赏的金额（不超过 500）",value:n,onChange:this.handleCustomChange,onKeyUp:this.handleCustomKeyUp,ref:function(e){e&&e.focus()}}),Object(c.b)(f.c,{disabled:n<=0||n>500,color:"blue",preset:"primary",onClick:this.handleSubmitCustom},"确定"),Object(c.b)("div",{className:"Reward-TipjarDialog-error",style:{display:n>500?"block":"none"}},"不能超过 500 元")):Object(c.b)(f.c,{preset:"plain",className:o?"TipjarDialog-customButton-cheked":"TipjarDialog-customButton",onClick:this.handleCustomAmount},o?"自定义金额： ￥ ".concat(a/V):"自定义金额"))}},{key:"renderTipjarDialog",value:function(){var e=this,t=this.props,n=t.author,a=n.name,o=n.avatarUrl,r=n.isOrg,i=n.urlToken,s=n.id,l=t.tagline,u=this.state.currentAmount;return Object(c.b)("div",{className:"Reward-TipjarDialog"},Object(c.b)("div",{className:"Reward-TipjarDialog-user"},Object(c.b)("a",{href:"/".concat(r?"org":"people","/").concat(i||s),className:"Reward-UserAvatar"},Object(c.b)("img",{src:o.replace("_is","_l"),className:"Reward-Avatar",alt:"当前用户"})),a),Object(c.b)("div",{className:"Reward-TipjarDialog-tagLine"},l),Object(c.b)("div",{className:"Reward-TipjarDialog-selectAmount"},Object(c.b)("div",{className:"Reward-TipjarDialog-amountList"},z.map(function(t){return Object(c.b)(f.c,{key:t,"data-amount":t,onClick:e.handleAmountButton,color:"red",className:h()({"Reward-Button-checked":Number(u)===t})},Object(c.b)("b",null,Number(u)===t?"".concat(t/V," 元"):"￥ ".concat(t/V)))})),this.renderAmountCustom()))}},{key:"render",value:function(){var e=this.props,t=e.ua,n=e.TipjarRender,a=e.isMobile,o=e.tradeNumber,r=this.state,i=r.showCustom,s=r.tradeLoading,l=r.showTipModal,u=r.trade,d=r.chosePaymentName,m=a?v.a:b.b,p=a?"small":"default";return Object(c.b)(m,{overlay:!0,size:p,onClose:this.colseTijarDialog,className:"Reward-TipjarDialogModal"},n&&Object(c.b)("div",null,l&&d&&this.renderTipjarDialog(),(u||s)&&!i&&Object(c.b)(M,{trade:u,tradeNumber:o,ua:t,onSuccess:this.onPaySuccess,onConfirmPayment:this.onConfirmPayment})))}}]),t}(l.Component);U.propTypes={author:m.a.object,tagline:m.a.string,colseTijarDialog:m.a.func,addReward:m.a.func,tradeNumber:m.a.number,removeTradeNumber:m.a.func,onPaySuccess:m.a.func,isMobile:m.a.bool,type:m.a.string},U.defaultProps={tagline:B.j}}}]);
//# sourceMappingURL=main.modals.82a8951ebcb565003274.js.map